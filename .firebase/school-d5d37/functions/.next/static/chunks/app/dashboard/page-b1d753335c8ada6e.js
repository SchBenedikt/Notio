(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{44680:(e,s,t)=>{Promise.resolve().then(t.bind(t,52233))},52233:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>rA});var a=t(95155),r=t(12115),n=t(35695),l=t(22100),i=t(35317),c=t(56104),d=t(28341),o=t(18271),m=t(91721),h=t(33349),u=t(30285),x=t(43433),j=t(79556),f=t(77381),p=t(10518),g=t(59434);let N=x.bL;x.YJ;let b=x.WT,v=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(x.l9,{ref:s,className:(0,g.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,a.jsx)(x.In,{asChild:!0,children:(0,a.jsx)(j.A,{className:"h-4 w-4 opacity-50"})})]})});v.displayName=x.l9.displayName;let w=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(x.PP,{ref:s,className:(0,g.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})});w.displayName=x.PP.displayName;let y=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(x.wn,{ref:s,className:(0,g.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(j.A,{className:"h-4 w-4"})})});y.displayName=x.wn.displayName;let k=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...l}=e;return(0,a.jsx)(x.ZL,{children:(0,a.jsxs)(x.UC,{ref:s,className:(0,g.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,a.jsx)(w,{}),(0,a.jsx)(x.LM,{className:(0,g.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(y,{})]})})});k.displayName=x.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(x.JU,{ref:s,className:(0,g.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=x.JU.displayName;let S=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(x.q7,{ref:s,className:(0,g.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(x.VF,{children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})}),(0,a.jsx)(x.p4,{children:r})]})});S.displayName=x.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(x.wv,{ref:s,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=x.wv.displayName;var A=t(76215),C=t(73158),D=t(70154);let F=A.bL,E=A.l9;A.YJ,A.ZL,A.Pb,A.z6,r.forwardRef((e,s)=>{let{className:t,inset:r,children:n,...l}=e;return(0,a.jsxs)(A.ZP,{ref:s,className:(0,g.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...l,children:[n,(0,a.jsx)(C.A,{className:"ml-auto"})]})}).displayName=A.ZP.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(A.G5,{ref:s,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}).displayName=A.G5.displayName;let z=r.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...n}=e;return(0,a.jsx)(A.ZL,{children:(0,a.jsx)(A.UC,{ref:s,sideOffset:r,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});z.displayName=A.UC.displayName;let L=r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(A.q7,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...n})});L.displayName=A.q7.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,checked:n,...l}=e;return(0,a.jsxs)(A.H_,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(A.VF,{children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})}),r]})}).displayName=A.H_.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(A.hN,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(A.VF,{children:(0,a.jsx)(D.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=A.hN.displayName,r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(A.JU,{ref:s,className:(0,g.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...n})}).displayName=A.JU.displayName;let B=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(A.wv,{ref:s,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",t),...r})});B.displayName=A.wv.displayName;var R=t(4637);function I(e){let{selectedGradeLevel:s,onGradeLevelChange:t,onOpenMobileSidebar:r,onLogout:n,onNavigate:l}=e,i=Array.from({length:8},(e,s)=>s+5);return(0,a.jsx)("header",{className:"sticky top-0 z-30 w-full bg-background/80 backdrop-blur-sm border-b",children:(0,a.jsxs)("div",{className:"container mx-auto flex h-20 items-center justify-between px-4 md:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(u.$,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:r,children:[(0,a.jsx)(d.A,{className:"h-6 w-6"}),(0,a.jsx)("span",{className:"sr-only",children:"Men\xfc \xf6ffnen"})]}),(0,a.jsx)("button",{onClick:()=>l("dashboard"),"aria-label":"Zum Dashboard",children:(0,a.jsx)(R.g,{})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(N,{value:String(s),onValueChange:e=>t(Number(e)),children:[(0,a.jsx)(v,{className:"w-[110px]",children:(0,a.jsx)(b,{placeholder:"Klasse"})}),(0,a.jsx)(k,{children:i.map(e=>(0,a.jsxs)(S,{value:String(e),children:["Klasse ",e]},e))})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"ghost",size:"icon",children:[(0,a.jsx)(o.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Men\xfc"})]})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:()=>l("profile"),children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profil"})]}),(0,a.jsxs)(L,{onClick:()=>l("settings"),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Einstellungen"})]}),(0,a.jsx)(B,{}),(0,a.jsxs)(L,{onClick:n,children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Abmelden"})]})]})]})]})]})})}var O=t(90221),T=t(62177),M=t(55594),Z=t(54165),$=t(66634),H=t(85057);let W=T.Op,P=r.createContext({}),G=e=>{let{...s}=e;return(0,a.jsx)(P.Provider,{value:{name:s.name},children:(0,a.jsx)(T.xI,{...s})})},_=()=>{let e=r.useContext(P),s=r.useContext(K),{getFieldState:t,formState:a}=(0,T.xW)(),n=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=s;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},K=r.createContext({}),J=r.forwardRef((e,s)=>{let{className:t,...n}=e,l=r.useId();return(0,a.jsx)(K.Provider,{value:{id:l},children:(0,a.jsx)("div",{ref:s,className:(0,g.cn)("space-y-2",t),...n})})});J.displayName="FormItem";let V=r.forwardRef((e,s)=>{let{className:t,...r}=e,{error:n,formItemId:l}=_();return(0,a.jsx)(H.J,{ref:s,className:(0,g.cn)(n&&"text-destructive",t),htmlFor:l,...r})});V.displayName="FormLabel";let U=r.forwardRef((e,s)=>{let{...t}=e,{error:r,formItemId:n,formDescriptionId:l,formMessageId:i}=_();return(0,a.jsx)($.DX,{ref:s,id:n,"aria-describedby":r?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!r,...t})});U.displayName="FormControl",r.forwardRef((e,s)=>{let{className:t,...r}=e,{formDescriptionId:n}=_();return(0,a.jsx)("p",{ref:s,id:n,className:(0,g.cn)("text-sm text-muted-foreground",t),...r})}).displayName="FormDescription";let q=r.forwardRef((e,s)=>{var t;let{className:r,children:n,...l}=e,{error:i,formMessageId:c}=_(),d=i?String(null!=(t=null==i?void 0:i.message)?t:""):n;return d?(0,a.jsx)("p",{ref:s,id:c,className:(0,g.cn)("text-sm font-medium text-destructive",r),...l,children:d}):null});q.displayName="FormMessage";var Y=t(62523),Q=t(30356);let X=M.Ik({name:M.Yj().min(2,"Der Name muss mindestens 2 Zeichen lang sein.").max(50),category:M.k5(["Hauptfach","Nebenfach"],{required_error:"Du musst eine Kategorie ausw\xe4hlen."}),targetGrade:M.vk(e=>""===e?void 0:e,M.au.number({invalid_type_error:"Muss eine Zahl sein"}).min(1,"Note muss 1-6 sein").max(6,"Note muss 1-6 sein").optional())});function ee(e){let{isOpen:s,onOpenChange:t,onSubmit:r}=e,n=(0,T.mN)({resolver:(0,O.u)(X),defaultValues:{name:"",category:"Nebenfach",targetGrade:void 0}}),l=async e=>{await r(e),n.reset(),t(!1)};return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Neues Fach hinzuf\xfcgen"}),(0,a.jsx)(Z.rr,{children:"Gib die Details deines neuen Fachs ein und w\xe4hle eine Kategorie."})]}),(0,a.jsx)(W,{...n,children:(0,a.jsxs)("form",{onSubmit:n.handleSubmit(l),className:"space-y-6 pt-4",children:[(0,a.jsx)(G,{control:n.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fachname"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Mathematik",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:n.control,name:"category",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"Kategorie"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex space-x-4",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Hauptfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Hauptfach"})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Nebenfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Nebenfach"})]})]})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:n.control,name:"targetGrade",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Wunschnote (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"number",step:"0.1",placeholder:"z.B. 2,5",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{type:"submit",children:"Fach speichern"})]})]})})]})})}var es=t(64442),et=t(15222),ea=t(83125),er=t(75066),en=t(18046),el=t(98328),ei=t(77724),ec=t(75074),ed=t(38350),eo=t(75943),em=t(77223),eh=t(87489);let eu=r.forwardRef((e,s)=>{let{className:t,orientation:r="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(eh.b,{ref:s,decorative:n,orientation:r,className:(0,g.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...l})});eu.displayName=eh.b.displayName;var ex=t(90010),ej=t(98176);let ef=ej.bL,ep=ej.l9,eg=r.forwardRef((e,s)=>{let{className:t,align:r="center",sideOffset:n=4,...l}=e;return(0,a.jsx)(ej.ZL,{children:(0,a.jsx)(ej.UC,{ref:s,align:r,sideOffset:n,className:(0,g.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});eg.displayName=ej.UC.displayName;var eN=t(27242);let eb=eN.bL,ev=eN.R6,ew=eN.Ke;var ey=t(37250);let ek=ey.bL,eS=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ey.q7,{ref:s,className:(0,g.cn)("border-b-0",t),...r})});eS.displayName="AccordionItem";let eA=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsx)(ey.Y9,{className:"flex",children:(0,a.jsx)(ey.l9,{ref:s,className:(0,g.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all [&[data-state=open]>svg]:rotate-180",t),...n,children:r})})});eA.displayName=ey.l9.displayName;let eC=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsx)(ey.UC,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:(0,a.jsx)("div",{className:(0,g.cn)("pb-4 pt-0",t),children:r})})});eC.displayName=ey.UC.displayName;var eD=t(74466);let eF=(0,eD.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eE(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,g.cn)(eF({variant:t}),s),...r})}var ez=t(3401),eL=t(96025),eB=t(16238),eR=t(58227),eI=t(83540),eO=t(94517),eT=t(24026);let eM={light:"",dark:".dark"},eZ=r.createContext(null);function e$(){let e=r.useContext(eZ);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let eH=r.forwardRef((e,s)=>{let{id:t,className:n,children:l,config:i,...c}=e,d=r.useId(),o="chart-".concat(t||d.replace(/:/g,""));return(0,a.jsx)(eZ.Provider,{value:{config:i},children:(0,a.jsxs)("div",{"data-chart":o,ref:s,className:(0,g.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...c,children:[(0,a.jsx)(eW,{id:o,config:i}),(0,a.jsx)(eI.u,{children:l})]})})});eH.displayName="Chart";let eW=e=>{let{id:s,config:t}=e,r=Object.entries(t).filter(e=>{let[,s]=e;return s.theme||s.color});return r.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eM).map(e=>{let[t,a]=e;return"\n".concat(a," [data-chart=").concat(s,"] {\n").concat(r.map(e=>{var s;let[a,r]=e,n=(null==(s=r.theme)?void 0:s[t])||r.color;return n?"  --color-".concat(a,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},eP=eO.m,eG=r.forwardRef((e,s)=>{let{active:t,payload:n,className:l,indicator:i="dot",hideLabel:c=!1,hideIndicator:d=!1,label:o,labelFormatter:m,labelClassName:h,formatter:u,color:x,nameKey:j,labelKey:f}=e,{config:p}=e$(),N=r.useMemo(()=>{var e;if(c||!(null==n?void 0:n.length))return null;let[s]=n,t="".concat(f||s.dataKey||s.name||"value"),r=e_(p,s,t),l=f||"string"!=typeof o?null==r?void 0:r.label:(null==(e=p[o])?void 0:e.label)||o;return m?(0,a.jsx)("div",{className:(0,g.cn)("font-medium",h),children:m(l,n)}):l?(0,a.jsx)("div",{className:(0,g.cn)("font-medium",h),children:l}):null},[o,m,n,c,h,p,f]);if(!t||!(null==n?void 0:n.length))return null;let b=1===n.length&&"dot"!==i;return(0,a.jsxs)("div",{ref:s,className:(0,g.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",l),children:[b?null:N,(0,a.jsx)("div",{className:"grid gap-1.5",children:n.map((e,s)=>{let t="".concat(j||e.name||e.dataKey||"value"),r=e_(p,e,t),n=x||e.payload.fill||e.color;return(0,a.jsx)("div",{className:(0,g.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:u&&(null==e?void 0:e.value)!==void 0&&e.name?u(e.value,e.name,e,s,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==r?void 0:r.icon)?(0,a.jsx)(r.icon,{}):!d&&(0,a.jsx)("div",{className:(0,g.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":b&&"dashed"===i}),style:{"--color-bg":n,"--color-border":n}}),(0,a.jsxs)("div",{className:(0,g.cn)("flex flex-1 justify-between leading-none",b?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[b?N:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function e_(e,s,t){if("object"!=typeof s||null===s)return;let a="payload"in s&&"object"==typeof s.payload&&null!==s.payload?s.payload:void 0,r=t;return t in s&&"string"==typeof s[t]?r=s[t]:a&&t in a&&"string"==typeof a[t]&&(r=a[t]),r in e?e[r]:e[t]}function eK(e){let{grades:s}=e,t=[{name:"Note 1",grade:"1",count:0},{name:"Note 2",grade:"2",count:0},{name:"Note 3",grade:"3",count:0},{name:"Note 4",grade:"4",count:0},{name:"Note 5",grade:"5",count:0},{name:"Note 6",grade:"6",count:0}];return(s.forEach(e=>{let s=Math.round(e.value)-1;s>=0&&s<6&&t[s].count++}),0===s.length)?null:(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Notenverteilung"}),(0,a.jsx)(eH,{config:{count:{label:"Anzahl",color:"hsl(var(--primary))"}},className:"h-[150px] w-full",children:(0,a.jsxs)(ez.E,{accessibilityLayer:!0,data:t,margin:{top:5,right:10,left:-10,bottom:0},children:[(0,a.jsx)(eL.W,{dataKey:"grade",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(eB.h,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,allowDecimals:!1,domain:[0,"dataMax + 1"]}),(0,a.jsx)(eP,{cursor:!1,content:(0,a.jsx)(eG,{indicator:"dot",formatter:(e,s,t)=>t.payload.count>0?(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium text-foreground",children:"".concat(t.payload.count," mal")}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t.payload.name})]}):null})}),(0,a.jsx)(eR.y,{dataKey:"count",fill:"var(--color-count)",radius:4})]})})]})}eG.displayName="ChartTooltip",eT.s,r.forwardRef((e,s)=>{let{className:t,hideIcon:r=!1,payload:n,verticalAlign:l="bottom",nameKey:i}=e,{config:c}=e$();return(null==n?void 0:n.length)?(0,a.jsx)("div",{ref:s,className:(0,g.cn)("flex items-center justify-center gap-4","top"===l?"pb-3":"pt-3",t),children:n.map(e=>{let s="".concat(i||e.dataKey||"value"),t=e_(c,e,s);return(0,a.jsxs)("div",{className:(0,g.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==t?void 0:t.icon)&&!r?(0,a.jsx)(t.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==t?void 0:t.label]},e.value)})}):null}).displayName="ChartLegend";var eJ=t(93504),eV=t(21374),eU=t(83013);function eq(e){let{grades:s}=e;if(s.length<2)return null;let t=[...s].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),r=t.length,n=0,l=0,i=0,c=0;t.forEach((e,s)=>{n+=s,l+=e.value,i+=s*e.value,c+=s*s});let d=(r*i-n*l)/(r*c-n*n),o=(l-d*n)/r,m=t.map((e,s)=>({name:e.name||e.type,date:(0,eU.GP)(new Date(e.date),"dd.MM.yy"),Note:e.value,Trend:parseFloat((d*s+o).toFixed(2))}));return(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Notenverlauf"}),(0,a.jsx)(eH,{config:{Note:{label:"Note",color:"hsl(var(--primary))"},Trend:{label:"Trend",color:"hsl(var(--muted-foreground))"}},className:"h-[150px] w-full",children:(0,a.jsxs)(eJ.b,{accessibilityLayer:!0,data:m,margin:{top:5,right:10,left:-20,bottom:0},children:[(0,a.jsx)(eL.W,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(eB.h,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,domain:[6,1],tickCount:6}),(0,a.jsx)(eP,{cursor:!1,content:(0,a.jsx)(eG,{indicator:"dot",formatter:(e,s,t)=>t.payload&&"Note"===s?(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)("span",{className:"font-bold text-foreground",children:"Note: ".concat(e)}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t.payload.name}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"vom ".concat(t.payload.date)})]}):null})}),(0,a.jsx)(eV.N,{type:"monotone",dataKey:"Note",stroke:"var(--color-Note)",strokeWidth:2,dot:{r:4,fill:"var(--color-Note)"}}),(0,a.jsx)(eV.N,{type:"linear",dataKey:"Trend",stroke:"var(--color-Trend)",strokeWidth:2,strokeDasharray:"3 3",dot:!1,activeDot:!1})]})})]})}var eY=t(55863);let eQ=r.forwardRef((e,s)=>{let{className:t,value:r,...n}=e;return(0,a.jsx)(eY.bL,{ref:s,className:(0,g.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:(0,a.jsx)(eY.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});eQ.displayName=eY.bL.displayName;let eX=e=>{let{finalGrade:s,targetGrade:t}=e;if("-"===s)return null;let r=Math.max(0,Math.min(100,(6-parseFloat(s))/(6-t)*100));return(0,a.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-semibold text-sm flex items-center gap-2 mb-2 text-muted-foreground",children:[(0,a.jsx)(es.A,{className:"h-4 w-4"}),"Fortschritt zum Ziel"]}),(0,a.jsxs)("div",{className:"flex justify-between items-baseline text-sm mb-1",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Ziel: ",(0,a.jsx)("span",{className:"font-bold text-primary",children:t.toFixed(1)})]}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Aktuell: ",(0,a.jsx)("span",{className:"font-bold text-foreground",children:s})]})]}),(0,a.jsx)(eQ,{value:r,className:"h-2"})]})};function e0(e){var s,t;let{subject:n,grades:l,studySets:i,onDeleteSubject:c,onUpdateSubject:d,onAddGradeToSubject:m,onEditSubject:h,onShowGradeInfo:x,onEditGrade:f,onViewStudySet:p,onEditStudySet:N,onDeleteStudySet:b,animationIndex:v}=e,[w,y]=(0,r.useState)(!1),[k,S]=(0,r.useState)(""),[A,C]=(0,r.useState)(null!=(s=n.writtenWeight)?s:2),[D,B]=(0,r.useState)(null!=(t=n.oralWeight)?t:1),R=(0,g._S)(l,n),I=l.filter(e=>null!=e.value),O=l.filter(e=>null==e.value),T=I.filter(e=>"Schulaufgabe"===e.type),M=I.filter(e=>"m\xfcndliche Note"===e.type),Z=i.filter(e=>e.subjectId===n.id),$=Z.filter(e=>e.title.toLowerCase().includes(k.toLowerCase())),W=e=>e<=2?"bg-green-500/10 text-green-700 border-green-500/20":e<=4?"bg-yellow-500/10 text-yellow-700 border-yellow-500/20":"bg-red-500/10 text-red-700 border-red-500/20",P=e=>(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>x(e),className:"w-full flex items-start justify-between p-2 rounded-md bg-muted/50 hover:bg-muted transition-colors text-left",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["Schulaufgabe"===e.type?(0,a.jsx)(et.A,{className:"h-5 w-5 text-muted-foreground"}):(0,a.jsx)(ea.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"font-medium text-sm",children:[e.name||e.type," ",(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(x",e.weight,")"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.date).toLocaleDateString("de-DE")})]})]}),e.notes&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground pt-1 italic pl-8",children:['"',e.notes,'"']}),e.attachments&&e.attachments.length>0&&(0,a.jsx)("div",{className:"mt-2 pl-8 space-y-1",children:e.attachments.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-primary",children:[(0,a.jsx)(er.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"truncate",children:e.name})]},s))})]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-8 w-8 rounded-md font-bold text-sm border ".concat(W(e.value)),children:e.value.toFixed(0)})})]})},e.id);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(eS,{value:n.id,className:"border bg-card rounded-lg shadow-sm animate-fade-in-down transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5",style:{animationDelay:"".concat(75*v,"ms"),opacity:0},children:[(0,a.jsxs)(eA,{className:"px-6 py-4 text-lg font-medium hover:no-underline",children:[(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)("span",{className:"truncate",children:n.name})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(eE,{variant:"outline",className:"text-base font-bold px-3 py-1 rounded-md ".concat((e=>{let s=parseFloat(e);return isNaN(s)?"bg-muted text-muted-foreground":s<=2.5?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":s<=4.5?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"})(R)),children:R}),(0,a.jsx)(j.A,{className:"h-5 w-5 shrink-0 transition-transform duration-200"})]})]}),(0,a.jsxs)(eC,{className:"px-6 pb-4",children:[(0,a.jsx)(eu,{className:"mb-4"}),I.length>0?(0,a.jsxs)("div",{className:"grid md:grid-cols-2 md:gap-x-8 items-start",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[T.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Schulaufgaben"}),(0,a.jsx)("ul",{className:"space-y-2",children:T.map(P)})]}),M.length>0&&(0,a.jsxs)("div",{className:T.length>0?"mt-4":"",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"M\xfcndliche & sonstige Noten"}),(0,a.jsx)("ul",{className:"space-y-2",children:M.map(P)})]})]}),(0,a.jsxs)("div",{className:"mt-6 md:mt-0 space-y-4",children:[n.targetGrade&&"-"!==R&&(0,a.jsx)(eX,{finalGrade:R,targetGrade:n.targetGrade}),(0,a.jsx)(eK,{grades:I}),(0,a.jsx)(eq,{grades:I})]})]}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8 flex flex-col items-center gap-4",children:[(0,a.jsx)("p",{className:"font-medium",children:"Keine Noten f\xfcr dieses Fach erfasst."}),(0,a.jsxs)(u.$,{onClick:()=>m(n.id),children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Erste Note hinzuf\xfcgen"]})]}),O.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(eu,{className:"my-4"}),(0,a.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Geplante Termine"}),(0,a.jsx)("ul",{className:"space-y-2",children:O.map(e=>(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>f(e),className:"w-full flex items-center justify-between p-2 rounded-md bg-muted/50 hover:bg-muted transition-colors text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(el.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:e.name||e.type}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.date).toLocaleDateString("de-DE")})]})]}),(0,a.jsx)("span",{className:"text-xs font-semibold text-primary",children:"Note eintragen"})]})},e.id))})]}),Z.length>0&&(0,a.jsxs)("div",{className:"pt-4",children:[(0,a.jsx)(eu,{className:"mb-4"}),(0,a.jsxs)(eb,{children:[(0,a.jsxs)(ev,{className:"w-full flex justify-between items-center text-sm font-semibold text-muted-foreground hover:bg-muted/50 p-2 rounded-md transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ei.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Zugeh\xf6rige Lernsets (",Z.length,")"]})]}),(0,a.jsx)(j.A,{className:"h-4 w-4 transition-transform data-[state=open]:rotate-180"})]}),(0,a.jsxs)(ew,{className:"mt-2 space-y-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(ec.A,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),(0,a.jsx)(Y.p,{type:"text",placeholder:"Lernset in diesem Fach suchen...",value:k,onChange:e=>S(e.target.value),className:"pl-8 h-8 text-xs"})]}),(0,a.jsxs)("ul",{className:"space-y-1 max-h-48 overflow-y-auto pr-1",children:[$.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between p-1 rounded-md bg-muted/50 hover:bg-muted group",children:[(0,a.jsxs)("button",{onClick:()=>p(e.id),className:"flex-1 flex items-center gap-3 p-1 text-left",children:[(0,a.jsx)(ei.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:e.title})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(ed.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:()=>N(e),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Lernset l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>b(e.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]})]},e.id)),0===$.length&&(0,a.jsx)("p",{className:"text-xs text-center text-muted-foreground py-2",children:"Kein Lernset gefunden."})]})]})]})]}),(0,a.jsx)(eu,{className:"my-4"}),(0,a.jsxs)("div",{className:"flex justify-between items-center gap-2 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsxs)(u.$,{size:"sm",onClick:()=>m(n.id),children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Note hinzuf\xfcgen"]}),"Hauptfach"===n.category&&(0,a.jsxs)(ef,{open:w,onOpenChange:y,children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Gewichtung"]})}),(0,a.jsx)(eg,{className:"w-80",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium leading-none",children:"Notengewichtung"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Passe die Gewichtung von schriftlichen zu m\xfcndlichen Noten f\xfcr dieses Fach an."})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(H.J,{htmlFor:"written-weight",children:"Schriftlich"}),(0,a.jsx)(Y.p,{id:"written-weight",type:"number",min:"0",step:"0.5",value:A,onChange:e=>C(Number(e.target.value)),className:"col-span-2 h-8"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 items-center gap-4",children:[(0,a.jsx)(H.J,{htmlFor:"oral-weight",children:"M\xfcndlich"}),(0,a.jsx)(Y.p,{id:"oral-weight",type:"number",min:"0",step:"0.5",value:D,onChange:e=>B(Number(e.target.value)),className:"col-span-2 h-8"})]}),(0,a.jsx)(u.$,{size:"sm",onClick:()=>{d(n.id,{writtenWeight:A,oralWeight:D}),y(!1)},children:"Speichern"})]})]})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",onClick:()=>h(n),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Fach l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden. Alle Noten in diesem Fach werden ebenfalls gel\xf6scht."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>c(n.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]})]})]})})}function e1(e){let{mainSubjects:s,minorSubjects:t,grades:r,studySets:n,onDeleteSubject:l,onUpdateSubject:i,onAddSubject:c,totalSubjectsCount:d,onAddGradeToSubject:o,onEditSubject:m,onShowGradeInfo:h,onEditGrade:x,onViewStudySet:j,onEditStudySet:f,onDeleteStudySet:p,onOpenCommandPalette:g}=e;if(0===d)return(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Willkommen bei Notio!"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"Du hast noch keine F\xe4cher f\xfcr diese Jahrgangsstufe angelegt. Erstelle dein erstes Fach, um Noten hinzuzuf\xfcgen."}),(0,a.jsx)(u.$,{onClick:c,className:"mt-6",size:"lg",children:"Erstes Fach erstellen"})]});let N=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.jsx)(ek,{type:"multiple",className:"w-full space-y-2",children:e.map((e,t)=>(0,a.jsx)(e0,{subject:e,grades:r.filter(s=>s.subjectId===e.id).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()),studySets:n,onDeleteSubject:l,onUpdateSubject:i,animationIndex:s+t,onAddGradeToSubject:o,onEditSubject:m,onShowGradeInfo:h,onEditGrade:x,onViewStudySet:j,onEditStudySet:f,onDeleteStudySet:p},e.id))})},b=0===s.length&&0===t.length;return(0,a.jsxs)("div",{className:"container mx-auto space-y-6",children:[(0,a.jsxs)(u.$,{variant:"outline",className:"w-full h-12 text-base rounded-lg flex justify-start items-center text-muted-foreground",onClick:g,children:[(0,a.jsx)(ec.A,{className:"mr-3 h-5 w-5"}),"Suchen oder Befehl ausf\xfchren...",(0,a.jsxs)("kbd",{className:"pointer-events-none ml-auto hidden h-6 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex",children:[(0,a.jsx)("span",{className:"text-xs",children:"⌘"}),"K"]})]}),b?(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[50vh] bg-background/50 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Keine F\xe4cher gefunden"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md mx-auto",children:"F\xfcr die ausgew\xe4hlte Klassenstufe gibt es keine F\xe4cher."}),(0,a.jsx)(u.$,{onClick:c,className:"mt-6",children:"Neues Fach erstellen"})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-8 items-start",children:[s.length>0&&(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight mb-4",children:"Hauptf\xe4cher"}),N(s,0)]}),t.length>0&&(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight mb-4",children:"Nebenf\xe4cher"}),N(t,s.length)]})]})]})}var e4=t(87481),e2=t(10469),e5=t(50695),e3=t(763),e6=t(23422),e8=t(38224),e7=t(50286),e9=t(91467),se=t(33005),ss=t(45727),st=t(66424);function sa(e){let{currentView:s,onSetView:t,onClose:r,userName:n}=e,l=e=>{t(e),r&&r()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-col gap-1 px-2",children:(0,a.jsxs)(u.$,{variant:"profile"===s?"secondary":"ghost",className:"justify-start w-full h-11 text-base font-semibold",onClick:()=>l("profile"),children:[(0,a.jsx)(m.A,{className:"mr-2 h-5 w-5"}),n||"Dein Profil"]})}),(0,a.jsx)(eu,{}),(0,a.jsx)(st.F,{className:"flex-1 -mx-6",children:(0,a.jsx)("div",{className:"px-6 space-y-4 py-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(u.$,{variant:"dashboard"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("dashboard"),children:[(0,a.jsx)(e2.A,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),(0,a.jsxs)(u.$,{variant:"subjects"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("subjects"),children:[(0,a.jsx)(e5.A,{className:"mr-2 h-4 w-4"}),"F\xe4cher\xfcbersicht"]}),(0,a.jsxs)(u.$,{variant:"timetable"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("timetable"),children:[(0,a.jsx)(e3.A,{className:"mr-2 h-4 w-4"}),"Stundenplan"]}),(0,a.jsxs)(u.$,{variant:"school-calendar"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("school-calendar"),children:[(0,a.jsx)(el.A,{className:"mr-2 h-4 w-4"}),"Schulkalender"]}),(0,a.jsxs)(u.$,{variant:"studysets"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("studysets"),children:[(0,a.jsx)(ei.A,{className:"mr-2 h-4 w-4"}),"Lernsets"]}),(0,a.jsxs)(u.$,{variant:"calculator"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("calculator"),children:[(0,a.jsx)(e6.A,{className:"mr-2 h-4 w-4"}),"Notenrechner"]}),(0,a.jsxs)(u.$,{variant:"tutor"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("tutor"),children:[(0,a.jsx)(e8.A,{className:"mr-2 h-4 w-4"}),"KI-Tutor & Coach"]}),(0,a.jsxs)(u.$,{variant:"community"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("community"),children:[(0,a.jsx)(e7.A,{className:"mr-2 h-4 w-4"}),"Community"]}),(0,a.jsxs)(u.$,{variant:"awards"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("awards"),children:[(0,a.jsx)(e9.A,{className:"mr-2 h-4 w-4"}),"Auszeichnungen"]}),(0,a.jsxs)(u.$,{variant:"files"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("files"),children:[(0,a.jsx)(se.A,{className:"mr-2 h-4 w-4"}),"Dateiverwaltung"]}),(0,a.jsxs)(u.$,{variant:"data"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("data"),children:[(0,a.jsx)(ss.A,{className:"mr-2 h-4 w-4"}),"Datenverwaltung"]}),(0,a.jsxs)(u.$,{variant:"settings"===s?"secondary":"ghost",className:"justify-start w-full",onClick:()=>l("settings"),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Einstellungen"]})]})})})]})}function sr(e){return(0,a.jsx)("aside",{className:"hidden lg:flex flex-col gap-4 w-80 bg-background border-r fixed top-0 left-0 h-screen p-6",children:(0,a.jsx)(sa,{...e})})}var sn=t(73503),sl=t(50172),si=t(25318),sc=t(31550),sd=t(73672),so=t(34477);let sm=(0,so.createServerReference)("40328d399b8d28929477650361015d27d0cc9b64f6",so.callServer,void 0,so.findSourceMapURL,"getTutorResponse");var sh=t(85977);let su=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sh.bL,{ref:s,className:(0,g.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});su.displayName=sh.bL.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sh._V,{ref:s,className:(0,g.cn)("aspect-square h-full w-full",t),...r})}).displayName=sh._V.displayName;let sx=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sh.H4,{ref:s,className:(0,g.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});sx.displayName=sh.H4.displayName;var sj=t(76981);let sf=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sj.bL,{ref:s,className:(0,g.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(sj.C1,{className:(0,g.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})})});sf.displayName=sj.bL.displayName;var sp=t(36170),sg=t(2448);function sN(e){let{isOpen:s,onOpenChange:t,onFilesSelected:n,subjects:l,grades:i}=e,[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(""),h=(0,r.useMemo)(()=>{let e={};if(i.forEach(s=>{if(s.attachments&&s.attachments.length>0){let t=l.find(e=>e.id===s.subjectId);t&&(e[s.subjectId]||(e[s.subjectId]={subject:t,files:[]}),s.attachments.forEach(t=>{e[s.subjectId].files.push({attachment:t,grade:s})}))}}),!o.trim())return Object.values(e).sort((e,s)=>e.subject.name.localeCompare(s.subject.name));let s=o.toLowerCase();return Object.values(e).map(e=>{let t=e.files.filter(e=>e.attachment.name.toLowerCase().includes(s)||(e.grade.name||e.grade.type).toLowerCase().includes(s));return e.subject.name.toLowerCase().includes(s)?{...e,files:e.files}:t.length>0?{...e,files:t}:null}).filter(e=>null!==e).sort((e,s)=>e.subject.name.localeCompare(s.subject.name))},[i,l,o]),x=(e,s)=>{s?d(s=>[...s,e]):d(s=>s.filter(s=>s.dataUrl!==e.dataUrl))},j=e=>c.some(s=>s.dataUrl===e.dataUrl),f=o.trim()?h.map(e=>e.subject.id):[];return(0,a.jsx)(Z.lG,{open:s,onOpenChange:e=>{e||d([]),t(e)},children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-2xl grid-rows-[auto_1fr_auto] max-h-[80vh]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Dateien f\xfcr KI-Tutor ausw\xe4hlen"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle eine oder mehrere Dateien aus, die der Tutor analysieren soll."})]}),(0,a.jsxs)("div",{className:"border-t border-b -mx-6 px-6 py-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(ec.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(Y.p,{placeholder:"Dateien suchen...",value:o,onChange:e=>m(e.target.value),className:"pl-10"})]}),(0,a.jsx)(st.F,{className:"h-[40vh]",children:h.length>0?(0,a.jsx)(ek,{type:"multiple",defaultValue:f,className:"w-full pr-4",children:h.map(e=>e.files.length>0&&(0,a.jsxs)(eS,{value:e.subject.id,children:[(0,a.jsx)(eA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sp.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.subject.name})]})}),(0,a.jsx)(eC,{children:(0,a.jsx)("ul",{className:"space-y-1",children:e.files.map((s,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-muted",children:[(0,a.jsx)(sf,{id:"file-".concat(e.subject.id,"-").concat(t),checked:j(s.attachment),onCheckedChange:e=>x(s.attachment,!!e)}),(0,a.jsxs)("label",{htmlFor:"file-".concat(e.subject.id,"-").concat(t),className:"flex-1 flex items-center gap-2 text-sm font-medium cursor-pointer",children:[(0,a.jsx)(sg.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:s.attachment.name})]})]},t))})})]},e.subject.id))}):(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"Keine Dateien mit Anh\xe4ngen gefunden."})})]}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{onClick:()=>{n(c),t(!1),d([])},disabled:0===c.length,children:c.length>0?"".concat(c.length," Datei(en) hinzuf\xfcgen"):"Hinzuf\xfcgen"})]})]})})}var sb=t(17313),sv=t(66695),sw=t(74601),sy=t(17569);let sk=(0,so.createServerReference)("407e010d2f8ccef5da637f1e4f13df38d3fcf506fd",so.callServer,void 0,so.findSourceMapURL,"getStudyCoachTips");var sS=t(68856);let sA=e=>{let{subject:s,grades:t}=e,[n,l]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null),[d,o]=(0,r.useState)(null);return((0,r.useEffect)(()=>{l(!0),o(null),c(null);let e=t.map(e=>({value:e.value,type:e.type,notes:e.notes,weight:e.weight,name:e.name}));sk({subjectName:s.name,subjectCategory:s.category,writtenWeight:s.writtenWeight,oralWeight:s.oralWeight,targetGrade:s.targetGrade,grades:e}).then(e=>{c(e)}).catch(e=>{console.error("AI Coach Error:",e),o("Der Lern-Coach konnte leider nicht erreicht werden. Bitte versuche es sp\xe4ter erneut.")}).finally(()=>{l(!1)})},[s,t]),n)?(0,a.jsxs)("div",{className:"space-y-6 mt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sS.E,{className:"h-6 w-1/4"}),(0,a.jsx)(sS.E,{className:"h-20 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sS.E,{className:"h-6 w-1/3"}),(0,a.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,a.jsx)(sS.E,{className:"h-8 w-full"}),(0,a.jsx)(sS.E,{className:"h-8 w-full"}),(0,a.jsx)(sS.E,{className:"h-8 w-5/6"})]})]})]}):d?(0,a.jsx)("p",{className:"text-destructive mt-4",children:d}):i?(0,a.jsxs)("div",{className:"space-y-6 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2 mb-2",children:[(0,a.jsx)(sw.A,{className:"h-5 w-5 text-amber-500"}),"Analyse"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:i.analysis})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold flex items-center gap-2 mb-2",children:[(0,a.jsx)(sy.A,{className:"h-5 w-5 text-blue-500"}),"Deine n\xe4chsten Schritte"]}),(0,a.jsx)("ul",{className:"space-y-2 list-none",children:i.tips.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start gap-3 text-sm",children:[(0,a.jsx)(eE,{variant:"outline",className:"mt-1 border-primary/50 text-primary",children:s+1}),(0,a.jsx)("span",{className:"flex-1",children:e})]},s))})]})]}):null};function sC(e){let{subjects:s,allGrades:t}=e,[n,l]=(0,r.useState)(),i=(0,r.useMemo)(()=>s.find(e=>e.id===n),[s,n]),c=(0,r.useMemo)(()=>n?t.filter(e=>e.subjectId===n):[],[t,n]);return 0===s.length?(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Lern-Coach"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"F\xfcge zuerst F\xe4cher hinzu, um den Lern-Coach verwenden zu k\xf6nnen."})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(ei.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Lern-Coach"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Erhalte personalisierte Lerntipps basierend auf deinen Noten."})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Fach ausw\xe4hlen"}),(0,a.jsx)(sv.BT,{children:"W\xe4hle ein Fach aus, um eine Analyse zu erhalten."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsxs)(N,{onValueChange:l,value:n,children:[(0,a.jsx)(v,{children:(0,a.jsx)(b,{placeholder:"W\xe4hle ein Fach..."})}),(0,a.jsx)(k,{children:s.map(e=>(0,a.jsx)(S,{value:e.id,children:e.name},e.id))})]})})]}),i&&(0,a.jsxs)(sv.Zp,{className:"animate-fade-in-down",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{children:["Analyse f\xfcr ",i.name]})}),(0,a.jsx)(sv.BT,{children:"Dein pers\xf6nlicher KI-Assistent f\xfcr bessere Noten."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsx)(sA,{subject:i,grades:c})})]})]})}function sD(e){let{isOpen:s,onOpenChange:t,onStudySetsSelected:n,allStudySets:l}=e,[i,c]=(0,r.useState)([]),[d,o]=(0,r.useState)(""),m=(0,r.useMemo)(()=>d?l.filter(e=>e.title.toLowerCase().includes(d.toLowerCase())):l,[l,d]),h=(e,s)=>{s?c(s=>[...s,e]):c(s=>s.filter(s=>s.id!==e.id))},x=e=>i.some(s=>s.id===e.id);return(0,a.jsx)(Z.lG,{open:s,onOpenChange:e=>{e||(c([]),o("")),t(e)},children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-2xl grid-rows-[auto_1fr_auto] max-h-[80vh]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Lernsets f\xfcr KI-Tutor ausw\xe4hlen"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle eines oder mehrere Lernsets aus, die der Tutor analysieren soll."})]}),(0,a.jsxs)("div",{className:"border-t border-b -mx-6 px-6 py-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(ec.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(Y.p,{placeholder:"Lernsets suchen...",value:d,onChange:e=>o(e.target.value),className:"pl-10"})]}),(0,a.jsx)(st.F,{className:"h-[40vh]",children:m.length>0?(0,a.jsx)("ul",{className:"space-y-1 pr-4",children:m.map(e=>(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-muted",children:[(0,a.jsx)(sf,{id:"set-".concat(e.id),checked:x(e),onCheckedChange:s=>h(e,!!s)}),(0,a.jsxs)("label",{htmlFor:"set-".concat(e.id),className:"flex-1 flex items-center gap-2 text-sm font-medium cursor-pointer",children:[(0,a.jsx)(ei.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:e.title})]})]},e.id))}):(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"Keine Lernsets gefunden."})})]}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{onClick:()=>{n(i),t(!1),c([])},disabled:0===i.length,children:i.length>0?"".concat(i.length," Set(s) hinzuf\xfcgen"):"Hinzuf\xfcgen"})]})]})})}function sF(e){let{subjects:s,allGrades:t,studySets:n}=e,[l,i]=(0,r.useState)([{role:"model",content:"Hallo! Ich bin dein KI-Tutor. Ich kenne deine F\xe4cher und Noten. Wie kann ich dir heute helfen? Du kannst mir auch Dateien zum Analysieren geben."}]),[c,d]=(0,r.useState)(""),[o,h]=(0,r.useState)(!1),[x,j]=(0,r.useState)(!1),[f,p]=(0,r.useState)([]),[N,b]=(0,r.useState)(!1),[v,w]=(0,r.useState)([]),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;let s=null==(e=y.current)?void 0:e.querySelector("div[data-radix-scroll-area-viewport]");s&&(s.scrollTop=s.scrollHeight)},[l]);let k=async()=>{if(!c.trim()&&0===f.length&&0===v.length)return;let e=[...l,{role:"user",content:c,attachments:f}];i(e),d(""),p([]),w([]),h(!0);try{let a=s.map(e=>{let s=t.filter(s=>s.subjectId===e.id),a=s.filter(e=>null!=e.value),r=(0,g._S)(s,e);return{name:e.name,category:e.category,average:r,targetGrade:e.targetGrade,grades:a.map(e=>({name:e.name,value:e.value,type:e.type,notes:e.notes}))}}),r=JSON.parse(JSON.stringify(a)),n=await sm({subjects:r,studySets:v.map(e=>({title:e.title,description:e.description,cards:e.cards.map(e=>({term:e.term,definition:e.definition}))})),history:e});i(e=>[...e,{role:"model",content:n.response}])}catch(e){console.error("Chat Error:",e),i(e=>[...e,{role:"model",content:"Entschuldigung, da ist etwas schiefgelaufen. Bitte versuche es erneut."}])}finally{h(!1)}},S=e=>{p(s=>s.filter((s,t)=>t!==e))},A=e=>{w(s=>s.filter((s,t)=>t!==e))},C=(0,r.useMemo)(()=>t.some(e=>e.attachments&&e.attachments.length>0),[t]),D=(0,r.useMemo)(()=>n.length>0,[n]);return(0,a.jsxs)(sb.tU,{defaultValue:"tutor",className:"w-full",children:[(0,a.jsxs)(sb.j7,{className:"grid w-full grid-cols-2 max-w-lg mx-auto mb-6",children:[(0,a.jsx)(sb.Xi,{value:"tutor",children:"KI-Tutor"}),(0,a.jsx)(sb.Xi,{value:"coach",children:"Lern-Coach"})]}),(0,a.jsxs)(sb.av,{value:"tutor",children:[(0,a.jsxs)(sv.Zp,{className:"flex flex-col",style:{height:"calc(100vh - 200px)"},children:[(0,a.jsx)(st.F,{className:"flex-1 p-4",ref:y,children:(0,a.jsxs)("div",{className:"space-y-4",children:[l.map((e,s)=>(0,a.jsxs)("div",{className:(0,g.cn)("flex items-start gap-3","user"===e.role?"justify-end":"justify-start"),children:["model"===e.role&&(0,a.jsx)(su,{className:"h-8 w-8",children:(0,a.jsx)(sx,{className:"bg-primary text-primary-foreground",children:(0,a.jsx)(sn.A,{className:"h-5 w-5"})})}),(0,a.jsxs)("div",{className:(0,g.cn)("p-3 rounded-lg max-w-sm prose prose-sm dark:prose-invert","user"===e.role?"bg-primary text-primary-foreground":"bg-muted"),children:[e.content&&(0,a.jsx)("p",{children:e.content}),e.attachments&&e.attachments.length>0&&(0,a.jsx)("div",{className:(0,g.cn)("space-y-1",e.content&&"border-t border-primary-foreground/20 pt-2 mt-2"),children:e.attachments.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)(er.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"truncate max-w-[200px]",children:e.name})]},s))})]}),"user"===e.role&&(0,a.jsx)(su,{className:"h-8 w-8",children:(0,a.jsx)(sx,{children:(0,a.jsx)(m.A,{className:"h-5 w-5"})})})]},s)),o&&(0,a.jsxs)("div",{className:"flex items-start gap-3 justify-start",children:[(0,a.jsx)(su,{className:"h-8 w-8",children:(0,a.jsx)(sx,{className:"bg-primary text-primary-foreground",children:(0,a.jsx)(sn.A,{className:"h-5 w-5"})})}),(0,a.jsx)("div",{className:"p-3 rounded-lg bg-muted flex items-center",children:(0,a.jsx)(sl.A,{className:"h-5 w-5 animate-spin text-muted-foreground"})})]})]})}),(0,a.jsxs)("div",{className:"p-4 border-t",children:[f.length>0&&(0,a.jsxs)("div",{className:"mb-2 p-2 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-medium mb-2",children:"Anh\xe4nge:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:f.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-1.5 bg-muted rounded-full pl-2 pr-1 py-0.5 text-sm",children:[(0,a.jsx)(er.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"truncate max-w-[150px]",children:e.name}),(0,a.jsx)("button",{onClick:()=>S(s),className:"rounded-full hover:bg-muted-foreground/20 p-0.5",title:"Anhang entfernen",children:(0,a.jsx)(si.A,{className:"h-3 w-3"})})]},s))})]}),v.length>0&&(0,a.jsxs)("div",{className:"mb-2 p-2 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-medium mb-2",children:"Ausgew\xe4hlte Lernsets:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-1.5 bg-muted rounded-full pl-2 pr-1 py-0.5 text-sm",children:[(0,a.jsx)(ei.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"truncate max-w-[150px]",children:e.title}),(0,a.jsx)("button",{onClick:()=>A(s),className:"rounded-full hover:bg-muted-foreground/20 p-0.5",title:"Lernset entfernen",children:(0,a.jsx)(si.A,{className:"h-3 w-3"})})]},s))})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k()},className:"flex items-center gap-2",children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>b(!0),disabled:o||!D,title:D?"Lernset ausw\xe4hlen":"Keine Lernsets zum Ausw\xe4hlen vorhanden",children:(0,a.jsx)(sc.A,{className:"h-4 w-4"})}),(0,a.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>j(!0),disabled:o||!C,title:C?"Datei anh\xe4ngen":"Keine Dateien zum Anh\xe4ngen vorhanden",children:(0,a.jsx)(er.A,{className:"h-4 w-4"})}),(0,a.jsx)(Y.p,{value:c,onChange:e=>d(e.target.value),placeholder:"Stelle eine Frage oder f\xfcge etwas hinzu...",disabled:o,className:"flex-1",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())}}),(0,a.jsxs)(u.$,{type:"submit",size:"icon",disabled:o||!c.trim()&&0===f.length&&0===v.length,children:[o?(0,a.jsx)(sl.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(sd.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Senden"})]})]})]})]}),(0,a.jsx)(sD,{isOpen:N,onOpenChange:b,onStudySetsSelected:w,allStudySets:n}),(0,a.jsx)(sN,{isOpen:x,onOpenChange:j,onFilesSelected:p,subjects:s,grades:t})]}),(0,a.jsx)(sb.av,{value:"coach",children:(0,a.jsx)(sC,{subjects:s,allGrades:t})})]})}var sE=t(45821);let sz=sE.bL;sE.l9,sE.bm;let sL=sE.ZL,sB=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sE.hJ,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});sB.displayName=sE.hJ.displayName;let sR=(0,eD.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),sI=r.forwardRef((e,s)=>{let{side:t="right",className:r,children:n,...l}=e;return(0,a.jsxs)(sL,{children:[(0,a.jsx)(sB,{}),(0,a.jsxs)(sE.UC,{ref:s,className:(0,g.cn)(sR({side:t}),r),...l,children:[n,(0,a.jsxs)(sE.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(si.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});sI.displayName=sE.UC.displayName;let sO=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};sO.displayName="SheetHeader";let sT=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sE.hE,{ref:s,className:(0,g.cn)("text-lg font-semibold text-foreground",t),...r})});sT.displayName=sE.hE.displayName;let sM=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sE.VY,{ref:s,className:(0,g.cn)("text-sm text-muted-foreground",t),...r})});sM.displayName=sE.VY.displayName;var sZ=t(81203),s$=t(45731),sH=t(19968);let sW=e=>{let{subject:s,grades:t,finalGrade:n}=e,[l,i]=(0,r.useState)({value:"",weight:"1",type:"m\xfcndliche Note"}),[c,d]=(0,r.useState)("1"),[o,m]=(0,r.useState)("m\xfcndliche Note"),[h,u]=(0,r.useState)(""),x="-"===n?null:parseFloat(n);(0,r.useEffect)(()=>{if(x){let e=Math.floor(2*x)/2;e>=x&&(e=parseFloat((e-.5).toFixed(1))),e<1&&(e=1),u(e.toFixed(1))}else u("")},[x]);let j=(0,r.useMemo)(()=>{let e=parseFloat(l.value),a=parseFloat(l.weight);if(isNaN(e)||isNaN(a)||e<1||e>6||a<=0)return null;let r=[...t,{id:"hypothetical",subjectId:s.id,value:e,weight:a,type:l.type,date:new Date().toISOString()}];return(0,g._S)(r,s)},[l,t,s]),{requiredGradeResult:f,targetAverageDisplay:p}=(0,r.useMemo)(()=>{let e;if(!x)return{requiredGradeResult:"Kein Schnitt",targetAverageDisplay:null};let a=parseFloat(h);if(isNaN(a)||a<1||a>6)return{requiredGradeResult:"Ung\xfcltiges Ziel",targetAverageDisplay:h||"-"};let r=parseFloat(c);if(isNaN(r)||r<=0)return{requiredGradeResult:"-",targetAverageDisplay:h};let n=(0,g.k$)(t,s,a,r,o);return{requiredGradeResult:null===n?"-":n<=1?"Note ≤ 1.0":n>6?"Nicht m\xf6glich":"Note ".concat(n.toFixed(2)),targetAverageDisplay:h}},[x,t,s,c,o,h]),{maintainGradeResult:N,maintainAverageDisplay:b}=(0,r.useMemo)(()=>{let e;if(!x)return{maintainGradeResult:"Kein Schnitt",maintainAverageDisplay:null};let a=parseFloat(c);if(isNaN(a)||a<=0)return{maintainGradeResult:"-",maintainAverageDisplay:null};let r=Math.ceil(2*x)/2;if(r<=x&&(r+=.5),r>6)return{maintainGradeResult:"Jede Note ok",maintainAverageDisplay:"6,0"};let n=(0,g.k$)(t,s,r,a,o);return{maintainGradeResult:null===n?"-":n>6?"Jede Note ok":n<1?"Nicht m\xf6glich":"Schlechteste: ".concat(n.toFixed(2)),maintainAverageDisplay:r.toFixed(1)}},[x,t,s,c,o]);return(0,a.jsxs)(sb.tU,{defaultValue:"what-if",className:"w-full",children:[(0,a.jsxs)(sb.j7,{className:"grid w-full grid-cols-3 h-auto",children:[(0,a.jsxs)(sb.Xi,{value:"what-if",className:"text-xs px-1 flex-col sm:flex-row h-auto py-1.5 gap-1",children:[(0,a.jsx)(e6.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Was w\xe4re wenn?"})]}),(0,a.jsxs)(sb.Xi,{value:"reach-goal",className:"text-xs px-1 flex-col sm:flex-row h-auto py-1.5 gap-1",children:[(0,a.jsx)(sZ.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Zielnote"})]}),(0,a.jsxs)(sb.Xi,{value:"maintain",className:"text-xs px-1 flex-col sm:flex-row h-auto py-1.5 gap-1",children:[(0,a.jsx)(s$.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Schnitt halten"})]})]}),(0,a.jsx)(sb.av,{value:"what-if",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-end gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(H.J,{htmlFor:"if-grade-".concat(s.id),className:"text-xs",children:"Note"}),(0,a.jsx)(Y.p,{id:"if-grade-".concat(s.id),type:"number",placeholder:"z.B. 2",value:l.value,onChange:e=>i(s=>({...s,value:e.target.value})),className:"h-9"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(H.J,{htmlFor:"if-weight-".concat(s.id),className:"text-xs",children:"Gewichtung"}),(0,a.jsx)(Y.p,{id:"if-weight-".concat(s.id),type:"number",placeholder:"z.B. 1",value:l.weight,onChange:e=>i(s=>({...s,weight:e.target.value})),className:"h-9"})]}),(0,a.jsxs)("div",{className:"flex items-center text-2xl font-bold pb-1",children:[(0,a.jsx)(sH.A,{className:"h-5 w-5 text-muted-foreground mx-1"}),(0,a.jsx)("span",{className:"text-primary",children:null!=j?j:"-"})]})]}),"Hauptfach"===s.category&&(0,a.jsxs)("div",{children:[(0,a.jsx)(H.J,{className:"text-xs",children:"Notentyp"}),(0,a.jsxs)(Q.z,{value:l.type,onValueChange:e=>i(s=>({...s,type:e})),className:"flex space-x-4 pt-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"Schulaufgabe",id:"if-type-written-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"if-type-written-".concat(s.id),className:"font-normal text-sm",children:"Schulaufgabe"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"m\xfcndliche Note",id:"if-type-oral-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"if-type-oral-".concat(s.id),className:"font-normal text-sm",children:"M\xfcndliche Note"})]})]})]})]})}),(0,a.jsx)(sb.av,{value:"reach-goal",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(H.J,{htmlFor:"target-grade-input-".concat(s.id),className:"text-xs",children:"Wunschnote"}),(0,a.jsx)(Y.p,{id:"target-grade-input-".concat(s.id),type:"number",step:"0.1",placeholder:"z.B. 2,5",value:h,onChange:e=>u(e.target.value),className:"h-9"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(H.J,{htmlFor:"future-weight-reach-".concat(s.id),className:"text-xs",children:"Gewichtung der n\xe4chsten Note"}),(0,a.jsx)(Y.p,{id:"future-weight-reach-".concat(s.id),type:"number",placeholder:"z.B. 1",value:c,onChange:e=>d(e.target.value),className:"h-9"})]}),"Hauptfach"===s.category&&(0,a.jsxs)("div",{children:[(0,a.jsx)(H.J,{className:"text-xs",children:"Art der n\xe4chsten Note"}),(0,a.jsxs)(Q.z,{value:o,onValueChange:e=>m(e),className:"flex space-x-4 pt-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"Schulaufgabe",id:"reach-type-written-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"reach-type-written-".concat(s.id),className:"font-normal text-sm",children:"Schulaufgabe"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"m\xfcndliche Note",id:"reach-type-oral-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"reach-type-oral-".concat(s.id),className:"font-normal text-sm",children:"M\xfcndliche Note"})]})]})]})]}),(0,a.jsxs)("div",{className:"text-center bg-background p-3 rounded-md",children:[(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Um Schnitt ",(0,a.jsx)("span",{className:"font-bold text-primary",children:p})," zu erreichen:"]}),(0,a.jsx)("p",{className:"text-lg font-bold text-primary",children:f})]})]})}),(0,a.jsx)(sb.av,{value:"maintain",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(H.J,{htmlFor:"future-weight-".concat(s.id),className:"text-xs",children:"Gewichtung der n\xe4chsten Note"}),(0,a.jsx)(Y.p,{id:"future-weight-".concat(s.id),type:"number",placeholder:"z.B. 1",value:c,onChange:e=>d(e.target.value),className:"h-9"})]}),"Hauptfach"===s.category&&(0,a.jsxs)("div",{children:[(0,a.jsx)(H.J,{className:"text-xs",children:"Art der n\xe4chsten Note"}),(0,a.jsxs)(Q.z,{value:o,onValueChange:e=>m(e),className:"flex space-x-4 pt-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"Schulaufgabe",id:"future-type-written-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"future-type-written-".concat(s.id),className:"font-normal text-sm",children:"Schulaufgabe"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(Q.C,{value:"m\xfcndliche Note",id:"future-type-oral-".concat(s.id)}),(0,a.jsx)(H.J,{htmlFor:"future-type-oral-".concat(s.id),className:"font-normal text-sm",children:"M\xfcndliche Note"})]})]})]})]}),(0,a.jsxs)("div",{className:"text-center bg-background p-3 rounded-md",children:[(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Um Schnitt ",(0,a.jsx)("span",{className:"font-bold text-destructive",children:b})," zu vermeiden:"]}),(0,a.jsx)("p",{className:"text-lg font-bold text-foreground",children:N})]})]})})]})};function sP(e){let{subjects:s,allGrades:t}=e,[n,l]=(0,r.useState)(),i=(0,r.useMemo)(()=>s.find(e=>e.id===n),[s,n]),c=(0,r.useMemo)(()=>n?t.filter(e=>e.subjectId===n):[],[t,n]),d=(0,r.useMemo)(()=>i?(0,g._S)(c,i):"-",[c,i]);return 0===s.length?(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Notenrechner"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"F\xfcge zuerst F\xe4cher hinzu, um den Notenrechner verwenden zu k\xf6nnen."})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Notenrechner"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Plane deine n\xe4chsten Schritte, um deine Ziele zu erreichen."})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Fach ausw\xe4hlen"}),(0,a.jsx)(sv.BT,{children:"W\xe4hle ein Fach aus, um Berechnungen durchzuf\xfchren."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsxs)(N,{onValueChange:l,value:n,children:[(0,a.jsx)(v,{children:(0,a.jsx)(b,{placeholder:"W\xe4hle ein Fach..."})}),(0,a.jsx)(k,{children:s.map(e=>(0,a.jsx)(S,{value:e.id,children:e.name},e.id))})]})})]}),i&&(0,a.jsxs)(sv.Zp,{className:"animate-fade-in-down",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{children:["Rechner f\xfcr ",i.name]}),(0,a.jsx)("span",{className:"text-lg font-bold text-primary",children:"-"!==d?"Schnitt: ".concat(d):"Kein Schnitt"})]}),(0,a.jsx)(sv.BT,{children:"Hier kannst du verschiedene Szenarien f\xfcr deine n\xe4chste Note durchspielen."})]}),(0,a.jsx)(sv.Wu,{children:c.length>0?(0,a.jsx)(sW,{subject:i,grades:c,finalGrade:d}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8 flex flex-col items-center gap-4",children:[(0,a.jsx)(e6.A,{className:"h-10 w-10 text-muted-foreground/50"}),(0,a.jsx)("p",{className:"font-medium",children:"F\xfcr dieses Fach gibt es noch keine Noten."}),(0,a.jsx)("p",{className:"text-sm",children:"F\xfcge Noten hinzu, um den Rechner zu verwenden."})]})})]})]})}let sG=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,g.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})});sG.displayName="Textarea";var s_=t(64047),sK=t(51920),sJ=t(37607),sV=t(965),sU=t(25358);function sq(e){let{className:s,classNames:t,showOutsideDays:r=!0,...n}=e;return(0,a.jsx)(sU.hv,{showOutsideDays:r,className:(0,g.cn)("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,g.cn)((0,u.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,g.cn)((0,u.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:s,...t}=e;return(0,a.jsx)(sV.A,{className:(0,g.cn)("h-4 w-4",s),...t})},IconRight:e=>{let{className:s,...t}=e;return(0,a.jsx)(C.A,{className:(0,g.cn)("h-4 w-4",s),...t})}},...n})}sq.displayName="Calendar";let sY=M.Ik({date:M.p6({required_error:"Ein Datum ist erforderlich."}),type:M.k5(["Schulaufgabe","m\xfcndliche Note"],{required_error:"Du musst einen Notentyp ausw\xe4hlen."}),name:M.Yj().max(50,"Name darf nicht l\xe4nger als 50 Zeichen sein.").optional(),value:M.vk(e=>""===e||null==e?void 0:Number(e),M.ai({invalid_type_error:"Muss eine Zahl sein"}).min(1,"Note muss 1-6 sein").max(6,"Note muss 1-6 sein").optional()),weight:M.au.number().min(.1,"Gewichtung muss positiv sein.").default(1),notes:M.Yj().max(100,"Notiz darf nicht l\xe4nger als 100 Zeichen sein.").optional(),attachments:M.YO(M.Ik({name:M.Yj(),dataUrl:M.Yj()})).optional()}),sQ={date:new Date,type:"m\xfcndliche Note",name:"",value:void 0,weight:1,notes:"",attachments:[]};function sX(e){let{isOpen:s,onOpenChange:t,onSubmit:n,subjectName:l,gradeToEdit:i}=e,c=(0,T.mN)({resolver:(0,O.u)(sY)}),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(s)if(i){var e;c.reset({...i,date:new Date(i.date),value:null!=(e=i.value)?e:void 0,attachments:i.attachments||[]})}else c.reset(sQ)},[s,i,c]);let o=e=>{let s=c.getValues("attachments")||[];c.setValue("attachments",s.filter((s,t)=>t!==e))},m=c.watch("attachments"),h=i?"Note bearbeiten":"Neue Note / Planung",x=i?"\xc4ndere die Details der Note.":"F\xfcge eine neue Note hinzu. Lass das Notenfeld leer, um einen Termin zu planen.",j=i?"\xc4nderungen speichern":"Speichern";return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:h}),(0,a.jsx)(Z.rr,{children:x})]}),(0,a.jsx)(W,{...c,children:(0,a.jsxs)("form",{onSubmit:c.handleSubmit(e=>{n(e,null==i?void 0:i.id),t(!1)}),className:"space-y-6 pt-4",children:[(0,a.jsx)(G,{control:c.control,name:"type",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"Notentyp"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex space-x-4",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Schulaufgabe"})}),(0,a.jsx)(V,{className:"font-normal",children:"Schulaufgabe"})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"m\xfcndliche Note"})}),(0,a.jsx)(V,{className:"font-normal",children:"M\xfcndliche Note"})]})]})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"value",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Note (optional, 1-6)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"number",step:"1",placeholder:"z.B. 2",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"date",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"flex flex-col",children:[(0,a.jsx)(V,{children:"Datum"}),(0,a.jsxs)(ef,{children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsx)(U,{children:(0,a.jsxs)(u.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!s.value&&"text-muted-foreground"),children:[(0,a.jsx)(sK.A,{className:"mr-2 h-4 w-4"}),s.value?(0,eU.GP)(s.value,"PPP",{locale:s_.de}):(0,a.jsx)("span",{children:"W\xe4hle ein Datum"})]})})}),(0,a.jsx)(eg,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(sq,{mode:"single",selected:s.value,onSelect:s.onChange,disabled:e=>e<new Date("2000-01-01"),initialFocus:!0})})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"name",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Bezeichnung (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Vokabeltest, Referat",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"weight",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Gewichtung"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"number",step:"0.5",placeholder:"z.B. 1 oder 2",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"notes",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Notiz (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"z.B. Thema der Ex, Schwierigkeiten...",className:"resize-none",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(V,{children:"Anh\xe4nge (optional)"}),(0,a.jsxs)(u.$,{type:"button",variant:"outline",className:"w-full",onClick:()=>{var e;return null==(e=d.current)?void 0:e.click()},children:[(0,a.jsx)(sJ.A,{className:"mr-2 h-4 w-4"}),"Dateien ausw\xe4hlen"]}),(0,a.jsx)(Y.p,{ref:d,type:"file",className:"hidden",multiple:!0,onChange:e=>{let s=e.target.files;s&&(Promise.all(Array.from(s).map(e=>new Promise(s=>{let t=new FileReader;t.onload=t=>{var a;s({name:e.name,dataUrl:null==(a=t.target)?void 0:a.result})},t.readAsDataURL(e)}))).then(e=>{let s=c.getValues("attachments")||[];c.setValue("attachments",[...s,...e])}),d.current&&(d.current.value=""))}}),(0,a.jsx)("div",{className:"space-y-2",children:null==m?void 0:m.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-2 bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[(0,a.jsx)(sg.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm truncate",children:e.name})]}),(0,a.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>o(s),children:(0,a.jsx)(si.A,{className:"h-4 w-4"})})]},s))})]}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{type:"submit",children:j})]})]})})]})})}let s0=M.Ik({name:M.Yj().min(2,"Der Name muss mindestens 2 Zeichen lang sein.").max(50),category:M.k5(["Hauptfach","Nebenfach"],{required_error:"Du musst eine Kategorie ausw\xe4hlen."}),targetGrade:M.vk(e=>""===e?void 0:e,M.au.number({invalid_type_error:"Muss eine Zahl sein"}).min(1,"Note muss 1-6 sein").max(6,"Note muss 1-6 sein").optional())});function s1(e){let{isOpen:s,onOpenChange:t,onSubmit:n,subject:l}=e,i=(0,T.mN)({resolver:(0,O.u)(s0)});return(0,r.useEffect)(()=>{s&&i.reset({name:l.name,category:l.category,targetGrade:l.targetGrade})},[s,l,i]),(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Fach bearbeiten"}),(0,a.jsxs)(Z.rr,{children:['\xc4ndere den Namen, die Kategorie oder die Wunschnote des Fachs "',l.name,'".']})]}),(0,a.jsx)(W,{...i,children:(0,a.jsxs)("form",{onSubmit:i.handleSubmit(e=>{n(l.id,e),t(!1)}),className:"space-y-6 pt-4",children:[(0,a.jsx)(G,{control:i.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fachname"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Mathematik",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:i.control,name:"category",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"Kategorie"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex space-x-4",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Hauptfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Hauptfach"})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Nebenfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Nebenfach"})]})]})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:i.control,name:"targetGrade",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Wunschnote (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"number",step:"0.1",placeholder:"z.B. 2,5",...t,value:null!=(s=t.value)?s:""})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{type:"submit",children:"\xc4nderungen speichern"})]})]})})]})})}var s4=t(68718),s2=t(16923);function s5(e){let{onImport:s,onExport:t,isFirebaseEnabled:r}=e;return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(ss.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Datenverwaltung"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Exportiere deine Noten als CSV-Datei oder importiere bestehende Daten."})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Daten exportieren"}),(0,a.jsx)(sv.BT,{children:"Sichere alle F\xe4cher und Noten der aktuell ausgew\xe4hlten Klassenstufe in einer CSV-Datei."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsxs)(u.$,{onClick:t,className:"w-full",children:[(0,a.jsx)(s4.A,{className:"mr-2 h-4 w-4"}),"Als CSV exportieren"]})})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Daten importieren"}),(0,a.jsx)(sv.BT,{children:"Importiere F\xe4cher und Noten aus einer CSV-Datei. Bestehende Eintr\xe4ge werden nicht \xfcberschrieben."})]}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsxs)(u.$,{onClick:s,variant:"outline",className:"w-full",disabled:!r,children:[(0,a.jsx)(s2.A,{className:"mr-2 h-4 w-4"}),"Von CSV importieren"]}),!r&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Der Import ist nur im angemeldeten Zustand verf\xfcgbar, um Daten dauerhaft zu speichern."})]})]})]})}var s3=t(85127),s6=t(18186),s8=t(31573),s7=t(3561),s9=t(95425);let te=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(s<0?0:s))+" "+["Bytes","KB","MB","GB","TB"][t]};function ts(e){let{files:s,subjects:t,grades:n,onCreateFolder:l,onUploadFiles:c,onDeleteItem:d}=e,[o,m]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),[j,f]=(0,r.useState)(""),[p,N]=(0,r.useState)(!1),{toast:b}=(0,e4.dj)(),v=(0,r.useRef)(null),w=(0,r.useMemo)(()=>{let e=[],a=new Set;return n.forEach(e=>{e.attachments&&e.attachments.length>0&&a.add(e.subjectId)}),a.size>0&&(e.push({id:"readonly-attachments-root",name:"Noten-Anh\xe4nge",parentId:null,type:"folder",createdAt:i.Dc.fromMillis(0),isReadOnly:!0}),t.forEach(s=>{a.has(s.id)&&e.push({id:"readonly-subject-".concat(s.id),name:s.name,parentId:"readonly-attachments-root",type:"folder",createdAt:i.Dc.fromMillis(0),isReadOnly:!0})}),n.forEach(s=>{s.attachments&&s.attachments.length>0&&s.attachments.forEach((t,a)=>{e.push({id:"readonly-attachment-".concat(s.id,"-").concat(a),name:t.name,parentId:"readonly-subject-".concat(s.subjectId),type:"file",dataUrl:t.dataUrl,size:0,fileType:"unknown",createdAt:new i.Dc(new Date(s.date).getTime()/1e3,0),isReadOnly:!0})})})),[...s,...e]},[s,t,n]),y=(0,r.useMemo)(()=>{let e=[],s=o;for(;s;){let t=w.find(e=>e.id===s&&"folder"===e.type);if(t)e.unshift(t),s=t.parentId;else break}return e},[o,w]),k=(0,r.useMemo)(()=>w.filter(e=>e.parentId===o).sort((e,s)=>e.isReadOnly&&!s.isReadOnly?1:!e.isReadOnly&&s.isReadOnly||"folder"===e.type&&"file"===s.type?-1:"file"===e.type&&"folder"===s.type?1:e.name.localeCompare(s.name)),[w,o]),S=(0,r.useMemo)(()=>{if(!o)return!1;let e=w.find(e=>e.id===o);return!!(null==e?void 0:e.isReadOnly)},[o,w]),A=async()=>{if(!j.trim())return void b({title:"Ordnername darf nicht leer sein",variant:"destructive"});await l(j,o),x(!1),f("")},D=async e=>{let s=e.target.files;s&&0!==s.length&&(N(!0),await c(s,o),N(!1),v.current&&(v.current.value=""))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("input",{type:"file",ref:v,onChange:D,multiple:!0,className:"hidden"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Dateiverwaltung"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Verwalte und organisiere deine Lernmaterialien."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(u.$,{onClick:()=>x(!0),variant:"outline",disabled:S,children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"})," Neuer Ordner"]}),(0,a.jsxs)(u.$,{onClick:()=>{var e;return null==(e=v.current)?void 0:e.click()},disabled:p||S,children:[p?(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(s2.A,{className:"mr-2 h-4 w-4"}),"Hochladen"]})]})]}),(0,a.jsxs)("div",{className:"border rounded-lg bg-card shadow-sm",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-sm",children:[(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>m(null),children:(0,a.jsx)(s6.A,{className:"h-4 w-4"})}),y.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(u.$,{variant:"ghost",className:"h-7 px-2",onClick:()=>m(e.id),children:e.name})]},e.id))]})}),(0,a.jsx)(st.F,{className:"h-[calc(100vh-350px)]",children:k.length>0?(0,a.jsxs)(s3.XI,{children:[(0,a.jsx)(s3.A0,{children:(0,a.jsxs)(s3.Hj,{children:[(0,a.jsx)(s3.nd,{children:"Name"}),(0,a.jsx)(s3.nd,{className:"hidden sm:table-cell",children:"Typ"}),(0,a.jsx)(s3.nd,{className:"hidden md:table-cell",children:"Gr\xf6\xdfe"}),(0,a.jsx)(s3.nd,{className:"hidden md:table-cell",children:"Erstellt"}),(0,a.jsx)(s3.nd,{children:(0,a.jsx)("span",{className:"sr-only",children:"Aktionen"})})]})}),(0,a.jsx)(s3.BF,{children:k.map(e=>(0,a.jsxs)(s3.Hj,{onDoubleClick:()=>"folder"===e.type&&m(e.id),className:(0,g.cn)("folder"===e.type&&"cursor-pointer"),children:[(0,a.jsx)(s3.nA,{className:"font-medium",children:(0,a.jsxs)("button",{onClick:()=>"folder"===e.type&&m(e.id),className:"flex items-center gap-2 w-full text-left",children:[e.isReadOnly&&(0,a.jsx)(s8.A,{className:"h-4 w-4 text-amber-500 shrink-0"}),"folder"===e.type?(0,a.jsx)(sp.A,{className:"h-4 w-4 text-yellow-500"}):(0,a.jsx)(sg.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"truncate",children:e.name})]})}),(0,a.jsx)(s3.nA,{className:"hidden sm:table-cell",children:"folder"===e.type?"Ordner":"Datei"}),(0,a.jsx)(s3.nA,{className:"hidden md:table-cell",children:"file"===e.type&&e.size?te(e.size):"-"}),(0,a.jsx)(s3.nA,{className:"hidden md:table-cell",children:e.createdAt?(0,s9.m)(e.createdAt.toDate(),{addSuffix:!0,locale:s_.de}):"wird erstellt..."}),(0,a.jsx)(s3.nA,{className:"text-right",children:(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(s7.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:["file"===e.type&&(0,a.jsx)(L,{asChild:!0,children:(0,a.jsxs)("a",{href:e.dataUrl,download:e.name,children:[(0,a.jsx)(s4.A,{className:"mr-2 h-4 w-4"}),"Herunterladen"]})}),!e.isReadOnly&&(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Wirklich l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden. Wenn du einen Ordner l\xf6schst, wird sein gesamter Inhalt ebenfalls entfernt."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>d(e.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]})})]},e.id))})]}):(0,a.jsx)("div",{className:"text-center py-20",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Dieser Ordner ist leer."})})})]}),(0,a.jsx)(ex.Lt,{open:h,onOpenChange:x,children:(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Neuen Ordner erstellen"}),(0,a.jsx)(ex.$v,{children:"Gib einen Namen f\xfcr den neuen Ordner ein."})]}),(0,a.jsx)(Y.p,{value:j,onChange:e=>f(e.target.value),placeholder:"Ordnername",onKeyDown:e=>"Enter"===e.key&&A()}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:A,children:"Erstellen"})]})]})})]})}var tt=t(53054),ta=t(73350),tr=t(85886),tn=t(15300);let tl=e=>{let{icon:s,label:t,value:r}=e;return(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground shrink-0 w-6 flex justify-center mt-1",children:s}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:t}),(0,a.jsx)("div",{className:"font-semibold text-card-foreground",children:r})]})]})};function ti(e){let{isOpen:s,onOpenChange:t,grade:r,subject:n,onEdit:l,onDelete:i}=e;return s&&r&&n?(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Details zur Note"}),(0,a.jsxs)(Z.rr,{children:['Informationen zur Note im Fach "',n.name,'".']})]}),(0,a.jsxs)("div",{className:"space-y-4 py-2",children:[(0,a.jsx)(tl,{icon:(0,a.jsx)("span",{className:"text-xl font-bold",children:r.value.toFixed(0)}),label:"Note",value:r.value.toFixed(1)}),(0,a.jsx)(tl,{icon:(0,a.jsx)(tt.A,{className:"h-4 w-4"}),label:"Bezeichnung",value:r.name||r.type}),(0,a.jsx)(tl,{icon:(0,a.jsx)(ta.A,{className:"h-4 w-4"}),label:"Notentyp",value:(0,a.jsx)(eE,{variant:"outline",children:r.type})}),(0,a.jsx)(tl,{icon:(0,a.jsx)(tr.A,{className:"h-4 w-4"}),label:"Gewichtung",value:"x".concat(r.weight)}),(0,a.jsx)(tl,{icon:(0,a.jsx)(sK.A,{className:"h-4 w-4"}),label:"Datum",value:(0,eU.GP)(new Date(r.date),"dd. MMMM yyyy",{locale:s_.de})}),r.notes&&(0,a.jsx)(tl,{icon:(0,a.jsx)(tn.A,{className:"h-4 w-4"}),label:"Notizen",value:(0,a.jsxs)("p",{className:"font-normal italic text-muted-foreground",children:['"',r.notes,'"']})}),r.attachments&&r.attachments.length>0&&(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground shrink-0 w-6 flex justify-center mt-1",children:(0,a.jsx)(er.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Anh\xe4nge"}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:r.attachments.map((e,s)=>(0,a.jsx)(u.$,{variant:"secondary",asChild:!0,className:"w-full justify-start h-auto py-2",children:(0,a.jsxs)("a",{href:e.dataUrl,download:e.name,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3",children:[(0,a.jsx)(sg.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate flex-1 text-left",children:e.name})]})},s))})]})]})})]}),(0,a.jsxs)(Z.Es,{className:"sm:justify-between",children:[(0,a.jsxs)(ex.Lt,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[(0,a.jsx)(s7.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Weitere Optionen"})]})}),(0,a.jsxs)(z,{align:"start",children:[(0,a.jsxs)(L,{onClick:()=>l(r),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsx)(B,{}),(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{className:"text-destructive focus:bg-destructive/10 focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})})]})]}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Note wirklich l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden. Die Note wird dauerhaft entfernt."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>i(r.id),className:"bg-destructive hover:bg-destructive/90",children:"Dauerhaft l\xf6schen"})]})]})]}),(0,a.jsx)(u.$,{type:"button",onClick:()=>t(!1),children:"Schlie\xdfen"})]})]})}):null}var tc=t(7390);let td={bronze:"text-amber-700 dark:text-amber-500",silver:"text-slate-500 dark:text-slate-400",gold:"text-yellow-500 dark:text-yellow-400",special:"text-primary"},to=r.forwardRef((e,s)=>{let{unlockedAwards:t,gradeLevel:r}=e;return(0,a.jsxs)("div",{ref:s,className:"w-[400px] h-[400px] bg-background p-6 flex flex-col shadow-2xl rounded-xl border-4 border-primary/20",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"My Achievements"}),(0,a.jsxs)("p",{className:"text-muted-foreground font-medium",children:["Grade ",r]})]}),(0,a.jsx)(R.g,{})]}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-4 gap-4 items-center justify-center py-4",children:t.slice(0,16).map(e=>(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center gap-1",children:[(0,a.jsx)("div",{className:(0,g.cn)("p-3 rounded-lg bg-primary/5"),children:(0,a.jsx)(e.icon,{className:(0,g.cn)("h-8 w-8",td[e.tier])})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground leading-tight",children:e.name})]},e.id))}),(0,a.jsx)("div",{className:"text-center text-xs text-muted-foreground border-t pt-2",children:"Generated with Notio"})]})});to.displayName="AwardsShareCard";var tm=t(78064);function th(e){let{isOpen:s,onOpenChange:t,unlockedAwards:n,gradeLevel:l}=e,i=(0,r.useRef)(null),[c,d]=(0,r.useState)(!1),o=(0,r.useCallback)(async()=>{if(i.current){d(!0);try{let e=await tm.$E(i.current,{cacheBust:!0,quality:1,pixelRatio:2}),s=document.createElement("a");s.download="noten-meister-awards-grade-".concat(l,".png"),s.href=e,s.click()}catch(e){console.error("Failed to generate image",e)}finally{d(!1)}}},[l]);return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Share Your Achievements"}),(0,a.jsx)(Z.rr,{children:"Here's a preview of your shareable awards card. Download it as an image to share with friends!"})]}),(0,a.jsx)("div",{className:"flex justify-center items-center p-4 bg-muted/50 rounded-lg",children:(0,a.jsx)(to,{ref:i,unlockedAwards:n,gradeLevel:l})}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{variant:"outline",onClick:()=>t(!1),children:"Close"}),(0,a.jsxs)(u.$,{onClick:o,disabled:c,children:[c?(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(s4.A,{className:"mr-2 h-4 w-4"}),"Download Image"]})]})]})})}let tu={bronze:{bg:"bg-amber-700/10 dark:bg-amber-950/20",border:"border-amber-700/20 dark:border-amber-900/40",iconBg:"bg-amber-700/10",iconText:"text-amber-600 dark:text-amber-500",text:"text-amber-700 dark:text-amber-500"},silver:{bg:"bg-slate-400/10 dark:bg-slate-600/10",border:"border-slate-400/20 dark:border-slate-500/30",iconBg:"bg-slate-400/10",iconText:"text-slate-500 dark:text-slate-400",text:"text-slate-600 dark:text-slate-400"},gold:{bg:"bg-yellow-400/10 dark:bg-yellow-600/10",border:"border-yellow-400/20 dark:border-yellow-500/30",iconBg:"bg-yellow-400/10",iconText:"text-yellow-500 dark:text-yellow-400",text:"text-yellow-600 dark:text-yellow-400"},special:{bg:"bg-primary/10",border:"border-primary/20",iconBg:"bg-primary/10",iconText:"text-primary",text:"text-primary"}},tx=e=>{let{award:s}=e,t=tu[s.tier];return s.unlocked?(0,a.jsxs)(sv.Zp,{className:(0,g.cn)("flex flex-col animate-fade-in-down transition-all",t.bg,t.border),children:[(0,a.jsxs)(sv.aR,{className:"flex-row items-start gap-4 space-y-0 pb-3",children:[(0,a.jsx)("div",{className:(0,g.cn)("p-3 rounded-lg",t.iconBg),children:(0,a.jsx)(s.icon,{className:(0,g.cn)("h-6 w-6",t.iconText)})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sv.ZB,{className:"text-base font-bold",children:s.name}),s.isRepeatable&&s.progress&&s.progress.current>0&&(0,a.jsxs)(eE,{variant:"secondary",className:(0,g.cn)("font-bold",t.text,t.iconBg),children:["x",s.progress.current]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]})]}),(0,a.jsx)(sv.Wu,{className:"pt-0 mt-auto",children:!s.isRepeatable&&s.progress&&s.progress.target>1&&s.progress.current<s.progress.target&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,a.jsx)("span",{className:(0,g.cn)(t.text,"font-semibold"),children:"Fortschritt"}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s.progress.current," / ",s.progress.target]})]}),(0,a.jsx)(eQ,{value:s.progress.current/s.progress.target*100,className:"h-2"})]})})]}):(0,a.jsxs)(sv.Zp,{className:"flex flex-col bg-card/50 shadow-sm border",children:[(0,a.jsxs)(sv.aR,{className:"flex-row items-start gap-4 space-y-0 pb-3",children:[(0,a.jsx)("div",{className:"p-3 bg-muted rounded-lg",children:(0,a.jsx)(s8.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{className:"text-base font-bold text-muted-foreground",children:s.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:s.secretDescription})]})]}),(0,a.jsx)(sv.Wu,{className:"pt-0 mt-auto",children:s.progress&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,a.jsx)("span",{className:"text-muted-foreground font-semibold",children:"Fortschritt"}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s.progress.current," / ",s.progress.target]})]}),(0,a.jsx)(eQ,{value:s.progress.current/s.progress.target*100,className:"h-2"})]})})]})};function tj(e){let{awards:s,selectedGradeLevel:t}=e,[n,l]=(0,r.useState)(!1),i=s.filter(e=>e.unlocked).sort((e,s)=>e.name.localeCompare(s.name)),c=s.filter(e=>!e.unlocked).sort((e,s)=>e.name.localeCompare(s.name));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(e9.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Deine Auszeichnungen"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Sammle Troph\xe4en f\xfcr deine Erfolge und deinen Flei\xdf in dieser Klassenstufe."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(u.$,{onClick:()=>l(!0),disabled:0===i.length,children:[(0,a.jsx)(tc.A,{className:"mr-2 h-4 w-4"}),"Share Awards"]})})]}),(0,a.jsxs)("div",{className:"space-y-10",children:[i.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold mb-4",children:["Freigeschaltet (",i.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(e=>(0,a.jsx)(tx,{award:e},e.id))})]}),c.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold mb-4",children:["Noch gesperrt (",c.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(e=>(0,a.jsx)(tx,{award:e},e.id))})]})]})]}),(0,a.jsx)(th,{isOpen:n,onOpenChange:l,unlockedAwards:i,gradeLevel:t})]})}var tf=t(35079),tp=t(78579),tg=t(30462),tN=t(80659),tb=t(8376);let tv=[{id:"first_subject",name:"Aller Anfang",description:"Du hast dein erstes Fach angelegt. Super!",secretDescription:"Lege dein erstes Fach an.",icon:e5.A,tier:"bronze",check:e=>({unlocked:e.length>0,progress:{current:e.length,target:1}})},{id:"first_grade",name:"Notensammler",description:"Die erste Note ist eingetragen. Weiter so!",secretDescription:"Trage deine erste Note ein.",icon:tf.A,tier:"bronze",check:(e,s)=>({unlocked:s.length>0,progress:{current:s.length,target:1}})},{id:"first_attachment",name:"Digitaler Pionier",description:"Du hast deine erste Datei an eine Note angeh\xe4ngt. Perfekt f\xfcr die Organisation!",secretDescription:"H\xe4nge eine Datei an eine Note an.",icon:tp.A,tier:"bronze",check:(e,s)=>({unlocked:s.some(e=>e.attachments&&e.attachments.length>0)})},{id:"grades_10",name:"Eifriger Sch\xfcler",description:"Du hast schon 10 Noten eingetragen. Beeindruckend!",secretDescription:"Trage insgesamt 10 Noten ein.",icon:tf.A,tier:"bronze",check:(e,s)=>({unlocked:s.length>=10,progress:{current:s.length,target:10}})},{id:"grades_25",name:"Noten-Virtuose",description:"Wow, 25 Noten! Du meisterst dein Schuljahr.",secretDescription:"Trage insgesamt 25 Noten ein.",icon:tf.A,tier:"silver",check:(e,s)=>({unlocked:s.length>=25,progress:{current:s.length,target:25}})},{id:"grades_50",name:"Noten-Legende",description:"50 Noten! Deine Disziplin ist un\xfcbertroffen.",secretDescription:"Trage insgesamt 50 Noten ein.",icon:tf.A,tier:"gold",check:(e,s)=>({unlocked:s.length>=50,progress:{current:s.length,target:50}})},{id:"subjects_5",name:"F\xe4cher-Kenner",description:"Stark! Du hast bereits 5 F\xe4cher erstellt.",secretDescription:"Lege insgesamt 5 F\xe4cher an.",icon:e5.A,tier:"bronze",check:e=>({unlocked:e.length>=5,progress:{current:e.length,target:5}})},{id:"subjects_10",name:"F\xe4cher-Experte",description:"\xdcber 10 F\xe4cher im Blick. Du bist ein Organisationstalent!",secretDescription:"Lege insgesamt 10 F\xe4cher an.",icon:e5.A,tier:"silver",check:e=>({unlocked:e.length>=10,progress:{current:e.length,target:10}})},{id:"first_one",name:"Spitzenleistung",description:"Eine 1 erzielt. Das ist eine Feier wert!",secretDescription:"Erziele eine 1 in einer Pr\xfcfung.",icon:tg.A,tier:"silver",isRepeatable:!0,check:(e,s)=>{let t=s.filter(e=>1===e.value).length;return{unlocked:t>0,progress:{current:t,target:1}}}},{id:"main_subject_one",name:"Hauptfach-Held",description:"Eine 1 in einem Hauptfach erzielt. Das ist die K\xf6nigsklasse!",secretDescription:"Erziele eine 1 in einem Hauptfach.",icon:e9.A,tier:"gold",isRepeatable:!0,check:(e,s)=>{let t=e.filter(e=>"Hauptfach"===e.category).map(e=>e.id),a=s.filter(e=>1===e.value&&t.includes(e.subjectId)).length;return{unlocked:a>0,progress:{current:a,target:1}}}},{id:"good_average",name:"Schnitt-Champion",description:"Dein Gesamtschnitt ist besser als 2,0. Fantastisch!",secretDescription:"Erreiche einen Gesamtschnitt von 2,0 oder besser.",icon:sZ.A,tier:"silver",check:(e,s,t)=>{if("-"===t)return{unlocked:!1};let a=parseFloat(t);return{unlocked:!isNaN(a)&&a<2}}},{id:"excellent_average",name:"Einser-Kandidat",description:"Dein Gesamtschnitt ist besser als 1,5. Herausragend!",secretDescription:"Erreiche einen Gesamtschnitt von 1,5 oder besser.",icon:sZ.A,tier:"gold",check:(e,s,t)=>{if("-"===t)return{unlocked:!1};let a=parseFloat(t);return{unlocked:!isNaN(a)&&a<1.5}}},{id:"subject_ace",name:"Fach-Ass",description:"Du hast in einem Fach einen Schnitt, der besser als 2,0 ist.",secretDescription:"Erreiche in einem Fach einen Schnitt von unter 2,0.",icon:tN.A,tier:"silver",check:(e,s)=>({unlocked:e.some(e=>{let t=s.filter(s=>s.subjectId===e.id);if(0===t.length)return!1;let a=(0,g._S)(t,e);if("-"===a)return!1;let r=parseFloat(a);return!isNaN(r)&&r<2})})},{id:"perfectionist",name:"Perfektionist",description:"Du hast in einem Fach einen glatten 1,0-Schnitt. Unglaublich!",secretDescription:"Erreiche in einem Fach einen Schnitt von 1,0.",icon:tb.A,tier:"gold",check:(e,s)=>({unlocked:e.some(e=>{let t=s.filter(s=>s.subjectId===e.id);if(0===t.length)return!1;let a=(0,g._S)(t,e);if("-"===a)return!1;let r=parseFloat(a);return!isNaN(r)&&1===r})})},{id:"solid_foundation",name:"Solide Basis",description:"Du hast keine Note, die schlechter als eine 4 ist. Starke Konstanz!",secretDescription:"Habe keine Note, die schlechter als 4 ist (mind. 5 Noten n\xf6tig).",icon:s$.A,tier:"silver",check:(e,s)=>s.length<5?{unlocked:!1,progress:{current:s.length,target:5}}:{unlocked:!s.some(e=>e.value>4)}}];var tw=t(81737),ty=t(77740);let tk=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ty.uB,{ref:s,className:(0,g.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r})});tk.displayName=ty.uB.displayName;let tS=e=>{let{children:s,...t}=e;return(0,a.jsx)(Z.lG,{...t,children:(0,a.jsxs)(Z.Cf,{className:"overflow-hidden p-0 shadow-lg",children:[(0,a.jsx)(Z.L3,{className:"sr-only",children:"Befehlspalette"}),(0,a.jsx)(Z.rr,{className:"sr-only",children:"Navigiere und f\xfchre Befehle in der App aus."}),(0,a.jsx)(tk,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})]})})},tA=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(ec.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(ty.uB.Input,{ref:s,className:(0,g.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]})});tA.displayName=ty.uB.Input.displayName;let tC=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ty.uB.List,{ref:s,className:(0,g.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r})});tC.displayName=ty.uB.List.displayName;let tD=r.forwardRef((e,s)=>(0,a.jsx)(ty.uB.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));tD.displayName=ty.uB.Empty.displayName;let tF=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ty.uB.Group,{ref:s,className:(0,g.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r})});tF.displayName=ty.uB.Group.displayName;let tE=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ty.uB.Separator,{ref:s,className:(0,g.cn)("-mx-1 h-px bg-border",t),...r})});tE.displayName=ty.uB.Separator.displayName;let tz=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ty.uB.Item,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r})});function tL(e){let{isOpen:s,onOpenChange:t,subjects:n,onNavigate:l,onAddSubject:i,onAddGrade:c,onExport:d,onImport:h}=e;r.useEffect(()=>{let e=e=>{"k"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),t(!s))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,s]);let u=e=>{t(!1),e()};return(0,a.jsxs)(tS,{open:s,onOpenChange:t,children:[(0,a.jsx)(tA,{placeholder:"Befehl oder Suche eingeben..."}),(0,a.jsxs)(tC,{children:[(0,a.jsx)(tD,{children:"Keine Ergebnisse gefunden."}),(0,a.jsxs)(tF,{heading:"Navigation",children:[(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("dashboard")),children:[(0,a.jsx)(e2.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Dashboard"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("subjects")),children:[(0,a.jsx)(e5.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"F\xe4cher\xfcbersicht"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("timetable")),children:[(0,a.jsx)(e3.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Stundenplan"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("school-calendar")),children:[(0,a.jsx)(el.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Schulkalender"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("studysets")),children:[(0,a.jsx)(ei.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Lernsets"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("calculator")),children:[(0,a.jsx)(e6.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Notenrechner"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("tutor")),children:[(0,a.jsx)(e8.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"KI-Tutor & Coach"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("community")),children:[(0,a.jsx)(e7.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Community"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("awards")),children:[(0,a.jsx)(e9.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Auszeichnungen"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("profile")),children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profil"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("settings")),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Einstellungen"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("files")),children:[(0,a.jsx)(se.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Dateiverwaltung"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(()=>l("data")),children:[(0,a.jsx)(s4.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Datenverwaltung"})]})]}),(0,a.jsx)(tE,{}),(0,a.jsxs)(tF,{heading:"Daten",children:[(0,a.jsxs)(tz,{onSelect:()=>u(h),children:[(0,a.jsx)(s2.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Noten aus CSV importieren"})]}),(0,a.jsxs)(tz,{onSelect:()=>u(d),children:[(0,a.jsx)(s4.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Noten als CSV exportieren"})]})]}),(0,a.jsx)(tE,{}),(0,a.jsxs)(tF,{heading:"Schnellerfassung",children:[(0,a.jsxs)(tz,{onSelect:()=>u(i),children:[(0,a.jsx)(e5.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Neues Fach hinzuf\xfcgen"})]}),n.map(e=>(0,a.jsxs)(tz,{value:"Note zu ".concat(e.name," hinzuf\xfcgen"),onSelect:()=>u(()=>c(e.id)),children:[(0,a.jsx)(tw.A,{className:"mr-2 h-4 w-4"}),(0,a.jsxs)("span",{children:['Neue Note f\xfcr "',e.name,'"']})]},e.id))]})]})]})}tz.displayName=ty.uB.Item.displayName;var tB=t(93004),tR=t(57082),tI=t(19637),tO=t(93576),tT=t(50594),tM=t(11698);function tZ(e){let{isOpen:s,onOpenChange:t,title:n,profiles:l,currentUserId:i,onToggleFollow:c,followingList:d}=e,[o,m]=(0,r.useState)(""),h=(0,r.useMemo)(()=>o?l.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())):l,[l,o]);return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-md grid-rows-[auto_1fr_auto] max-h-[70vh]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:n}),(0,a.jsx)(Z.rr,{children:"Durchsuche die Liste der Nutzer."})]}),(0,a.jsxs)("div",{className:"border-t border-b -mx-6 px-6 py-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(ec.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(Y.p,{placeholder:"Nutzer suchen...",value:o,onChange:e=>m(e.target.value),className:"pl-10"})]}),(0,a.jsx)(st.F,{className:"h-[40vh]",children:h.length>0?(0,a.jsx)("div",{className:"space-y-2 pr-4",children:h.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-muted",children:[(0,a.jsx)(su,{className:"h-10 w-10",children:(0,a.jsx)(sx,{children:e.name.charAt(0)})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email})]}),e.uid!==i&&(0,a.jsx)(u.$,{size:"sm",variant:d.includes(e.uid)?"outline":"default",onClick:()=>c(e.uid),children:d.includes(e.uid)?"Gefolgt":"Folgen"})]},e.uid))}):(0,a.jsx)("p",{className:"text-center text-muted-foreground pt-10",children:"Keine Nutzer gefunden."})})]})]})})}var t$=t(25738);let tH=M.z.object({name:M.z.string().min(2,"Name muss mindestens 2 Zeichen lang sein.").max(50,"Name darf nicht l\xe4nger als 50 Zeichen sein."),bio:M.z.string().max(160,"Biografie darf nicht l\xe4nger als 160 Zeichen sein.").optional()}),tW=M.z.object({newEmail:M.z.string().email("Bitte gib eine g\xfcltige E-Mail-Adresse ein."),password:M.z.string().min(1,"Passwort ist erforderlich.")}),tP=M.z.object({currentPassword:M.z.string().min(1,"Aktuelles Passwort ist erforderlich."),newPassword:M.z.string().min(6,"Neues Passwort muss mindestens 6 Zeichen lang sein.")});function tG(e){var s,t;let{profile:d,onUserNameChange:o,onToggleFollow:h,userRole:x,onUserRoleChange:j,userSchoolId:f,onUserSchoolIdChange:p,allSchools:g,onAddSchool:N}=e,{user:b,isFirebaseEnabled:v}=(0,l.A)(),{toast:w}=(0,e4.dj)(),y=(0,n.useRouter)(),[k,S]=(0,r.useState)(!1),[A,C]=(0,r.useState)({}),[D,F]=(0,r.useState)(""),[E,z]=(0,r.useState)({isOpen:!1,title:"",userIds:[]}),[L,B]=(0,r.useState)([]),R=(0,T.mN)({resolver:(0,O.u)(tH),defaultValues:{name:"",bio:""}});(0,r.useEffect)(()=>{b&&d?R.reset({name:d.name,bio:d.bio||""}):b&&R.reset({name:b.displayName||"",bio:""})},[b,d,R]),(0,r.useEffect)(()=>{if(!v)return;let e=(0,i.rJ)(c.db,"profiles"),s=(0,i.aQ)(e,e=>{B(e.docs.map(e=>({...e.data(),uid:e.id})))});return()=>s()},[v]);let I=(0,T.mN)({resolver:(0,O.u)(tW),defaultValues:{newEmail:"",password:""}}),M=(0,T.mN)({resolver:(0,O.u)(tP),defaultValues:{currentPassword:"",newPassword:""}}),Z=async e=>{if(b){C(e=>({...e,profile:!0}));try{b.displayName!==e.name&&(await (0,tB.r7)(b,{displayName:e.name}),o(e.name));let s=(0,i.H9)(c.db,"profiles",b.uid),t={name:e.name,bio:e.bio},a=JSON.parse(JSON.stringify(t));await (0,i.BN)(s,a,{merge:!0}),w({title:"Erfolg",description:"Dein Profil wurde aktualisiert."}),S(!1)}catch(e){w({variant:"destructive",title:"Fehler",description:e.message})}finally{C(e=>({...e,profile:!1}))}}},$=async e=>{if(b&&b.email){C(e=>({...e,email:!0}));try{let s=tB.IX.credential(b.email,e.password);await (0,tB.kZ)(b,s),await (0,tB.Ww)(b,e.newEmail);let t=(0,i.H9)(c.db,"profiles",b.uid);await (0,i.BN)(t,{email:e.newEmail},{merge:!0}),w({title:"E-Mail aktualisiert",description:"Eine Best\xe4tigungs-E-Mail wurde an ".concat(e.newEmail," gesendet.")}),I.reset(),S(!1)}catch(e){w({variant:"destructive",title:"Fehler",description:"Falsches Passwort oder die E-Mail wird bereits verwendet."})}finally{C(e=>({...e,email:!1}))}}},P=async e=>{if(b&&b.email){C(e=>({...e,password:!0}));try{let s=tB.IX.credential(b.email,e.currentPassword);await (0,tB.kZ)(b,s),await (0,tB.f3)(b,e.newPassword),w({title:"Erfolg",description:"Dein Passwort wurde erfolgreich ge\xe4ndert."}),M.reset(),S(!1)}catch(e){w({variant:"destructive",title:"Fehler beim \xc4ndern des Passworts",description:"Dein aktuelles Passwort war nicht korrekt."})}finally{C(e=>({...e,password:!1}))}}},_=async()=>{if(b&&b.email){C(e=>({...e,delete:!0}));try{let e=tB.IX.credential(b.email,D);await (0,tB.kZ)(b,e);let s=(0,i.wP)(c.db),t=(0,i.P)((0,i.rJ)(c.db,"users",b.uid,"grades"));(await (0,i.GG)(t)).forEach(e=>s.delete(e.ref));let a=(0,i.P)((0,i.rJ)(c.db,"users",b.uid,"subjects"));(await (0,i.GG)(a)).forEach(e=>s.delete(e.ref));let r=(0,i.H9)(c.db,"users",b.uid,"settings","main");s.delete(r);let n=(0,i.H9)(c.db,"profiles",b.uid);s.delete(n),await s.commit(),await (0,tB.hG)(b),w({title:"Konto gel\xf6scht",description:"Dein Konto und alle zugeh\xf6rigen Daten wurden gel\xf6scht."}),y.push("/login")}catch(e){w({variant:"destructive",title:"Fehler beim L\xf6schen des Kontos",description:"Dein Passwort war nicht korrekt."})}finally{C(e=>({...e,delete:!1})),F("")}}},K=e=>{d&&z({isOpen:!0,title:"followers"===e?"Follower":"Ich folge",userIds:"followers"===e?d.followers||[]:d.following||[]})},X=g.find(e=>e.id===f),ee=(0,r.useMemo)(()=>E.userIds.length?L.filter(e=>E.userIds.includes(e.uid)):[],[L,E.userIds]);return v&&b?A.page?(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8 animate-pulse",children:[(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(sS.E,{className:"h-20 w-20 rounded-full"})}),(0,a.jsx)(sS.E,{className:"h-8 w-1/2 mx-auto"}),(0,a.jsx)(sS.E,{className:"h-6 w-3/4 mx-auto"})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sS.E,{className:"h-6 w-1/4"}),(0,a.jsx)(sS.E,{className:"h-4 w-1/2"})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsx)(sS.E,{className:"h-10 w-full"}),(0,a.jsx)(sS.E,{className:"h-16 w-full"}),(0,a.jsx)(sS.E,{className:"h-10 w-full"}),(0,a.jsx)(sS.E,{className:"h-10 w-full"})]})]}),(0,a.jsxs)(sv.Zp,{className:"border-destructive",children:[(0,a.jsx)(sv.aR,{children:(0,a.jsx)(sS.E,{className:"h-6 w-1/3"})}),(0,a.jsx)(sv.Wu,{children:(0,a.jsx)(sS.E,{className:"h-10 w-48"})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(m.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Dein Profil"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Verwalte deine pers\xf6nlichen Daten und Sicherheitseinstellungen."})]}),k?(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Profil bearbeiten"}),(0,a.jsx)(sv.BT,{children:"\xc4ndere hier deine pers\xf6nlichen Daten und Sicherheitseinstellungen."})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-6",children:[(0,a.jsx)(W,{...R,children:(0,a.jsxs)("form",{onSubmit:R.handleSubmit(Z),className:"space-y-4 p-4 border rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground"})," \xd6ffentliches Profil"]}),(0,a.jsx)(G,{control:R.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Anzeigename"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"Dein Name",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:R.control,name:"bio",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Biografie (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"Erz\xe4hle etwas \xfcber dich...",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(u.$,{type:"submit",disabled:A.profile,children:[A.profile&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Profil speichern"]})]})}),(0,a.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center gap-2",children:[(0,a.jsx)(tR.A,{className:"h-4 w-4 text-muted-foreground"})," Pers\xf6nliche Daten"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(H.J,{children:"Rolle"}),(0,a.jsxs)(Q.z,{value:x,onValueChange:e=>j(e),className:"flex space-x-4 pt-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.C,{value:"student",id:"role-student"}),(0,a.jsx)(H.J,{htmlFor:"role-student",className:"font-normal",children:"Sch\xfcler"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.C,{value:"teacher",id:"role-teacher"}),(0,a.jsx)(H.J,{htmlFor:"role-teacher",className:"font-normal",children:"Lehrer"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(H.J,{children:"Schule"}),(0,a.jsx)(t$.c,{schools:g,value:f,onChange:p,onAddSchool:N})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"\xc4nderungen an Rolle und Schule werden sofort gespeichert."})]}),(0,a.jsx)(W,{...I,children:(0,a.jsxs)("form",{onSubmit:I.handleSubmit($),className:"space-y-4 p-4 border rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center gap-2",children:[(0,a.jsx)(tI.A,{className:"h-4 w-4 text-muted-foreground"})," E-Mail-Adresse \xe4ndern"]}),(0,a.jsx)(G,{control:I.control,name:"newEmail",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Neue E-Mail"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"email",placeholder:"neue@email.de",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:I.control,name:"password",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Aktuelles Passwort zur Best\xe4tigung"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"password",placeholder:"••••••••",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(u.$,{type:"submit",disabled:A.email,variant:"secondary",children:[A.email&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"E-Mail \xe4ndern"]})]})}),(0,a.jsx)(W,{...M,children:(0,a.jsxs)("form",{onSubmit:M.handleSubmit(P),className:"space-y-4 p-4 border rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium flex items-center gap-2",children:[(0,a.jsx)(tO.A,{className:"h-4 w-4 text-muted-foreground"})," Passwort \xe4ndern"]}),(0,a.jsx)(G,{control:M.control,name:"currentPassword",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Aktuelles Passwort"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"password",placeholder:"••••••••",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:M.control,name:"newPassword",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Neues Passwort"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{type:"password",placeholder:"••••••••",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(u.$,{type:"submit",disabled:A.password,variant:"secondary",children:[A.password&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Passwort \xe4ndern"]})]})})]}),(0,a.jsx)(sv.wL,{className:"justify-end",children:(0,a.jsx)(u.$,{variant:"ghost",onClick:()=>{S(!1),d&&R.reset({name:d.name,bio:d.bio||""}),I.reset(),M.reset()},children:"Abbrechen"})})]}):(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{className:"flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"Profil\xfcbersicht"}),(0,a.jsx)(sv.BT,{children:"Deine pers\xf6nlichen Daten und Sicherheitseinstellungen."})]}),(0,a.jsxs)(u.$,{variant:"outline",size:"sm",onClick:()=>S(!0),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Anzeigename"}),(0,a.jsx)("p",{className:"font-medium",children:(null==d?void 0:d.name)||b.displayName||"Nicht festgelegt"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(tT.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Biografie"}),(0,a.jsx)("p",{className:"font-medium text-sm italic text-muted-foreground whitespace-pre-wrap",children:(null==d?void 0:d.bio)||"Keine Biografie festgelegt."})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 border rounded-md",children:[(0,a.jsxs)("button",{onClick:()=>K("followers"),className:"flex-1 space-y-1 text-left",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Follower"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:(null==d||null==(s=d.followers)?void 0:s.length)||0})]}),(0,a.jsxs)("button",{onClick:()=>K("following"),className:"flex-1 space-y-1 text-left",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ich folge"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:(null==d||null==(t=d.following)?void 0:t.length)||0})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(tI.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"E-Mail-Adresse"}),(0,a.jsx)("p",{className:"font-medium",children:b.email})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(tO.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Passwort"}),(0,a.jsx)("p",{className:"font-medium text-muted-foreground italic",children:'Zum \xc4ndern bitte auf "Bearbeiten" klicken.'})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(tR.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Rolle"}),(0,a.jsx)("p",{className:"font-medium",children:"student"===x?"Sch\xfcler":"Lehrer"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border rounded-md",children:[(0,a.jsx)(tM.A,{className:"h-5 w-5 text-muted-foreground mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Schule"}),(0,a.jsx)("p",{className:"font-medium",children:(null==X?void 0:X.name)||"Nicht festgelegt"})]})]})]})]}),(0,a.jsxs)(sv.Zp,{className:"border-destructive",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{className:"text-destructive",children:"Gefahrenzone"}),(0,a.jsx)(sv.BT,{children:"Diese Aktionen k\xf6nnen nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"Konto dauerhaft l\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Bist du dir absolut sicher?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden. Dein Konto und alle deine Daten (F\xe4cher, Noten, Anh\xe4nge, Profil) werden dauerhaft gel\xf6scht. Bitte gib dein Passwort ein, um zu best\xe4tigen."})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)(H.J,{htmlFor:"delete-password",children:"Passwort"}),(0,a.jsx)(Y.p,{id:"delete-password",type:"password",value:D,onChange:e=>F(e.target.value),placeholder:"••••••••"})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsxs)(ex.Rx,{onClick:_,disabled:A.delete||!D,className:"bg-destructive hover:bg-destructive/90",children:[A.delete&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Konto l\xf6schen"]})]})]})]})})]})]}),(0,a.jsx)(tZ,{isOpen:E.isOpen,onOpenChange:e=>z(s=>({...s,isOpen:e})),title:E.title,profiles:ee,currentUserId:(null==b?void 0:b.uid)||null,onToggleFollow:h,followingList:(null==d?void 0:d.following)||[]})]}):(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Profilverwaltung nicht verf\xfcgbar"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"Die Profilverwaltung ist nur im angemeldeten Zustand verf\xfcgbar."})]})}var t_=t(68098),tK=t(94063),tJ=t(59069),tV=t(27300);let tU=M.Ik({content:M.Yj().min(1,"Der Beitrag darf nicht leer sein.").max(1e3,"Der Beitrag darf nicht l\xe4nger als 1000 Zeichen sein.")});function tq(e){let{isOpen:s,onOpenChange:t,onUpdate:n,post:l}=e,i=(0,T.mN)({resolver:(0,O.u)(tU),defaultValues:{content:""}}),{isSubmitting:c}=i.formState;(0,r.useEffect)(()=>{s&&i.reset({content:l.content})},[s,l,i]);let d=async e=>{await n(l.id,e.content),t(!1)};return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Beitrag bearbeiten"}),(0,a.jsx)(Z.rr,{children:"\xc4ndere den Inhalt deines Beitrags."})]}),(0,a.jsx)(W,{...i,children:(0,a.jsxs)("form",{onSubmit:i.handleSubmit(d),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:i.control,name:"content",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{className:"sr-only",children:"Beitragstext"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"Was m\xf6chtest du teilen?",className:"resize-y min-h-[120px]",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),disabled:c,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:c,children:[c&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"\xc4nderungen speichern"]})]})]})})]})})}let tY=M.Ik({content:M.Yj().min(1,"Der Kommentar darf nicht leer sein.").max(1e3,"Der Kommentar darf nicht l\xe4nger als 1000 Zeichen sein.")});function tQ(e){let{isOpen:s,onOpenChange:t,onUpdate:n,comment:l}=e,i=(0,T.mN)({resolver:(0,O.u)(tY),defaultValues:{content:""}}),{isSubmitting:c}=i.formState;(0,r.useEffect)(()=>{s&&i.reset({content:l.content})},[s,l,i]);let d=async e=>{await n(l.id,e.content),t(!1)};return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Kommentar bearbeiten"}),(0,a.jsx)(Z.rr,{children:"\xc4ndere den Inhalt deines Kommentars."})]}),(0,a.jsx)(W,{...i,children:(0,a.jsxs)("form",{onSubmit:i.handleSubmit(d),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:i.control,name:"content",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{className:"sr-only",children:"Kommentartext"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"Was m\xf6chtest du sagen?",className:"resize-y min-h-[100px]",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),disabled:c,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:c,children:[c&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"\xc4nderungen speichern"]})]})]})})]})})}let tX=()=>(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(sS.E,{className:"h-8 w-8 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(sS.E,{className:"h-4 w-1/4"}),(0,a.jsx)(sS.E,{className:"h-4 w-3/4"})]})]});function t0(e){var s;let{postId:t,profilesMap:n}=e,{user:d}=(0,l.A)(),{toast:o}=(0,e4.dj)(),[m,h]=(0,r.useState)([]),[x,j]=(0,r.useState)(""),[f,p]=(0,r.useState)(!0),[g,N]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=(0,i.rJ)(c.db,"posts",t,"comments"),s=(0,i.P)(e,(0,i.My)("createdAt","asc")),a=(0,i.aQ)(s,e=>{h(e.docs.map(e=>({id:e.id,...e.data()}))),p(!1)},e=>{console.error("Error fetching comments: ",e),o({variant:"destructive",title:"Fehler",description:"Kommentare konnten nicht geladen werden."}),p(!1)});return()=>a()},[t,o]);let w=async()=>{if(x.trim()&&d&&d.displayName){N(!0);try{await (0,i.c4)(c.db,async e=>{let s=(0,i.H9)(c.db,"posts",t),a=await e.get(s);if(!a.exists())throw"Beitrag nicht gefunden!";let r=(a.data().commentCount||0)+1;e.update(s,{commentCount:r});let n=(0,i.H9)((0,i.rJ)(c.db,"posts",t,"comments"));e.set(n,{authorId:d.uid,authorName:d.displayName,content:x,createdAt:(0,i.O5)()})}),j("")}catch(e){console.error("Error submitting comment:",e),o({variant:"destructive",title:"Fehler",description:"Dein Kommentar konnte nicht gesendet werden."})}finally{N(!1)}}},y=async(e,s)=>{let a=(0,i.H9)(c.db,"posts",t,"comments",e);try{await (0,i.mZ)(a,{content:s}),o({title:"Kommentar aktualisiert"}),v(null)}catch(e){o({variant:"destructive",title:"Fehler",description:"Kommentar konnte nicht aktualisiert werden."})}},k=async e=>{try{await (0,i.c4)(c.db,async s=>{let a=(0,i.H9)(c.db,"posts",t),r=(0,i.H9)(c.db,"posts",t,"comments",e),n=await s.get(a);if(!n.exists())throw"Beitrag nicht gefunden!";let l=(n.data().commentCount||1)-1;s.update(a,{commentCount:Math.max(0,l)}),s.delete(r)}),o({title:"Kommentar gel\xf6scht",variant:"destructive"})}catch(e){o({variant:"destructive",title:"Fehler",description:"Kommentar konnte nicht gel\xf6scht werden."})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t mt-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-sm",children:["Kommentare (",m.length,")"]}),(0,a.jsx)("div",{className:"space-y-4",children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tX,{}),(0,a.jsx)(tX,{})]}):m.length>0?m.map(e=>{var s;let t=n.get(e.authorId),r=(null==d?void 0:d.uid)===e.authorId;return(0,a.jsxs)("div",{className:"flex items-start gap-3 group",children:[(0,a.jsx)(su,{className:"h-8 w-8",children:(0,a.jsx)(sx,{children:(null==t||null==(s=t.name)?void 0:s.charAt(0))||"?"})}),(0,a.jsxs)("div",{className:"flex-1 bg-muted p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:e.authorName}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.createdAt?(0,s9.m)(e.createdAt.toDate(),{addSuffix:!0,locale:s_.de}):"Gerade eben"})]}),r&&(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(s7.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:()=>v(e),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Kommentar l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>k(e.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]})]}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})]})]},e.id)}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Noch keine Kommentare."})}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(su,{className:"h-8 w-8 mt-1",children:(0,a.jsx)(sx,{children:(null==d||null==(s=d.displayName)?void 0:s.charAt(0))||"?"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(sG,{placeholder:"Schreibe einen Kommentar...",value:x,onChange:e=>j(e.target.value),disabled:!d||g,rows:2}),(0,a.jsxs)(u.$,{size:"sm",className:"mt-2",onClick:w,disabled:!d||g||!x.trim(),children:[g&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Senden"]})]})]})]}),b&&(0,a.jsx)(tQ,{comment:b,isOpen:!!b,onOpenChange:e=>!e&&v(null),onUpdate:y})]})}function t1(e){let{isOpen:s,onOpenChange:t,onFilesSelected:n,subjects:l,grades:i}=e,[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(""),h=(0,r.useMemo)(()=>{let e={};if(i.forEach(s=>{if(s.attachments&&s.attachments.length>0){let t=l.find(e=>e.id===s.subjectId);t&&(e[s.subjectId]||(e[s.subjectId]={subject:t,files:[]}),s.attachments.forEach(t=>{e[s.subjectId].files.push({attachment:t,grade:s})}))}}),!o.trim())return Object.values(e).sort((e,s)=>e.subject.name.localeCompare(s.subject.name));let s=o.toLowerCase();return Object.values(e).map(e=>{let t=e.files.filter(e=>e.attachment.name.toLowerCase().includes(s)||(e.grade.name||e.grade.type).toLowerCase().includes(s));return e.subject.name.toLowerCase().includes(s)?{...e,files:e.files}:t.length>0?{...e,files:t}:null}).filter(e=>null!==e).sort((e,s)=>e.subject.name.localeCompare(s.subject.name))},[i,l,o]),x=(e,s)=>{s?d(s=>[...s,e]):d(s=>s.filter(s=>s.dataUrl!==e.dataUrl))},j=e=>c.some(s=>s.dataUrl===e.dataUrl),f=o.trim()?h.map(e=>e.subject.id):[];return(0,a.jsx)(Z.lG,{open:s,onOpenChange:e=>{e||(d([]),m("")),t(e)},children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-2xl grid-rows-[auto_1fr_auto] max-h-[80vh]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Dateien f\xfcr Beitrag ausw\xe4hlen"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle eine oder mehrere Dateien aus, die du deinem Beitrag anh\xe4ngen m\xf6chtest."})]}),(0,a.jsxs)("div",{className:"border-t border-b -mx-6 px-6 py-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(ec.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(Y.p,{placeholder:"Dateien suchen...",value:o,onChange:e=>m(e.target.value),className:"pl-10"})]}),(0,a.jsx)(st.F,{className:"h-[40vh]",children:h.length>0?(0,a.jsx)(ek,{type:"multiple",defaultValue:f,className:"w-full pr-4",children:h.map(e=>e.files.length>0&&(0,a.jsxs)(eS,{value:e.subject.id,children:[(0,a.jsx)(eA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sp.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.subject.name})]})}),(0,a.jsx)(eC,{children:(0,a.jsx)("ul",{className:"space-y-1",children:e.files.map((s,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-muted",children:[(0,a.jsx)(sf,{id:"post-file-".concat(e.subject.id,"-").concat(t),checked:j(s.attachment),onCheckedChange:e=>x(s.attachment,!!e)}),(0,a.jsxs)("label",{htmlFor:"post-file-".concat(e.subject.id,"-").concat(t),className:"flex-1 flex items-center gap-2 text-sm font-medium cursor-pointer",children:[(0,a.jsx)(sg.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:s.attachment.name})]})]},t))})})]},e.subject.id))}):(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"Keine Dateien mit Anh\xe4ngen gefunden."})})]}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{variant:"ghost",onClick:()=>t(!1),children:"Abbrechen"}),(0,a.jsx)(u.$,{onClick:()=>{n(c),t(!1),d([])},disabled:0===c.length,children:c.length>0?"".concat(c.length," Datei(en) anh\xe4ngen"):"Anh\xe4ngen"})]})]})})}let t4=()=>(0,a.jsxs)(sv.Zp,{children:[(0,a.jsx)(sv.aR,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(sS.E,{className:"h-10 w-10 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sS.E,{className:"h-4 w-24"}),(0,a.jsx)(sS.E,{className:"h-3 w-16"})]})]})}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(sS.E,{className:"h-4 w-full"}),(0,a.jsx)(sS.E,{className:"h-4 w-5/6"})]}),(0,a.jsx)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t",children:(0,a.jsx)(sS.E,{className:"h-8 w-16"})})]})]});function t2(e){let{currentUserProfile:s,onViewProfile:t,onToggleFollow:n,subjects:d,grades:o}=e,{user:m,isFirebaseEnabled:h}=(0,l.A)(),{toast:x}=(0,e4.dj)(),[j,f]=(0,r.useState)(""),[p,g]=(0,r.useState)([]),[N,b]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[y,k]=(0,r.useState)([]),[S,A]=(0,r.useState)([]),[C,D]=(0,r.useState)(!0),[B,R]=(0,r.useState)(null),[I,O]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!h)return void D(!1);let e=(0,i.aQ)((0,i.rJ)(c.db,"profiles"),e=>{A(e.docs.map(e=>({uid:e.id,...e.data()})))},e=>{console.error("Error fetching profiles:",e)}),s=(0,i.aQ)((0,i.P)((0,i.rJ)(c.db,"posts"),(0,i.My)("createdAt","desc")),e=>{k(e.docs.map(e=>({id:e.id,...e.data()}))),D(!1)},e=>{console.error("Error fetching posts:",e),x({variant:"destructive",title:"Fehler beim Laden der Beitr\xe4ge",description:"Die Community-Beitr\xe4ge konnten nicht geladen werden. (".concat(e.code,")")}),D(!1)});return()=>{e(),s()}},[h,x]);let T=async()=>{if(!j.trim()&&0===p.length||!m||!m.displayName)return void x({title:"Fehler",description:"Der Beitrag muss Inhalt oder einen Anhang haben.",variant:"destructive"});w(!0);try{await (0,i.gS)((0,i.rJ)(c.db,"posts"),{authorId:m.uid,authorName:m.displayName,content:j,attachments:p,likes:[],commentCount:0,createdAt:(0,i.O5)()}),f(""),g([]),x({title:"Beitrag ver\xf6ffentlicht!"})}catch(e){console.error("Error adding post: ",e),x({title:"Fehler beim Erstellen des Beitrags",description:"Stelle sicher, dass deine Datenbank-Regeln korrekt sind. (".concat(e.code,")"),variant:"destructive"})}finally{w(!1)}},M=async e=>{if(!m)return;let s=(0,i.H9)(c.db,"posts",e);try{let t=y.find(s=>s.id===e);if(!t)return;let a=t.likes.includes(m.uid);await (0,i.mZ)(s,{likes:a?(0,i.C3)(m.uid):(0,i.hq)(m.uid)})}catch(e){console.error("Error liking post: ",e),x({title:"Fehler beim Liken des Beitrags",variant:"destructive"})}},Z=async(e,s)=>{let t=(0,i.H9)(c.db,"posts",e);try{await (0,i.mZ)(t,{content:s}),x({title:"Beitrag aktualisiert"}),R(null)}catch(e){x({variant:"destructive",title:"Fehler",description:"Beitrag konnte nicht aktualisiert werden."})}},$=async e=>{let s=(0,i.H9)(c.db,"posts",e);try{await (0,i.kd)(s),x({title:"Beitrag gel\xf6scht",variant:"destructive"})}catch(e){x({variant:"destructive",title:"Fehler",description:"Beitrag konnte nicht gel\xf6scht werden."})}},H=e=>{console.log("Reporting post ".concat(e)),x({title:"Beitrag gemeldet",description:"Danke f\xfcr dein Feedback. Wir werden den Beitrag \xfcberpr\xfcfen."})},W=e=>{O(s=>s===e?null:s)},P=e=>{g(s=>s.filter((s,t)=>t!==e))},G=(0,r.useMemo)(()=>o.some(e=>e.attachments&&e.attachments.length>0),[o]),_=new Map(S.map(e=>[e.uid,e]));return(0,a.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(e7.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Community-Feed"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Tausche dich mit anderen aus, stelle Fragen und teile deine Erfolge."})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsx)(sv.aR,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Neuen Beitrag erstellen"})}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsxs)("div",{className:"grid w-full gap-2",children:[(0,a.jsx)(sG,{placeholder:"Was m\xf6chtest du teilen?",value:j,onChange:e=>f(e.target.value),maxLength:1e3,disabled:!m||v}),p.length>0&&(0,a.jsxs)("div",{className:"p-2 border rounded-lg space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Anh\xe4nge:"}),p.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm bg-muted/50 p-2 rounded-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 truncate",children:[(0,a.jsx)(er.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate",children:e.name})]}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>P(s),children:(0,a.jsx)(si.A,{className:"h-4 w-4"})})]},s))]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(u.$,{variant:"outline",size:"icon",onClick:()=>b(!0),disabled:!G||v,title:"Datei anh\xe4ngen",children:(0,a.jsx)(er.A,{className:"h-4 w-4"})}),(0,a.jsxs)(u.$,{onClick:T,disabled:v||!j.trim()&&0===p.length||!m,children:[v&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Beitrag ver\xf6ffentlichen"]})]})]}),!m&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Du musst angemeldet sein, um Beitr\xe4ge zu erstellen."})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t4,{}),(0,a.jsx)(t4,{}),(0,a.jsx)(t4,{})]}):y.length>0?y.map(e=>{var r,l;let i=_.get(e.authorId),c=!!m&&e.likes.includes(m.uid),d=(null==m?void 0:m.uid)===e.authorId,o=(null==s||null==(r=s.following)?void 0:r.includes(e.authorId))||!1;return(0,a.jsxs)(sv.Zp,{children:[(0,a.jsx)(sv.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(su,{className:"h-10 w-10",children:(0,a.jsx)(sx,{children:(null==i||null==(l=i.name)?void 0:l.charAt(0))||"?"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>t(e.authorId),className:"font-semibold hover:underline text-left",children:e.authorName||"Unbekannter Nutzer"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.createdAt?(0,s9.m)(e.createdAt.toDate(),{addSuffix:!0,locale:s_.de}):"Gerade eben"})]})]}),d?(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(s7.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:()=>R(e),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Beitrag l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>$(e.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]}):(0,a.jsx)(u.$,{size:"sm",variant:o?"outline":"default",onClick:()=>n(e.authorId),children:o?"Gefolgt":"Folgen"})]})}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsx)("p",{className:"whitespace-pre-wrap text-sm",children:e.content}),e.attachments&&e.attachments.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:e.attachments.map((e,s)=>(0,a.jsxs)("a",{href:e.dataUrl,download:e.name,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 rounded-md bg-muted hover:bg-muted/80 transition-colors text-sm font-medium text-primary",children:[(0,a.jsx)(er.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.name})]},s))}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t",children:[(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",onClick:()=>M(e.id),disabled:!m,children:[(0,a.jsx)(t_.A,{className:"mr-2 h-4 w-4 ".concat(c?"text-red-500 fill-current":"")}),(0,a.jsx)("span",{children:e.likes.length})]}),(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",onClick:()=>W(e.id),children:[(0,a.jsx)(tK.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:e.commentCount||0})]}),(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",disabled:!0,children:[(0,a.jsx)(tJ.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"0"})]}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"ml-auto",onClick:()=>H(e.id),children:(0,a.jsx)(tV.A,{className:"h-4 w-4"})})]}),I===e.id&&(0,a.jsx)(t0,{postId:e.id,profilesMap:_})]})]},e.id)}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-10",children:[(0,a.jsx)("p",{children:"Noch keine Beitr\xe4ge vorhanden."}),(0,a.jsx)("p",{className:"text-sm",children:"Sei der Erste, der etwas postet!"})]})}),B&&(0,a.jsx)(tq,{post:B,isOpen:!!B,onOpenChange:e=>!e&&R(null),onUpdate:Z}),(0,a.jsx)(t1,{isOpen:N,onOpenChange:b,onFilesSelected:e=>g(s=>[...s,...e]),subjects:d,grades:o})]})}var t5=t(12543);let t3=()=>(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(sS.E,{className:"h-8 w-20 rounded-md"})}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{className:"items-center text-center",children:[(0,a.jsx)(sS.E,{className:"h-20 w-20 rounded-full"}),(0,a.jsxs)("div",{className:"w-full space-y-2 mt-2",children:[(0,a.jsx)(sS.E,{className:"h-6 w-1/2 mx-auto"}),(0,a.jsx)(sS.E,{className:"h-4 w-3/4 mx-auto"})]})]}),(0,a.jsxs)(sv.Wu,{className:"flex justify-center gap-6",children:[(0,a.jsx)(sS.E,{className:"h-10 w-24 rounded-md"}),(0,a.jsx)(sS.E,{className:"h-10 w-24 rounded-md"})]})]})]});function t6(e){var s,t,n;let{userId:d,onBack:o,onToggleFollow:m,currentUserProfile:h}=e,{user:x}=(0,l.A)(),[j,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(!0),[N,b]=(0,r.useState)([]),[v,w]=(0,r.useState)({isOpen:!1,title:"",userIds:[]});(0,r.useEffect)(()=>{g(!0);let e=(0,i.H9)(c.db,"profiles",d),s=(0,i.aQ)(e,e=>{e.exists()?f({uid:e.id,...e.data()}):f(null),g(!1)},e=>{console.error("Error fetching user profile:",e),g(!1)});return()=>s()},[d]),(0,r.useEffect)(()=>{let e=(0,i.rJ)(c.db,"profiles"),s=(0,i.aQ)(e,e=>{b(e.docs.map(e=>({...e.data(),uid:e.id})))});return()=>s()},[]);let y=(null==h||null==(s=h.following)?void 0:s.includes(d))||!1,k=(null==x?void 0:x.uid)===d,S=e=>{j&&w({isOpen:!0,title:"followers"===e?"Follower":"Folgt",userIds:"followers"===e?j.followers||[]:j.following||[]})},A=(0,r.useMemo)(()=>v.userIds.length?N.filter(e=>v.userIds.includes(e.uid)):[],[N,v.userIds]);return p?(0,a.jsx)(t3,{}):j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsxs)(u.$,{variant:"ghost",onClick:o,children:[(0,a.jsx)(t5.A,{className:"mr-2 h-4 w-4"}),"Zur\xfcck zur Community"]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{className:"items-center text-center space-y-4",children:[(0,a.jsx)(su,{className:"h-24 w-24 text-4xl",children:(0,a.jsx)(sx,{children:j.name.charAt(0)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{className:"text-2xl",children:j.name}),j.bio&&(0,a.jsx)(sv.BT,{className:"mt-2 text-base",children:j.bio})]})]}),(0,a.jsxs)(sv.Wu,{className:"flex flex-col items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("button",{onClick:()=>S("followers"),className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:(null==(t=j.followers)?void 0:t.length)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Follower"})]}),(0,a.jsxs)("button",{onClick:()=>S("following"),className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:(null==(n=j.following)?void 0:n.length)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Folgt"})]})]}),!k&&(0,a.jsx)(u.$,{onClick:()=>m(d),variant:y?"outline":"default",className:"w-full max-w-xs",children:y?"Gefolgt":"Folgen"})]})]})]}),(0,a.jsx)(tZ,{isOpen:v.isOpen,onOpenChange:e=>w(s=>({...s,isOpen:e})),title:v.title,profiles:A,currentUserId:(null==x?void 0:x.uid)||null,onToggleFollow:m,followingList:(null==h?void 0:h.following)||[]})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6 text-center",children:[(0,a.jsxs)(u.$,{variant:"ghost",onClick:o,className:"mb-4",children:[(0,a.jsx)(t5.A,{className:"mr-2 h-4 w-4"}),"Zur\xfcck zur Community"]}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Profil nicht gefunden"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Der gesuchte Nutzer existiert nicht."})]})}var t8=t(4884);let t7=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(t8.bL,{className:(0,g.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(t8.zi,{className:(0,g.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});t7.displayName=t8.bL.displayName;var t9=t(82733);let ae=[{name:"blue",label:"Blau",color:"hsl(217.2 91.2% 59.8%)"},{name:"green",label:"Gr\xfcn",color:"hsl(142.1 76.2% 36.3%)"},{name:"violet",label:"Violett",color:"hsl(262.1 83.3% 57.8%)"},{name:"orange",label:"Orange",color:"hsl(25 95% 53%)"},{name:"rose",label:"Rose",color:"hsl(346.8 77.2% 49.8%)"},{name:"yellow",label:"Gelb",color:"hsl(48 96% 53%)"},{name:"zinc",label:"Zink",color:"hsl(240 5.2% 33.9%)"},{name:"slate",label:"Schiefer",color:"hsl(215 39% 35%)"}];function as(e){let{mainSubjectWeight:s,onMainSubjectWeightChange:t,minorSubjectWeight:r,onMinorSubjectWeightChange:n,maxPeriods:l,onMaxPeriodsChange:i,theme:c,onThemeChange:d,isDarkMode:m,onIsDarkModeChange:h}=e,u=(e,s)=>{let t=Number(s);!isNaN(t)&&t>=0&&e(t)},x=(e,s)=>{let t=parseInt(s,10);!isNaN(t)&&t>0&&t<=12&&e(t)};return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5",children:(0,a.jsx)(o.A,{className:"h-8 w-8 text-primary"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Einstellungen"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Passe die App an deine Bed\xfcrfnisse an. \xc4nderungen werden automatisch gespeichert."})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(tr.A,{className:"h-5 w-5 text-muted-foreground"}),"Notengewichtung"]}),(0,a.jsx)(sv.BT,{children:"Lege die globale Gewichtung f\xfcr Haupt- und Nebenf\xe4cher fest, die zur Berechnung deines Gesamtschnitts verwendet wird."})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[(0,a.jsx)(H.J,{htmlFor:"main-weight",className:"font-medium",children:"Hauptf\xe4cher"}),(0,a.jsx)(Y.p,{id:"main-weight",type:"number",min:"0",step:"0.5",value:s,onChange:e=>u(t,e.target.value),className:"w-24"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[(0,a.jsx)(H.J,{htmlFor:"minor-weight",className:"font-medium",children:"Nebenf\xe4cher"}),(0,a.jsx)(Y.p,{id:"minor-weight",type:"number",min:"0",step:"0.5",value:r,onChange:e=>u(n,e.target.value),className:"w-24"})]})]})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(e3.A,{className:"h-5 w-5 text-muted-foreground"}),"Stundenplan"]}),(0,a.jsx)(sv.BT,{children:"Passe die Einstellungen f\xfcr deinen Stundenplan an."})]}),(0,a.jsx)(sv.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[(0,a.jsx)(H.J,{htmlFor:"max-periods",className:"font-medium",children:"Maximale Stunden pro Tag"}),(0,a.jsx)(Y.p,{id:"max-periods",type:"number",min:"1",max:"12",step:"1",value:l,onChange:e=>x(i,e.target.value),className:"w-24"})]})})]}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(t9.A,{className:"h-5 w-5 text-muted-foreground"}),"Erscheinungsbild"]}),(0,a.jsx)(sv.BT,{children:"Personalisiere das Farbschema und den Dark Mode der App."})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-3 border rounded-md",children:[(0,a.jsx)(H.J,{className:"font-medium",children:"Farbschema"}),(0,a.jsx)("div",{className:"flex items-center flex-wrap gap-2 pt-2",children:ae.map(e=>(0,a.jsx)("button",{onClick:()=>d(e.name),className:(0,g.cn)("h-8 w-8 rounded-full border-2 flex items-center justify-center transition-all",c===e.name?"border-primary ring-2 ring-offset-2 ring-ring scale-110":"border-transparent"),style:{backgroundColor:e.color},"aria-label":"Farbe ".concat(e.label," ausw\xe4hlen")},e.name))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[(0,a.jsx)(H.J,{htmlFor:"dark-mode",className:"font-medium",children:"Dark Mode"}),(0,a.jsx)(t7,{id:"dark-mode",checked:m,onCheckedChange:h})]})]})]})]})}var at=t(25844),aa=t(14347);function ar(e){let{studySet:s,subjectName:t,onSelect:r,onEdit:n,onDelete:l,animationIndex:i}=e;return(0,a.jsx)("div",{className:"animate-fade-in-down",style:{animationDelay:"".concat(75*i,"ms"),opacity:0},children:(0,a.jsxs)(sv.Zp,{className:"flex flex-col h-full transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5",children:[(0,a.jsx)(sv.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(sv.ZB,{className:"text-lg",children:s.title}),(0,a.jsx)(sv.BT,{className:"line-clamp-2",children:s.description})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",children:(0,a.jsx)(ed.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:n,children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Lernset l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>l(s.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]})]})}),(0,a.jsxs)(sv.Wu,{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(at.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[s.cards.length," Begriff",1!==s.cards.length?"e":""]})]}),t&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(e5.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:t})]})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsxs)(u.$,{className:"w-full",onClick:()=>r(s.id),children:[(0,a.jsx)(aa.A,{className:"mr-2 h-4 w-4"}),"Lernen"]})})]})})}function an(e){let{studySets:s,subjects:t,onViewStudySet:n,onEditStudySet:l,onDeleteStudySet:i,onAddNew:c}=e,[d,o]=(0,r.useState)(""),m=(0,r.useMemo)(()=>{if(!d.trim())return s;let e=d.toLowerCase();return s.filter(s=>s.title.toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e))},[s,d]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Deine Lernsets"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Erstelle, verwalte und lerne deine Karteikarten."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1 md:flex-initial",children:[(0,a.jsx)(ec.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(Y.p,{placeholder:"Lernsets suchen...",value:d,onChange:e=>o(e.target.value),className:"pl-10 w-full md:w-64"})]}),(0,a.jsxs)(u.$,{onClick:c,className:"shrink-0",children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Neues Lernset"]})]})]}),s.length>0?m.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:m.sort((e,s)=>e.title.localeCompare(s.title)).map((e,s)=>{let r=t.find(s=>s.id===e.subjectId);return(0,a.jsx)(ar,{studySet:e,subjectName:null==r?void 0:r.name,onSelect:n,onEdit:()=>l(e),onDelete:i,animationIndex:s},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[50vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Keine Ergebnisse"}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-2 max-w-md",children:['F\xfcr deine Suche nach "',d,'" wurde kein Lernset gefunden.']})]}):(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5 mb-4",children:(0,a.jsx)(ei.A,{className:"h-8 w-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Dein erstes Lernset"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:'Du hast noch keine Lernsets erstellt. Klicke auf "Neues Lernset", um loszulegen.'}),(0,a.jsx)(u.$,{onClick:c,className:"mt-6",children:"Lernset erstellen"})]})]})}var al=t(18763),ai=t(12682),ac=t(61555),ad=t(85005);let ao=r.createContext(null);function am(){let e=r.useContext(ao);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}let ah=r.forwardRef((e,s)=>{let{orientation:t="horizontal",opts:n,setApi:l,plugins:i,className:c,children:d,...o}=e,[m,h]=(0,ad.A)({...n,axis:"horizontal"===t?"x":"y"},i),[u,x]=r.useState(!1),[j,f]=r.useState(!1),p=r.useCallback(e=>{e&&(x(e.canScrollPrev()),f(e.canScrollNext()))},[]),N=r.useCallback(()=>{null==h||h.scrollPrev()},[h]),b=r.useCallback(()=>{null==h||h.scrollNext()},[h]),v=r.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),N()):"ArrowRight"===e.key&&(e.preventDefault(),b())},[N,b]);return r.useEffect(()=>{h&&l&&l(h)},[h,l]),r.useEffect(()=>{if(h)return p(h),h.on("reInit",p),h.on("select",p),()=>{null==h||h.off("select",p)}},[h,p]),(0,a.jsx)(ao.Provider,{value:{carouselRef:m,api:h,opts:n,orientation:t||((null==n?void 0:n.axis)==="y"?"vertical":"horizontal"),scrollPrev:N,scrollNext:b,canScrollPrev:u,canScrollNext:j},children:(0,a.jsx)("div",{ref:s,onKeyDownCapture:v,className:(0,g.cn)("relative",c),role:"region","aria-roledescription":"carousel",...o,children:d})})});ah.displayName="Carousel";let au=r.forwardRef((e,s)=>{let{className:t,...r}=e,{carouselRef:n,orientation:l}=am();return(0,a.jsx)("div",{ref:n,className:"overflow-hidden",children:(0,a.jsx)("div",{ref:s,className:(0,g.cn)("flex","horizontal"===l?"-ml-4":"-mt-4 flex-col",t),...r})})});au.displayName="CarouselContent";let ax=r.forwardRef((e,s)=>{let{className:t,...r}=e,{orientation:n}=am();return(0,a.jsx)("div",{ref:s,role:"group","aria-roledescription":"slide",className:(0,g.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===n?"pl-4":"pt-4",t),...r})});ax.displayName="CarouselItem";let aj=r.forwardRef((e,s)=>{let{className:t,variant:r="outline",size:n="icon",...l}=e,{orientation:i,scrollPrev:c,canScrollPrev:d}=am();return(0,a.jsxs)(u.$,{ref:s,variant:r,size:n,className:(0,g.cn)("absolute  h-8 w-8 rounded-full","horizontal"===i?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!d,onClick:c,...l,children:[(0,a.jsx)(t5.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Previous slide"})]})});aj.displayName="CarouselPrevious";let af=r.forwardRef((e,s)=>{let{className:t,variant:r="outline",size:n="icon",...l}=e,{orientation:i,scrollNext:c,canScrollNext:d}=am();return(0,a.jsxs)(u.$,{ref:s,variant:r,size:n,className:(0,g.cn)("absolute h-8 w-8 rounded-full","horizontal"===i?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!d,onClick:c,...l,children:[(0,a.jsx)(sH.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Next slide"})]})});function ap(e){let{cards:s}=e,[t,n]=(0,r.useState)(),[l,i]=(0,r.useState)(0),[c,d]=(0,r.useState)(0),[o,m]=(0,r.useState)(Array(s.length).fill(!1));(0,r.useEffect)(()=>{t&&(d(t.scrollSnapList().length),i(t.selectedScrollSnap()+1),t.on("select",()=>{i(t.selectedScrollSnap()+1)}))},[t]);let h=e=>{m(s=>{let t=[...s];return t[e]=!t[e],t})},u=(0,r.useCallback)(e=>{" "===e.key&&(e.preventDefault(),t&&h(t.selectedScrollSnap()))},[t]);return(0,r.useEffect)(()=>(window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}),[u]),(0,a.jsxs)("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-center gap-4",children:[(0,a.jsxs)(ah,{setApi:n,className:"w-full",children:[(0,a.jsx)(au,{children:s.map((e,s)=>(0,a.jsx)(ax,{children:(0,a.jsx)("div",{className:"p-1 [perspective:1000px]",children:(0,a.jsxs)("div",{className:(0,g.cn)("relative w-full h-80 rounded-lg transition-transform duration-700 [transform-style:preserve-3d]",o[s]?"[transform:rotateY(180deg)]":""),onClick:()=>h(s),children:[(0,a.jsx)(sv.Zp,{className:"absolute w-full h-full [backface-visibility:hidden] flex items-center justify-center p-6 text-center",children:(0,a.jsx)("p",{className:"text-2xl font-semibold",children:e.term})}),(0,a.jsx)(sv.Zp,{className:"absolute w-full h-full [backface-visibility:hidden] [transform:rotateY(180deg)] flex items-center justify-center p-6 text-center bg-secondary",children:(0,a.jsx)("p",{className:"text-xl",children:e.definition})})]})})},e.id))}),(0,a.jsx)(aj,{}),(0,a.jsx)(af,{})]}),(0,a.jsxs)("div",{className:"w-full px-12 space-y-2",children:[(0,a.jsxs)("div",{className:"py-2 text-center text-sm text-muted-foreground",children:["Karte ",l," von ",c]}),(0,a.jsx)(eQ,{value:l/c*100}),(0,a.jsx)("div",{className:"text-center text-xs text-muted-foreground pt-1",children:"Klicke auf die Karte oder dr\xfccke die Leertaste, um sie umzudrehen."})]})]})}af.displayName="CarouselNext";var ag=t(94542),aN=t(67554),ab=t(24371);let av=(0,eD.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),aw=r.forwardRef((e,s)=>{let{className:t,variant:r,...n}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,g.cn)(av({variant:r}),t),...n})});aw.displayName="Alert";let ay=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h5",{ref:s,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})});ay.displayName="AlertTitle";let ak=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",t),...r})});ak.displayName="AlertDescription";let aS=(0,so.createServerReference)("404ab3692158f3c59c6c1f1745f9b4a0a2fb4f02dd",so.callServer,void 0,so.findSourceMapURL,"evaluateAnswer");function aA(e){let{cards:s}=e,[t,n]=(0,r.useState)([]),[l,i]=(0,r.useState)(0),[c,d]=(0,r.useState)(""),[o,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[j,f]=(0,r.useState)(null),[p,N]=(0,r.useState)({correct:new Set,incorrect:new Set}),[b,v]=(0,r.useState)(!1),w=(0,r.useRef)(null);(0,r.useEffect)(()=>{y()},[s]);let y=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=s;if(e){let e=s.filter(e=>p.incorrect.has(e.id));e.length>0&&(t=e)}n((0,ag.A)(t)),i(0),d(""),m(!1),f(null),N({correct:new Set,incorrect:new Set}),v(!1),setTimeout(()=>{var e;return null==(e=w.current)?void 0:e.focus()},100)},k=t[l],S=async e=>{if(e.preventDefault(),c.trim()&&k&&!h){x(!0),m(!0),f(null);try{let e=await aS({userAnswer:c,correctTerm:k.term,definition:k.definition});f({isCorrect:e.isCorrect,feedback:e.feedback}),N(s=>{let t={...s};return e.isCorrect?t.correct.add(k.id):t.incorrect.add(k.id),t})}catch(s){console.error("Evaluation error:",s);let e=c.trim().toLowerCase()===k.term.toLowerCase();f({isCorrect:e,feedback:e?"Richtig!":"Die richtige Antwort lautet: ".concat(k.term)}),N(s=>{let t={...s};return e?t.correct.add(k.id):t.incorrect.add(k.id),t})}finally{x(!1)}}};return 0===t.length?null:b?(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto text-center",children:[(0,a.jsx)(sv.aR,{children:(0,a.jsx)(sv.ZB,{className:"text-2xl",children:"Runde beendet!"})}),(0,a.jsx)(sv.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-green-100/60 dark:bg-green-900/30 rounded-lg",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:p.correct.size}),(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Richtig"})]}),(0,a.jsxs)("div",{className:"p-4 bg-red-100/60 dark:bg-red-900/30 rounded-lg",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:p.incorrect.size}),(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Falsch"})]})]})}),(0,a.jsxs)(sv.wL,{className:"flex-col sm:flex-row gap-2",children:[(0,a.jsxs)(u.$,{onClick:()=>y(!1),className:"w-full",children:[(0,a.jsx)(aN.A,{className:"mr-2 h-4 w-4"}),"Neu starten"]}),p.incorrect.size>0&&(0,a.jsxs)(u.$,{onClick:()=>y(!0),variant:"outline",className:"w-full",children:[(0,a.jsx)(sy.A,{className:"mr-2 h-4 w-4"}),"Fehler wiederholen (",p.incorrect.size,")"]})]})]}):(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Schreiben"}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-muted-foreground pt-2",children:[(0,a.jsx)("span",{children:"Fortschritt"}),(0,a.jsxs)("span",{children:[l+1," / ",t.length]})]}),(0,a.jsx)(eQ,{value:(l+1)/t.length*100})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"p-4 bg-muted rounded-md min-h-[100px] flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-center font-medium",children:null==k?void 0:k.definition})}),(0,a.jsxs)("form",{onSubmit:S,children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(Y.p,{ref:w,placeholder:"Tippe den Begriff...",value:c,onChange:e=>d(e.target.value),disabled:o||h,className:(0,g.cn)("pr-10 h-12 text-base",o&&(null==j?void 0:j.isCorrect)&&"border-green-500 focus-visible:ring-green-500",o&&!(null==j?void 0:j.isCorrect)&&"border-red-500 focus-visible:ring-red-500")}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-3 flex items-center",children:h?(0,a.jsx)(sl.A,{className:"h-5 w-5 animate-spin"}):o&&((null==j?void 0:j.isCorrect)?(0,a.jsx)(tb.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(ab.A,{className:"h-5 w-5 text-red-500"}))})]}),!o&&(0,a.jsxs)(u.$,{type:"submit",className:"w-full mt-4",disabled:!c.trim()||h,children:[h&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Antwort pr\xfcfen"]})]}),o&&j&&(0,a.jsxs)(aw,{variant:j.isCorrect?"default":"destructive",className:(0,g.cn)("animate-fade-in-down",j.isCorrect&&"border-green-300 bg-green-50/50 dark:border-green-700 dark:bg-green-900/30"),children:[(0,a.jsxs)(ay,{className:"flex items-center gap-2",children:[j.isCorrect?(0,a.jsx)(tb.A,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(ab.A,{className:"h-4 w-4 text-red-600"}),"Feedback"]}),(0,a.jsx)(ak,{children:j.feedback})]})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsx)(u.$,{onClick:()=>{l<t.length-1?(i(e=>e+1),d(""),m(!1),f(null),setTimeout(()=>{var e;return null==(e=w.current)?void 0:e.focus()},100)):v(!0)},className:"w-full",disabled:!o||h,children:"Weiter"})})]})}let aC=(0,so.createServerReference)("40087894e79b2e152cb3d59e1f3c134627f51879b3",so.callServer,void 0,so.findSourceMapURL,"generateStudySetQuiz");function aD(e){let{studySet:s}=e,[t,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(0),[h,x]=(0,r.useState)(null),[j,f]=(0,r.useState)(!1),[p,N]=(0,r.useState)(0),[b,v]=(0,r.useState)(!1),[w,y]=(0,r.useState)(Date.now());(0,r.useEffect)(()=>{(async()=>{n(!0),i(null),v(!1),m(0),N(0);try{let e=await aC({title:s.title,description:s.description,cards:s.cards});d(e.questions)}catch(e){console.error("Failed to generate quiz:",e),i("Das KI-Quiz konnte nicht erstellt werden. Bitte versuche es sp\xe4ter erneut.")}finally{n(!1)}})()},[s,w]);let k=e=>{j||(x(e),f(!0),e===c[o].correctAnswer&&N(e=>e+1))};if(t)return(0,a.jsxs)(sv.Zp,{className:"flex flex-col items-center justify-center min-h-[400px]",children:[(0,a.jsx)(sl.A,{className:"h-8 w-8 animate-spin text-primary mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Dein pers\xf6nliches Quiz wird erstellt..."})]});if(l)return(0,a.jsxs)(aw,{variant:"destructive",children:[(0,a.jsx)(ab.A,{className:"h-4 w-4"}),(0,a.jsx)(ay,{children:"Fehler"}),(0,a.jsx)(ak,{children:l})]});if(b){let e=Math.round(p/c.length*100);return(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto text-center",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{className:"text-2xl",children:"Quiz beendet!"}),(0,a.jsx)(sv.BT,{children:"Hier ist dein Ergebnis."})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-5xl font-bold text-primary",children:[e,"%"]}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Du hast ",p," von ",c.length," Fragen richtig beantwortet."]})]}),(0,a.jsx)(eQ,{value:e,className:"h-2"})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsxs)(u.$,{onClick:()=>{y(Date.now())},className:"w-full",children:[(0,a.jsx)(aN.A,{className:"mr-2 h-4 w-4"}),"Neues Quiz generieren"]})})]})}let S=c[o];return(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ei.A,{className:"h-5 w-5 text-primary"})," KI-Quiz"]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Frage ",o+1," / ",c.length]})]}),(0,a.jsx)(eQ,{value:(o+1)/c.length*100})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-6",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-center min-h-[56px] flex items-center justify-center",children:S.question}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:S.options.map((e,s)=>{let t=e===S.correctAnswer,r=e===h;return(0,a.jsxs)(u.$,{variant:"outline",className:(0,g.cn)("h-auto justify-start text-left whitespace-normal py-3",j&&t&&"bg-green-100 border-green-400 text-green-900 dark:bg-green-900/50 dark:border-green-700 dark:text-green-300",j&&r&&!t&&"bg-red-100 border-red-400 text-red-900 dark:bg-red-900/50 dark:border-red-700 dark:text-red-300"),onClick:()=>k(e),disabled:j,children:[(0,a.jsx)("span",{className:"mr-3 font-bold",children:String.fromCharCode(65+s)}),(0,a.jsx)("span",{className:"flex-1",children:e}),j&&t&&(0,a.jsx)(tb.A,{className:"h-5 w-5"}),j&&r&&!t&&(0,a.jsx)(ab.A,{className:"h-5 w-5"})]},s)})}),j&&(0,a.jsxs)(aw,{className:(0,g.cn)(h===S.correctAnswer?"border-green-300 bg-green-50/50":"border-red-300 bg-red-50/50"),children:[(0,a.jsxs)(ay,{className:"flex items-center gap-2",children:[h===S.correctAnswer?(0,a.jsx)(tb.A,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(ab.A,{className:"h-4 w-4 text-red-600"}),h===S.correctAnswer?"Richtig!":"Falsch"]}),(0,a.jsx)(ak,{children:S.explanation})]})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsx)(u.$,{onClick:()=>{o<c.length-1?(m(e=>e+1),f(!1),x(null)):v(!0)},className:"w-full",disabled:!j,children:o<c.length-1?"N\xe4chste Frage":"Quiz beenden"})})]})}var aF=t(11518),aE=t.n(aF),az=t(85268),aL=t(16995),aB=t(59099);function aR(e){let{cards:s}=e,[t,n]=(0,r.useState)([]),[l,i]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[j,f]=(0,r.useState)(0),[p,N]=(0,r.useState)(!1),b=()=>{let e=[];s.forEach(s=>{e.push({id:s.id,type:"term",content:s.term,uniqueId:"".concat(s.id,"-term")}),e.push({id:s.id,type:"definition",content:s.definition,uniqueId:"".concat(s.id,"-def")})}),n((0,ag.A)(e)),i(null),d([]),m(null),N(!1),x(Date.now()),f(0)};(0,r.useEffect)(()=>{b()},[s]),(0,r.useEffect)(()=>{if(h&&!p){let e=setInterval(()=>{f(Date.now()-h)},100);return()=>clearInterval(e)}},[h,p]);let v=e=>{if(!(o||c.includes(e.id)))if(l){if(l.uniqueId===e.uniqueId)return void i(null);l.id===e.id&&l.type!==e.type?(d(s=>[...s,e.id]),i(null),c.length+1===s.length&&(N(!0),x(null))):(m([l.uniqueId,e.uniqueId]),setTimeout(()=>{m(null),i(null)},800))}else i(e)},w=e=>(e/1e3).toFixed(2);return p?(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto text-center",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(az.A,{className:"h-12 w-12 text-yellow-500"})}),(0,a.jsx)(sv.ZB,{className:"text-2xl",children:"Geschafft!"}),(0,a.jsx)(sv.BT,{children:"Du hast alle Paare gefunden."})]}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsxs)("p",{className:"text-4xl font-bold text-primary",children:[w(j),"s"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Deine Zeit"})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsxs)(u.$,{onClick:b,className:"w-full",children:[(0,a.jsx)(aN.A,{className:"mr-2 h-4 w-4"}),"Nochmal spielen"]})})]}):(0,a.jsxs)(sv.Zp,{className:"w-full max-w-4xl mx-auto",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Zuordnen"}),(0,a.jsx)(sv.BT,{children:"Klicke auf einen Begriff und die passende Definition, um sie verschwinden zu lassen."})]}),(0,a.jsxs)(sv.Wu,{children:[(0,a.jsxs)("div",{className:"jsx-85dbb413b03dd5d2 flex justify-between items-center mb-4 p-2 bg-muted rounded-md",children:[(0,a.jsxs)(u.$,{variant:"ghost",onClick:b,children:[(0,a.jsx)(aL.A,{className:"mr-2 h-4 w-4"}),"Mischen"]}),(0,a.jsxs)("div",{className:"jsx-85dbb413b03dd5d2 flex items-center gap-2 text-lg font-semibold text-primary",children:[(0,a.jsx)(aB.A,{className:"h-5 w-5"}),(0,a.jsxs)("span",{className:"jsx-85dbb413b03dd5d2",children:[w(j),"s"]})]})]}),(0,a.jsx)("div",{className:"jsx-85dbb413b03dd5d2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.map(e=>{let s=c.includes(e.id),t=(null==l?void 0:l.uniqueId)===e.uniqueId,r=null==o?void 0:o.includes(e.uniqueId);return(0,a.jsx)("div",{onClick:()=>v(e),className:"jsx-85dbb413b03dd5d2 "+((0,g.cn)("h-28 flex items-center justify-center p-3 text-center rounded-lg border text-sm font-medium cursor-pointer transition-all duration-300",s?"opacity-0 scale-50 pointer-events-none":"opacity-100 scale-100",t&&"ring-2 ring-primary bg-primary/10",r?"bg-red-100 dark:bg-red-900/50 border-red-500 animate-shake":"bg-card hover:bg-muted/50")||""),children:e.content},e.uniqueId)})})]}),(0,a.jsx)(aE(),{id:"85dbb413b03dd5d2",children:"@-webkit-keyframes shake{0%,100%{-webkit-transform:translatex(0);transform:translatex(0)}25%{-webkit-transform:translatex(-5px);transform:translatex(-5px)}75%{-webkit-transform:translatex(5px);transform:translatex(5px)}}@-moz-keyframes shake{0%,100%{-moz-transform:translatex(0);transform:translatex(0)}25%{-moz-transform:translatex(-5px);transform:translatex(-5px)}75%{-moz-transform:translatex(5px);transform:translatex(5px)}}@-o-keyframes shake{0%,100%{-o-transform:translatex(0);transform:translatex(0)}25%{-o-transform:translatex(-5px);transform:translatex(-5px)}75%{-o-transform:translatex(5px);transform:translatex(5px)}}@keyframes shake{0%,100%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}25%{-webkit-transform:translatex(-5px);-moz-transform:translatex(-5px);-o-transform:translatex(-5px);transform:translatex(-5px)}75%{-webkit-transform:translatex(5px);-moz-transform:translatex(5px);-o-transform:translatex(5px);transform:translatex(5px)}}.animate-shake.jsx-85dbb413b03dd5d2{-webkit-animation:shake.4s ease-in-out;-moz-animation:shake.4s ease-in-out;-o-animation:shake.4s ease-in-out;animation:shake.4s ease-in-out}"})]})}let aI=(0,so.createServerReference)("40ed7a86d3af4f33b918085f54501f0168a967c4fc",so.callServer,void 0,so.findSourceMapURL,"generateStudySetTest");function aO(e){let{studySet:s}=e,[t,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(0),[h,x]=(0,r.useState)({}),[j,f]=(0,r.useState)({}),[p,N]=(0,r.useState)(!1),[b,v]=(0,r.useState)(Date.now()),w=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{n(!0),i(null),N(!1),m(0),x({}),f({});try{let e=await aI({title:s.title,description:s.description,cards:s.cards});d(e.questions)}catch(e){console.error("Failed to generate test:",e),i("Der KI-Test konnte nicht erstellt werden. Bitte versuche es sp\xe4ter erneut.")}finally{n(!1)}})()},[s,b]);let y=c[o],k=e=>{x(s=>({...s,[o]:e}))},S=async(e,s,t)=>(await aS({userAnswer:e,correctTerm:s,definition:t})).isCorrect,A=async()=>{let e=h[o];if(!e)return;f(e=>({...e,[o]:"checking"}));let s=!1;s="written"===y.type?await S(e,y.correctAnswer,y.question):e===y.correctAnswer,f(e=>({...e,[o]:s?"correct":"incorrect"}))},C=Object.values(j).filter(e=>"correct"===e).length;if(t)return(0,a.jsxs)(sv.Zp,{className:"flex flex-col items-center justify-center min-h-[400px]",children:[(0,a.jsx)(sl.A,{className:"h-8 w-8 animate-spin text-primary mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Dein pers\xf6nlicher Test wird erstellt..."})]});if(l)return(0,a.jsxs)(aw,{variant:"destructive",children:[(0,a.jsx)(ab.A,{className:"h-4 w-4"}),(0,a.jsx)(ay,{children:"Fehler"}),(0,a.jsx)(ak,{children:l})]});if(p){let e=Math.round(C/c.length*100);return(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto text-center",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(az.A,{className:"h-12 w-12 text-yellow-500"})}),(0,a.jsx)(sv.ZB,{className:"text-2xl",children:"Test beendet!"}),(0,a.jsx)(sv.BT,{children:"Hier ist dein Ergebnis."})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-5xl font-bold text-primary",children:[e,"%"]}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Du hast ",C," von ",c.length," Fragen richtig beantwortet."]})]}),(0,a.jsx)(eQ,{value:e,className:"h-2"})]}),(0,a.jsx)(sv.wL,{children:(0,a.jsxs)(u.$,{onClick:()=>{v(Date.now())},className:"w-full",children:[(0,a.jsx)(aN.A,{className:"mr-2 h-4 w-4"}),"Neuen Test generieren"]})})]})}if(0===c.length)return null;let D="correct"===j[o]||"incorrect"===j[o];return(0,a.jsxs)(sv.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)(sv.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(ac.A,{className:"h-5 w-5 text-primary"})," KI-Test"]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Frage ",o+1," / ",c.length]})]}),(0,a.jsx)(eQ,{value:(o+1)/c.length*100})]}),(0,a.jsxs)(sv.Wu,{className:"space-y-6",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-center min-h-[56px] flex items-center justify-center",children:"true-false"===y.type?y.statement:y.question}),(0,a.jsx)("div",{className:"space-y-4",children:(()=>{let e=j[o]||"unanswered",s="correct"===e||"incorrect"===e,t=h[o];switch(y.type){case"multiple-choice":return(0,a.jsx)(Q.z,{onValueChange:k,value:t,disabled:s,className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:y.options.map((e,r)=>{let n=e===y.correctAnswer,l=e===t;return(0,a.jsxs)(H.J,{className:(0,g.cn)("flex items-center gap-3 rounded-lg border p-3 cursor-pointer transition-all",s&&n&&"bg-green-100 border-green-400 dark:bg-green-900/50 dark:border-green-700",s&&l&&!n&&"bg-red-100 border-red-400 dark:bg-red-900/50 dark:border-red-700",!s&&"hover:bg-muted/50"),children:[(0,a.jsx)(Q.C,{value:e,id:"option-".concat(r)}),(0,a.jsx)("span",{children:e})]},r)})});case"written":return(0,a.jsx)(Y.p,{ref:w,placeholder:"Tippe den Begriff...",value:t||"",onChange:e=>k(e.target.value),disabled:s,className:(0,g.cn)("h-12 text-base",s&&"correct"===e&&"border-green-500 focus-visible:ring-green-500",s&&"incorrect"===e&&"border-red-500 focus-visible:ring-red-500")});case"true-false":return(0,a.jsx)(Q.z,{onValueChange:k,value:t,disabled:s,className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:["Wahr","Falsch"].map((e,r)=>{let n=e===y.correctAnswer,l=e===t;return(0,a.jsxs)(H.J,{className:(0,g.cn)("flex items-center gap-3 rounded-lg border p-3 cursor-pointer transition-all text-lg justify-center",s&&n&&"bg-green-100 border-green-400 dark:bg-green-900/50 dark:border-green-700",s&&l&&!n&&"bg-red-100 border-red-400 dark:bg-red-900/50 dark:border-red-700",!s&&"hover:bg-muted/50"),children:[(0,a.jsx)(Q.C,{value:e,id:"option-".concat(r)}),(0,a.jsx)("span",{children:e})]},r)})});default:return null}})()}),D&&(0,a.jsxs)(aw,{className:(0,g.cn)("animate-fade-in-down","correct"===j[o]?"border-green-300 bg-green-50/50":"border-red-300 bg-red-50/50"),children:[(0,a.jsxs)(ay,{className:"flex items-center gap-2",children:["correct"===j[o]?(0,a.jsx)(tb.A,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(ab.A,{className:"h-4 w-4 text-red-600"}),"correct"===j[o]?"Richtig!":"Falsch"]}),(0,a.jsx)(ak,{children:y.explanation})]})]}),(0,a.jsx)(sv.wL,{children:D?(0,a.jsx)(u.$,{onClick:()=>{o<c.length-1?m(e=>e+1):N(!0)},className:"w-full",children:o<c.length-1?"N\xe4chste Frage":"Test beenden"}):(0,a.jsxs)(u.$,{onClick:A,className:"w-full",disabled:!h[o]||"checking"===j[o],children:["checking"===j[o]?(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Antwort best\xe4tigen"]})})]})}function aT(e){let{studySet:s,onBack:t,onEditSet:n}=e,[l,i]=(0,r.useState)("list"),c=s.cards.length>0;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(u.$,{variant:"ghost",onClick:t,className:"mb-4",children:[(0,a.jsx)(t5.A,{className:"mr-2 h-4 w-4"}),"Zur\xfcck zu allen Lernsets"]}),(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:s.title}),s.description&&(0,a.jsx)("p",{className:"text-lg text-muted-foreground mt-1",children:s.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-2",children:[(0,a.jsx)(at.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[s.cards.length," Begriff",1!==s.cards.length?"e":""]})]})]}),(0,a.jsxs)(u.$,{variant:"outline",onClick:()=>n(s),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"}),"Bearbeiten"]})]})]}),(0,a.jsxs)(sb.tU,{value:l,onValueChange:e=>i(e),className:"w-full",children:[(0,a.jsxs)(sb.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-6 max-w-4xl",children:[(0,a.jsxs)(sb.Xi,{value:"list",children:[(0,a.jsx)(sc.A,{className:"mr-2 h-4 w-4"})," Begriffe"]}),(0,a.jsxs)(sb.Xi,{value:"flashcards",disabled:!c,children:[(0,a.jsx)(at.A,{className:"mr-2 h-4 w-4"}),"Karten"]}),(0,a.jsxs)(sb.Xi,{value:"write",disabled:!c,children:[(0,a.jsx)(al.A,{className:"mr-2 h-4 w-4"}),"Schreiben"]}),(0,a.jsxs)(sb.Xi,{value:"match",disabled:!c,children:[(0,a.jsx)(ai.A,{className:"mr-2 h-4 w-4"}),"Zuordnen"]}),(0,a.jsxs)(sb.Xi,{value:"quiz",disabled:!c,children:[(0,a.jsx)(ei.A,{className:"mr-2 h-4 w-4"}),"KI-Quiz"]}),(0,a.jsxs)(sb.Xi,{value:"test",disabled:!c,children:[(0,a.jsx)(ac.A,{className:"mr-2 h-4 w-4"}),"Test"]})]}),(0,a.jsx)(sb.av,{value:"list",className:"mt-4",children:(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:"Begriffe im Lernset"}),(0,a.jsx)(sv.BT,{children:"Hier ist eine \xdcbersicht aller Begriffe und Definitionen in diesem Set."})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsx)(st.F,{className:"h-[50vh] pr-4",children:(0,a.jsxs)(s3.XI,{children:[(0,a.jsx)(s3.A0,{children:(0,a.jsxs)(s3.Hj,{children:[(0,a.jsx)(s3.nd,{className:"w-1/2",children:"Begriff"}),(0,a.jsx)(s3.nd,{className:"w-1/2",children:"Definition"})]})}),(0,a.jsx)(s3.BF,{children:s.cards.map(e=>(0,a.jsxs)(s3.Hj,{children:[(0,a.jsx)(s3.nA,{className:"font-medium",children:e.term}),(0,a.jsx)(s3.nA,{children:e.definition})]},e.id))})]})})})]})}),(0,a.jsx)(sb.av,{value:"flashcards",className:"mt-4",children:c?(0,a.jsx)(ap,{cards:s.cards}):null}),(0,a.jsx)(sb.av,{value:"write",className:"mt-4",children:c?(0,a.jsx)(aA,{cards:s.cards}):null}),(0,a.jsx)(sb.av,{value:"match",className:"mt-4",children:c?(0,a.jsx)(aR,{cards:s.cards}):null}),(0,a.jsx)(sb.av,{value:"quiz",className:"mt-4",children:c?(0,a.jsx)(aD,{studySet:s}):null}),(0,a.jsx)(sb.av,{value:"test",className:"mt-4",children:c?(0,a.jsx)(aO,{studySet:s}):null})]})]})}var aM=t(34301);let aZ=M.Ik({id:M.Yj(),term:M.Yj().min(1,"Begriff darf nicht leer sein."),definition:M.Yj().min(1,"Definition darf nicht leer sein.")}),a$=M.Ik({title:M.Yj().min(1,"Titel darf nicht leer sein.").max(100),description:M.Yj().max(500).optional(),subjectId:M.Yj().optional(),cards:M.YO(aZ).min(1,"Es muss mindestens eine Karteikarte vorhanden sein.")});function aH(e){let{onBack:s,onSave:t,studySetToEdit:n,subjects:l}=e,i=(0,T.mN)({resolver:(0,O.u)(a$),defaultValues:{title:"",description:"",subjectId:void 0,cards:[{id:"new-".concat(Date.now()),term:"",definition:""}]}}),{fields:c,append:d,remove:o}=(0,T.jz)({control:i.control,name:"cards"});(0,r.useEffect)(()=>{n?i.reset({title:n.title,description:n.description||"",subjectId:n.subjectId||void 0,cards:n.cards}):i.reset({title:"",description:"",subjectId:void 0,cards:[{id:"new-".concat(Date.now()),term:"",definition:""}]})},[n,i]);let m=async e=>{await t(e,null==n?void 0:n.id)},{isSubmitting:h}=i.formState,x=n?"Lernset bearbeiten":"Neues Lernset erstellen",j=n?"\xc4ndere die Details deines Lernsets.":"Erstelle ein neues Lernset mit Begriffen und Definitionen.";return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(u.$,{variant:"ghost",onClick:s,disabled:h,children:[(0,a.jsx)(t5.A,{className:"mr-2 h-4 w-4"}),"Zur\xfcck zu allen Lernsets"]})}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:x}),(0,a.jsx)(sv.BT,{children:j})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsx)(W,{...i,children:(0,a.jsxs)("form",{onSubmit:i.handleSubmit(m),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(G,{control:i.control,name:"title",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Titel"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Biologie - Zellbiologie",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:i.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Beschreibung (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Kapitel 1-3 im Lehrbuch",...s})}),(0,a.jsx)(q,{})]})}})]}),(0,a.jsx)(G,{control:i.control,name:"subjectId",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fach (optional)"}),(0,a.jsxs)(N,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(U,{children:(0,a.jsx)(v,{children:(0,a.jsx)(b,{placeholder:"Einem Fach zuordnen..."})})}),(0,a.jsx)(k,{children:l.map(e=>(0,a.jsx)(S,{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(eu,{}),(0,a.jsx)("div",{className:"space-y-4",children:c.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg space-y-3 relative bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)(V,{className:"font-semibold",children:["Karte ",s+1]}),(0,a.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-destructive",onClick:()=>o(s),disabled:c.length<=1,children:(0,a.jsx)(em.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(G,{control:i.control,name:"cards.".concat(s,".term"),render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Begriff"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"z.B. Mitochondrium",...s,className:"bg-background"})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:i.control,name:"cards.".concat(s,".definition"),render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Definition"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"z.B. Kraftwerk der Zelle",...s,className:"bg-background"})}),(0,a.jsx)(q,{})]})}})]})]},e.id))}),(0,a.jsx)("div",{children:(0,a.jsxs)(u.$,{type:"button",variant:"outline",className:"w-full",onClick:()=>d({id:"new-".concat(Date.now()),term:"",definition:""}),children:[(0,a.jsx)(aM.A,{className:"mr-2 h-4 w-4"}),"Karte hinzuf\xfcgen"]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:s,disabled:h,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:h,children:[h&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),n?"\xc4nderungen speichern":"Lernset erstellen"]})]})]})})})]})]})}var aW=t(40295),aP=t(71707),aG=t(66655),a_=t(22897),aK=t(92401),aJ=t(70831),aV=t(44992),aU=t(80644),aq=t(53941),aY=t(52873),aQ=t(70593),aX=t(35594),a0=t(58111);let a1={Prüfung:"bg-red-500",Hausaufgabe:"bg-blue-500",Ferien:"bg-green-500",Veranstaltung:"bg-purple-500",Sonstiges:"bg-gray-500"},a4={Prüfung:aQ.A,Hausaufgabe:aP.A,Ferien:aX.A,Veranstaltung:a0.A,Sonstiges:tT.A};function a2(e){let{schoolId:s,schoolName:t,events:n,selectedGradeLevel:i,onAddEvent:c,onEditEvent:d,onDeleteEvent:o}=e,{user:m}=(0,l.A)(),[h,x]=(0,r.useState)(new Date),j=(0,r.useMemo)(()=>n.filter(e=>"school"===e.target||"gradeLevel"===e.target&&e.gradeLevel===i),[n,i]),f=(0,r.useMemo)(()=>{let e=[],s=[];for(let t of j)"Ferien"===t.type&&t.endDate?e.push({from:new Date(t.date),to:new Date(t.endDate)}):s.push(new Date(t.date));return{holidays:e,singleDays:s}},[j]),p=(0,r.useMemo)(()=>j.filter(e=>{let s=(0,aU.o)(new Date(e.date)),t=e.endDate?(0,aq.D)(new Date(e.endDate)):(0,aq.D)(s);return(0,aY.v)(h,{start:s,end:t})}).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),[j,h]),N=e=>{x(e)};return s&&t?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold",children:["Kalender: ",t]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Geteilte Termine f\xfcr alle an deiner Schule."})]}),(0,a.jsxs)(u.$,{onClick:()=>c(h),children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Neuer Termin"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)(sv.Zp,{className:"lg:col-span-2",children:(0,a.jsx)(sv.Wu,{className:"p-2",children:(0,a.jsx)(sq,{mode:"single",selected:h,onSelect:e=>e&&N(e),className:"w-full",locale:s_.de,modifiers:{holidays:f.holidays,events:f.singleDays},modifiersClassNames:{holidays:"day-with-range-event",events:"day-with-event"}})})}),(0,a.jsxs)(sv.Zp,{children:[(0,a.jsxs)(sv.aR,{children:[(0,a.jsx)(sv.ZB,{children:(0,eU.GP)(h,"eeee, dd. MMMM",{locale:s_.de})}),(0,a.jsx)(sv.BT,{children:"Termine an diesem Tag"})]}),(0,a.jsx)(sv.Wu,{children:(0,a.jsx)(st.F,{className:"h-[300px]",children:p.length>0?(0,a.jsx)("ul",{className:"space-y-3",children:p.map(e=>{let s=a4[e.type];return(0,a.jsxs)("li",{className:"flex items-start gap-3 group",children:[(0,a.jsx)("div",{className:(0,g.cn)("mt-1 flex h-8 w-8 shrink-0 items-center justify-center rounded-full text-white",a1[e.type]),children:(0,a.jsx)(s,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.title}),(null==m?void 0:m.uid)===e.authorId?(0,a.jsxs)(F,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(ed.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(z,{align:"end",children:[(0,a.jsxs)(L,{onClick:()=>d(e),children:[(0,a.jsx)(eo.A,{className:"mr-2 h-4 w-4"})," Bearbeiten"]}),(0,a.jsxs)(ex.Lt,{children:[(0,a.jsx)(ex.tv,{asChild:!0,children:(0,a.jsxs)(L,{onSelect:e=>e.preventDefault(),className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"})," L\xf6schen"]})}),(0,a.jsxs)(ex.EO,{children:[(0,a.jsxs)(ex.wd,{children:[(0,a.jsx)(ex.r7,{children:"Termin l\xf6schen?"}),(0,a.jsx)(ex.$v,{children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden."})]}),(0,a.jsxs)(ex.ck,{children:[(0,a.jsx)(ex.Zr,{children:"Abbrechen"}),(0,a.jsx)(ex.Rx,{onClick:()=>o(e.id),className:"bg-destructive hover:bg-destructive/90",children:"L\xf6schen"})]})]})]})]})]}):(0,a.jsx)("div",{className:"w-7 h-7 shrink-0"})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,a.jsx)(eE,{variant:"outline",className:"text-xs",children:e.type}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["von ",e.authorName]})]})]})]},e.id)})}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center pt-10",children:"Keine Termine an diesem Tag."})})})]})]})]})}):(0,a.jsxs)("div",{className:"text-center py-20 flex flex-col items-center justify-center min-h-[60vh] bg-background/50 rounded-lg border border-dashed",children:[(0,a.jsx)("div",{className:"p-3 bg-primary/10 rounded-full border-8 border-primary/5 mb-4",children:(0,a.jsx)(el.A,{className:"h-8 w-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Schulkalender"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 max-w-md",children:"Bitte w\xe4hle zuerst deine Schule in den Profileinstellungen aus, um den geteilten Kalender zu nutzen."})]})}function a5(e){let{events:s,onNavigate:t}=e,n=(0,r.useMemo)(()=>{let e=(0,aK.R)(),t=(0,aJ.f)((0,aV.o)(),7);return s.filter(s=>{let a=(0,aU.o)(new Date(s.date)),r=s.endDate?(0,aq.D)(new Date(s.endDate)):(0,aq.D)(a);return(0,aY.v)(a,{start:e,end:t})||(0,aY.v)(e,{start:a,end:r})}).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()).slice(0,5)},[s]);return(0,a.jsxs)(sv.Zp,{className:"h-full w-full flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"Schulkalender"}),(0,a.jsx)(sv.BT,{children:"N\xe4chste 7 Tage"})]}),(0,a.jsx)(aW.A,{className:"text-muted-foreground"})]}),(0,a.jsx)(sv.Wu,{className:"flex-1",children:n.length>0?(0,a.jsx)(st.F,{className:"h-full",children:(0,a.jsx)("div",{className:"space-y-3 pr-2",children:n.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,a.jsx)("div",{className:(0,g.cn)("w-2 h-10 rounded-full",a1[e.type])}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-sm truncate",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,eU.GP)(new Date(e.date),"eeee, dd.MM.",{locale:s_.de})})]})]},e.id))})}):(0,a.jsxs)("div",{className:"text-center py-10 h-full flex flex-col items-center justify-center",children:[(0,a.jsx)(sK.A,{className:"h-10 w-10 mx-auto text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 font-semibold",children:"Keine Termine"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"In den n\xe4chsten 7 Tagen ist nichts geplant."})]})}),(0,a.jsx)(sv.wL,{className:"mt-auto border-t pt-4",children:(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",className:"w-full justify-center text-muted-foreground",onClick:()=>t("school-calendar"),children:["Vollst\xe4ndigen Kalender anzeigen ",(0,a.jsx)(sH.A,{className:"ml-2 h-4 w-4"})]})})]})}let a3=(0,a_.WidthProvider)(a_.Responsive),a6=e=>{let{title:s,value:t,icon:r}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-lg bg-background p-3",children:[(0,a.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,a.jsx)(r,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:s}),(0,a.jsx)("p",{className:"text-xl font-bold",children:t})]})]})},a8={lg:[{i:"performance",x:0,y:0,w:2,h:2,minW:2,minH:2},{i:"actions",x:2,y:0,w:1,h:2,minW:1,minH:2},{i:"upcoming",x:0,y:2,w:1,h:2,minW:1,minH:2},{i:"homework",x:1,y:2,w:1,h:2,minW:1,minH:2},{i:"calendar",x:2,y:2,w:1,h:2,minW:1,minH:2},{i:"tutor",x:0,y:4,w:1,h:2,minW:1,minH:2}],md:[{i:"performance",x:0,y:0,w:2,h:2,minW:2,minH:2},{i:"actions",x:0,y:2,w:1,h:2,minW:1,minH:2},{i:"upcoming",x:1,y:2,w:1,h:2,minW:1,minH:2},{i:"homework",x:0,y:4,w:1,h:2,minW:1,minH:2},{i:"calendar",x:1,y:4,w:1,h:2,minW:1,minH:2},{i:"tutor",x:0,y:6,w:1,h:2,minW:1,minH:2}],sm:[{i:"performance",x:0,y:0,w:1,h:2,minW:1,minH:2},{i:"actions",x:0,y:2,w:1,h:2,minW:1,minH:2},{i:"upcoming",x:0,y:4,w:1,h:2,minW:1,minH:2},{i:"homework",x:0,y:6,w:1,h:2,minW:1,minH:2},{i:"calendar",x:0,y:8,w:1,h:2,minW:1,minH:2},{i:"tutor",x:0,y:10,w:1,h:2,minW:1,minH:2}],xs:[{i:"performance",x:0,y:0,w:1,h:2,minW:1,minH:2},{i:"actions",x:0,y:2,w:1,h:2,minW:1,minH:2},{i:"upcoming",x:0,y:4,w:1,h:2,minW:1,minH:2},{i:"homework",x:0,y:6,w:1,h:2,minW:1,minH:2},{i:"calendar",x:0,y:8,w:1,h:2,minW:1,minH:2},{i:"tutor",x:0,y:10,w:1,h:2,minW:1,minH:2}]};function a7(e){let{userName:s,overallAverage:t,mainSubjectsAverage:r,minorSubjectsAverage:n,totalSubjectsCount:l,totalGradesCount:i,plannedGrades:c,homework:d,schoolEvents:o,subjects:m,onNavigate:h,onAddSubject:x,onAddGrade:j,onAddHomework:f,layouts:p,onLayoutChange:g,visibleWidgets:N,onOpenSettings:b}=e,v=new Map(m.map(e=>[e.id,e.name])),w=d.filter(e=>!e.isDone).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime()),y={performance:(0,a.jsxs)(sv.Zp,{className:"h-full w-full flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)(sv.ZB,{children:"Deine Leistungs\xfcbersicht"})}),(0,a.jsx)(aW.A,{className:"text-muted-foreground"})]}),(0,a.jsxs)(sv.Wu,{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"p-4 sm:p-6 bg-primary/5 rounded-xl flex flex-col justify-center items-center text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-primary",children:"Gesamtschnitt"}),(0,a.jsx)("p",{className:"text-5xl sm:text-6xl font-extrabold text-primary tracking-tight",children:t})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsx)(a6,{title:"Hauptf\xe4cher",value:r,icon:tN.A}),(0,a.jsx)(a6,{title:"Nebenf\xe4cher",value:n,icon:tN.A}),(0,a.jsx)(a6,{title:"F\xe4cher",value:l,icon:e5.A}),(0,a.jsx)(a6,{title:"Noten",value:i,icon:tb.A})]})]})]}),actions:(0,a.jsxs)(sv.Zp,{className:"h-full w-full flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"Bereit loszulegen?"}),(0,a.jsx)(sv.BT,{children:"F\xfcge F\xe4cher hinzu, um deine Noten zu verfolgen, oder erstelle Lernsets zum \xdcben."})]}),(0,a.jsx)(aW.A,{className:"text-muted-foreground"})]}),(0,a.jsxs)(sv.Wu,{className:"flex-1 grid gap-2 content-center",children:[(0,a.jsxs)(u.$,{onClick:x,size:"default",children:[(0,a.jsx)(en.A,{className:"mr-3"})," Neues Fach anlegen"]}),(0,a.jsxs)(u.$,{onClick:()=>h("studysets"),variant:"secondary",size:"default",children:[(0,a.jsx)(ei.A,{className:"mr-3"})," Zu den Lernsets"]})]})]}),upcoming:(0,a.jsxs)(sv.Zp,{className:"h-full w-full flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"Anstehende Pr\xfcfungen"}),(0,a.jsx)(sv.BT,{children:"Deine n\xe4chsten geplanten Klausuren und Tests."})]}),(0,a.jsx)(aW.A,{className:"text-muted-foreground"})]}),(0,a.jsx)(sv.Wu,{className:"flex-1",children:c.length>0?(0,a.jsx)("div",{className:"space-y-3",children:c.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 sm:p-3 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name||e.type}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:v.get(e.subjectId)||"Unbekanntes Fach"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold",children:(0,eU.GP)(new Date(e.date),"dd. MMMM",{locale:s_.de})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,eU.GP)(new Date(e.date),"eeee",{locale:s_.de})})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-10 h-full flex flex-col items-center justify-center",children:[(0,a.jsx)(sK.A,{className:"h-10 w-10 mx-auto text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 font-semibold",children:"Keine Pr\xfcfungen geplant"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"F\xfcge eine Note ohne Wert hinzu, um eine Pr\xfcfung zu planen."}),m.length>0&&(0,a.jsxs)(u.$,{variant:"secondary",className:"mt-4",onClick:()=>j(m[0].id),children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Termin planen"]})]})})]}),homework:(0,a.jsxs)(sv.Zp,{className:"h-full w-full flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"N\xe4chste Hausaufgaben"}),(0,a.jsx)(sv.BT,{children:"Deine dringendsten Aufgaben."})]}),(0,a.jsx)(aW.A,{className:"text-muted-foreground"})]}),(0,a.jsx)(sv.Wu,{className:"flex-1",children:w.length>0?(0,a.jsx)("div",{className:"space-y-3",children:w.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-2 sm:p-3 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsx)("p",{className:"font-semibold truncate",children:e.task}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:v.get(e.subjectId)||"Unbekanntes Fach"})]}),(0,a.jsxs)("div",{className:"text-right pl-2",children:[(0,a.jsx)("p",{className:"font-semibold",children:(0,eU.GP)(new Date(e.dueDate),"dd. MMM",{locale:s_.de})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,eU.GP)(new Date(e.dueDate),"eeee",{locale:s_.de})})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-10 h-full flex flex-col items-center justify-center",children:[(0,a.jsx)(aP.A,{className:"h-10 w-10 mx-auto text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 font-semibold",children:"Keine Hausaufgaben"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Du hast alle Aufgaben erledigt. Super!"})]})})]}),calendar:(0,a.jsx)(a5,{events:o,onNavigate:h}),tutor:(0,a.jsxs)(sv.Zp,{className:"h-full w-full bg-gradient-to-br from-primary/90 to-primary text-primary-foreground flex flex-col",children:[(0,a.jsxs)(sv.aR,{className:"drag-handle flex flex-row items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"KI-Tutor & Lern-Coach"}),(0,a.jsx)(sv.BT,{className:"text-primary-foreground/80",children:"Erhalte Lerntipps, stelle Fragen oder \xfcbe mit deinen Lernsets."})]}),(0,a.jsx)(aW.A,{className:"text-primary-foreground/80"})]}),(0,a.jsx)(sv.Wu,{className:"flex-1 flex items-center justify-center",children:(0,a.jsx)(sw.A,{className:"h-20 w-20 text-primary-foreground/30"})}),(0,a.jsx)(sv.wL,{children:(0,a.jsxs)(u.$,{variant:"ghost",className:"w-full bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground",onClick:()=>h("tutor"),children:["Chat starten ",(0,a.jsx)(sH.A,{className:"ml-2"})]})})]})},k=Object.keys(y).filter(e=>N[e]);return(0,a.jsxs)("div",{className:"container mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold",children:["Hallo, ",s||"Entdecker","!"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Willkommen zur\xfcck in deinem Noten-Cockpit."})]}),(0,a.jsxs)(u.$,{variant:"outline",onClick:b,children:[(0,a.jsx)(aG.A,{className:"mr-2 h-4 w-4"}),"Dashboard personalisieren"]})]}),(0,a.jsx)(a3,{layouts:p,breakpoints:{lg:1200,md:996,sm:768,xs:480},cols:{lg:3,md:2,sm:1,xs:1},rowHeight:150,draggableHandle:".drag-handle",onLayoutChange:g,resizeHandles:["se"],children:k.map(e=>(0,a.jsx)("div",{children:y[e]},e))})]})}var a9=t(8810),re=t(63482),rs=t(19616),rt=t(86054),ra=t(43949);let rr=M.Ik({subjectId:M.Yj({required_error:"Bitte w\xe4hle ein Fach aus."}),room:M.Yj().max(20,"Raum darf nicht l\xe4nger als 20 Zeichen sein.").optional()}),rn=M.Ik({name:M.Yj().min(2,"Der Name muss mindestens 2 Zeichen lang sein.").max(50),category:M.k5(["Hauptfach","Nebenfach"],{required_error:"Du musst eine Kategorie ausw\xe4hlen."}),targetGrade:M.vk(e=>""===e?void 0:e,M.au.number({invalid_type_error:"Muss eine Zahl sein"}).min(1,"Note muss 1-6 sein").max(6,"Note muss 1-6 sein").optional())});function rl(e){let{onAddSubject:s,onClose:t,onSubjectAdded:r}=e,n=(0,T.mN)({resolver:(0,O.u)(rn),defaultValues:{name:"",category:"Nebenfach"}}),{isSubmitting:l}=n.formState,i=async e=>{r(await s(e)),t()};return(0,a.jsxs)(Z.Cf,{children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Neues Fach erstellen"}),(0,a.jsx)(Z.rr,{children:"Erstelle ein neues Fach, das sofort im Stundenplan verwendet werden kann."})]}),(0,a.jsx)(W,{...n,children:(0,a.jsxs)("form",{onSubmit:n.handleSubmit(i),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:n.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fachname"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Sport",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:n.control,name:"category",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"Kategorie"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex space-x-4",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Hauptfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Hauptfach"})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"Nebenfach"})}),(0,a.jsx)(V,{className:"font-normal",children:"Nebenfach"})]})]})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:t,disabled:l,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:l,children:[l&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Fach erstellen"]})]})]})})]})}function ri(e){let{isOpen:s,onOpenChange:t,onSubmit:n,onDelete:l,onAddSubject:i,entryToEdit:c,subjects:d}=e,o=(0,T.mN)({resolver:(0,O.u)(rr)}),[m,h]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&o.reset({subjectId:(null==c?void 0:c.subjectId)||"",room:(null==c?void 0:c.room)||""})},[s,c,o]);let{isSubmitting:x}=o.formState,j=async e=>{await n(e),t(!1)},f=async()=>{await l(),t(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:c?"Stunde bearbeiten":"Neue Stunde hinzuf\xfcgen"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle ein Fach und optional einen Raum f\xfcr diese Stunde."})]}),(0,a.jsx)(W,{...o,children:(0,a.jsxs)("form",{onSubmit:o.handleSubmit(j),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:o.control,name:"subjectId",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fach"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(N,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(U,{children:(0,a.jsx)(v,{className:"flex-1",children:(0,a.jsx)(b,{placeholder:"W\xe4hle ein Fach..."})})}),(0,a.jsx)(k,{children:d.map(e=>(0,a.jsx)(S,{value:e.id,children:e.name},e.id))})]}),(0,a.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>h(!0),className:"shrink-0",children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"})," Neu"]})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:o.control,name:"room",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Raum (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. R101",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{className:"sm:justify-between",children:[c?(0,a.jsxs)(u.$,{type:"button",variant:"destructive",onClick:f,disabled:x,children:[x?(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(em.A,{className:"mr-2 h-4 w-4"}),"L\xf6schen"]}):(0,a.jsx)("div",{}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),disabled:x,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:x,children:[x&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Speichern"]})]})]})]})})]})}),(0,a.jsx)(Z.lG,{open:m,onOpenChange:h,children:(0,a.jsx)(rl,{onClose:()=>h(!1),onAddSubject:i,onSubjectAdded:e=>o.setValue("subjectId",e)})})]})}let rc=M.Ik({subjectId:M.Yj().min(1,"Bitte w\xe4hle ein Fach aus."),task:M.Yj().min(1,"Die Aufgabe darf nicht leer sein.").max(200),dueDateOption:M.k5(["next","second","custom"],{required_error:"Bitte w\xe4hle eine F\xe4lligkeit."}),customDate:M.p6().optional()}).refine(e=>"custom"!==e.dueDateOption||!!e.customDate,{message:"Bitte w\xe4hle ein benutzerdefiniertes Datum.",path:["customDate"]}),rd=(e,s,t)=>{let a=new Date;a.setHours(0,0,0,0);let r=(a.getDay()+6)%7,n=new Set(s.filter(s=>s.subjectId===e).map(e=>e.day));if(0===n.size){let e=new Date(a);return e.setDate(a.getDate()+7*t),e}let l=0;for(let e=1;e<=21;e++){let s=(r+e)%7;if(n.has(s)&&++l===t){let s=new Date(a);return s.setDate(a.getDate()+e),s}}let i=new Date(a);return i.setDate(a.getDate()+7*t),i};function ro(e){let{isOpen:s,onOpenChange:t,onSubmit:n,subjects:l,timetable:i}=e,c=(0,T.mN)({resolver:(0,O.u)(rc),defaultValues:{subjectId:"",task:"",dueDateOption:"next"}}),[d,o]=(0,r.useState)(new Date),[m,h]=(0,r.useState)(new Date),x=c.watch("subjectId"),j=c.watch("dueDateOption");(0,r.useEffect)(()=>{s&&c.reset({subjectId:"",task:"",dueDateOption:"next",customDate:void 0})},[s,c]),(0,r.useEffect)(()=>{x&&i&&(o(rd(x,i,1)),h(rd(x,i,2)))},[x,i]);let{isSubmitting:f}=c.formState,p=async e=>{let s;switch(e.dueDateOption){case"next":s=d;break;case"second":s=m;break;case"custom":s=e.customDate}await n({task:e.task,dueDate:s,subjectId:e.subjectId}),t(!1)};return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Neue Hausaufgabe erstellen"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle ein Fach und gib die Details der Hausaufgabe ein."})]}),(0,a.jsx)(W,{...c,children:(0,a.jsxs)("form",{onSubmit:c.handleSubmit(p),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:c.control,name:"subjectId",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Fach"}),(0,a.jsxs)(N,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(U,{children:(0,a.jsx)(v,{children:(0,a.jsx)(b,{placeholder:"W\xe4hle ein Fach..."})})}),(0,a.jsx)(k,{children:l.map(e=>(0,a.jsx)(S,{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"task",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Aufgabe"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"z.B. S. 42 Nr. 5a,b",className:"resize-none",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"dueDateOption",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"F\xe4llig"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex-col space-y-1",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-3 space-y-0 p-3 rounded-md border has-[:checked]:bg-muted",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"next",id:"due-next",disabled:!x})}),(0,a.jsxs)(H.J,{htmlFor:"due-next",className:(0,g.cn)("font-normal w-full cursor-pointer",!x&&"text-muted-foreground/50"),children:["N\xe4chste Stunde",x&&(0,a.jsxs)("span",{className:"text-muted-foreground block text-xs",children:["(",(0,eU.GP)(d,"eeee, dd.MM.yyyy",{locale:s_.de}),")"]})]})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-3 space-y-0 p-3 rounded-md border has-[:checked]:bg-muted",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"second",id:"due-second",disabled:!x})}),(0,a.jsxs)(H.J,{htmlFor:"due-second",className:(0,g.cn)("font-normal w-full cursor-pointer",!x&&"text-muted-foreground/50"),children:["In der 2. n\xe4chsten Stunde",x&&(0,a.jsxs)("span",{className:"text-muted-foreground block text-xs",children:["(",(0,eU.GP)(m,"eeee, dd.MM.yyyy",{locale:s_.de}),")"]})]})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-3 space-y-0 p-3 rounded-md border has-[:checked]:bg-muted",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"custom",id:"due-custom"})}),(0,a.jsx)(H.J,{htmlFor:"due-custom",className:"font-normal w-full cursor-pointer",children:"Datum w\xe4hlen"})]})]})}),(0,a.jsx)(q,{})]})}}),"custom"===j&&(0,a.jsx)(G,{control:c.control,name:"customDate",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"flex flex-col animate-fade-in-down",children:[(0,a.jsxs)(ef,{children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsx)(U,{children:(0,a.jsxs)(u.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!s.value&&"text-muted-foreground"),children:[(0,a.jsx)(sK.A,{className:"mr-2 h-4 w-4"}),s.value?(0,eU.GP)(s.value,"PPP",{locale:s_.de}):(0,a.jsx)("span",{children:"W\xe4hle ein Datum"})]})})}),(0,a.jsx)(eg,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(sq,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0})})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),disabled:f,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:f,children:[f&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Hausaufgabe speichern"]})]})]})})]})})}let rm=[{background:"bg-red-50 dark:bg-red-900/30",border:"border-red-200 dark:border-red-700/50",text:"text-red-800 dark:text-red-200"},{background:"bg-green-50 dark:bg-green-900/30",border:"border-green-200 dark:border-green-700/50",text:"text-green-800 dark:text-green-200"},{background:"bg-blue-50 dark:bg-blue-900/30",border:"border-blue-200 dark:border-blue-700/50",text:"text-blue-800 dark:text-blue-200"},{background:"bg-yellow-50 dark:bg-yellow-900/30",border:"border-yellow-200 dark:border-yellow-700/50",text:"text-yellow-800 dark:text-yellow-200"},{background:"bg-purple-50 dark:bg-purple-900/30",border:"border-purple-200 dark:border-purple-700/50",text:"text-purple-800 dark:text-purple-200"},{background:"bg-pink-50 dark:bg-pink-900/30",border:"border-pink-200 dark:border-pink-700/50",text:"text-pink-800 dark:text-pink-200"},{background:"bg-indigo-50 dark:bg-indigo-900/30",border:"border-indigo-200 dark:border-indigo-700/50",text:"text-indigo-800 dark:text-indigo-200"},{background:"bg-teal-50 dark:bg-teal-900/30",border:"border-teal-200 dark:border-teal-700/50",text:"text-teal-800 dark:text-teal-200"},{background:"bg-orange-50 dark:bg-orange-900/30",border:"border-orange-200 dark:border-orange-700/50",text:"text-orange-800 dark:text-orange-200"},{background:"bg-cyan-50 dark:bg-cyan-900/30",border:"border-cyan-200 dark:border-cyan-700/50",text:"text-cyan-800 dark:text-cyan-200"}],rh=e=>{let s=0;for(let t=0;t<e.length;t++)s=(s<<5)-s+e.charCodeAt(t)|0;let t=Math.abs(s%rm.length);return rm[t]},ru=e=>{let{title:s,homework:t,subjectsMap:r,onToggle:n,onDelete:l}=e;return 0===t.length?null:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:s}),(0,a.jsx)("ul",{className:"space-y-2",children:t.map(e=>{let s=r.get(e.subjectId);return(0,a.jsxs)("li",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50 group",children:[(0,a.jsx)(sf,{id:"hw-list-".concat(e.id),checked:e.isDone,onCheckedChange:s=>n(e.id,!!s),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{htmlFor:"hw-list-".concat(e.id),className:(0,g.cn)("font-medium",e.isDone&&"line-through text-muted-foreground"),children:e.task}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-4",children:[(0,a.jsx)("span",{children:(null==s?void 0:s.name)||"Unbekanntes Fach"}),(0,a.jsxs)("span",{children:["F\xe4llig: ",(0,eU.GP)(new Date(e.dueDate),"eeee, dd.MM.",{locale:s_.de})]})]})]}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0 opacity-0 group-hover:opacity-100",onClick:()=>l(e.id),children:(0,a.jsx)(si.A,{className:"h-4 w-4"})})]},e.id)})})]})},rx=e=>{let{homework:s,subjectsMap:t,onToggle:r,onDelete:n}=e,l=s.filter(e=>e.isDone);return 0===l.length?null:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2 mt-6",children:"Erledigte Aufgaben"}),(0,a.jsx)("ul",{className:"space-y-2",children:l.map(e=>{let s=t.get(e.subjectId);return(0,a.jsxs)("li",{className:"flex items-start gap-3 p-3 rounded-lg bg-muted/50 group opacity-70",children:[(0,a.jsx)(sf,{id:"hw-list-".concat(e.id),checked:e.isDone,onCheckedChange:s=>r(e.id,!!s),className:"mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{htmlFor:"hw-list-".concat(e.id),className:(0,g.cn)("font-medium",e.isDone&&"line-through text-muted-foreground"),children:e.task}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground flex items-center gap-4",children:(0,a.jsx)("span",{children:(null==s?void 0:s.name)||"Unbekanntes Fach"})})]}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0 opacity-0 group-hover:opacity-100",onClick:()=>n(e.id),children:(0,a.jsx)(si.A,{className:"h-4 w-4"})})]},e.id)})})]})},rj=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"],rf=e=>{let s=(0,aK.R)(),t={overdue:[],today:[],tomorrow:[],thisWeek:[],later:[]};for(let a of[...e].filter(e=>!e.isDone).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime())){let e=new Date(a.dueDate);(0,re.Y)(e,s)?t.overdue.push(a):(0,rs.c)(e)?t.today.push(a):(0,rt.e)(e)?t.tomorrow.push(a):(0,ra.R)(e,s,{weekStartsOn:1})?t.thisWeek.push(a):t.later.push(a)}return t};function rp(e){let{timetable:s,subjects:t,homework:n,maxPeriods:l,onSaveEntry:i,onDeleteEntry:c,onSaveHomework:d,onDeleteHomework:o,onToggleHomework:m,onAddSubject:h}=e,[x,j]=(0,r.useState)({type:null,data:{}}),f=(0,r.useMemo)(()=>Array.from({length:l},(e,s)=>s+1),[l]),p=(0,r.useMemo)(()=>new Map(t.map(e=>[e.id,e])),[t]),N=(0,r.useMemo)(()=>{let e=new Map;return s.forEach(s=>e.set("".concat(s.day,"-").concat(s.period),s)),e},[s]),b=(0,r.useMemo)(()=>rf(n),[n]),v=(e,s,t)=>{j({type:"edit-entry",data:{day:e,period:s,entryToEdit:t}})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Stundenplan & Hausaufgaben"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Verwalte deine Unterrichtsstunden und Hausaufgaben f\xfcr die Woche."})]}),(0,a.jsxs)(sb.tU,{defaultValue:"timetable",className:"w-full",children:[(0,a.jsxs)(sb.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(sb.Xi,{value:"timetable",children:"Stundenplan"}),(0,a.jsxs)(sb.Xi,{value:"homework",children:["Hausaufgaben (",n.filter(e=>!e.isDone).length,")"]})]}),(0,a.jsx)(sb.av,{value:"timetable",className:"mt-4",children:(0,a.jsx)(sv.Zp,{children:(0,a.jsx)(sv.Wu,{className:"p-2 overflow-x-auto bg-card",children:(0,a.jsxs)("div",{className:"grid grid-cols-[auto_repeat(5,minmax(140px,1fr))] gap-1 min-w-[800px]",children:[(0,a.jsx)("div",{}),rj.map(e=>(0,a.jsx)("div",{className:"text-center font-semibold p-2 text-sm",children:e},e)),f.map(e=>(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-center font-semibold p-2 text-sm",children:[e,"."]}),rj.map((s,t)=>{let r=N.get("".concat(t,"-").concat(e)),n=r?p.get(r.subjectId):null,l=r&&n?rh(n.id):null;return(0,a.jsx)("div",{className:(0,g.cn)("border rounded-md min-h-[100px] flex flex-col group/cell",l?"".concat(l.background," ").concat(l.border):"bg-muted/20"),children:r&&n?(0,a.jsxs)("div",{className:"flex-1 cursor-pointer -m-2 p-2 rounded-md flex flex-col",onClick:()=>v(t,e,r),children:[(0,a.jsx)("p",{className:(0,g.cn)("font-bold text-sm flex-1",null==l?void 0:l.text),children:n.name}),r.room&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-auto pt-1",children:r.room})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:()=>v(t,e),className:"opacity-0 group-hover/cell:opacity-100 transition-opacity",children:(0,a.jsx)(en.A,{className:"h-5 w-5 text-muted-foreground"})})})},"".concat(t,"-").concat(e))})]},e))]})})})}),(0,a.jsx)(sb.av,{value:"homework",className:"mt-4",children:(0,a.jsxs)(sv.Zp,{children:[(0,a.jsx)(sv.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sv.ZB,{children:"Hausaufgaben\xfcbersicht"}),(0,a.jsx)(sv.BT,{children:"Alle deine anstehenden und erledigten Aufgaben."})]}),(0,a.jsxs)(u.$,{onClick:()=>j({type:"add-homework",data:{}}),children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"Neue Hausaufgabe"]})]})}),(0,a.jsx)(sv.Wu,{className:"space-y-6",children:Object.values(b).every(e=>0===e.length)&&0===n.filter(e=>e.isDone).length?(0,a.jsx)("p",{className:"text-center text-muted-foreground py-10",children:"Keine Hausaufgaben vorhanden."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ru,{title:"\xdcberf\xe4llig",homework:b.overdue,subjectsMap:p,onToggle:m,onDelete:o}),(0,a.jsx)(ru,{title:"Heute f\xe4llig",homework:b.today,subjectsMap:p,onToggle:m,onDelete:o}),(0,a.jsx)(ru,{title:"Morgen f\xe4llig",homework:b.tomorrow,subjectsMap:p,onToggle:m,onDelete:o}),(0,a.jsx)(ru,{title:"Diese Woche f\xe4llig",homework:b.thisWeek,subjectsMap:p,onToggle:m,onDelete:o}),(0,a.jsx)(ru,{title:"Sp\xe4ter f\xe4llig",homework:b.later,subjectsMap:p,onToggle:m,onDelete:o}),(0,a.jsx)(rx,{homework:n,subjectsMap:p,onToggle:m,onDelete:o})]})})]})})]}),"edit-entry"===x.type&&(0,a.jsx)(ri,{isOpen:!0,onOpenChange:e=>!e&&j({type:null,data:{}}),onSubmit:e=>{var s;return i(x.data.day,x.data.period,e,null==(s=x.data.entryToEdit)?void 0:s.id)},onDelete:()=>c(x.data.entryToEdit.id),onAddSubject:h,entryToEdit:x.data.entryToEdit,subjects:t}),"add-homework"===x.type&&(0,a.jsx)(ro,{isOpen:!0,onOpenChange:e=>!e&&j({type:null,data:{}}),onSubmit:d,subjects:t,timetable:s})]})}let rg=["Pr\xfcfung","Hausaufgabe","Ferien","Veranstaltung","Sonstiges"],rN=M.Ik({title:M.Yj().min(2,"Titel muss mindestens 2 Zeichen lang sein.").max(50),date:M.p6().optional(),dateRange:M.Ie().optional(),type:M.k5(rg,{required_error:"Du musst einen Ereignistyp ausw\xe4hlen."}),target:M.k5(["school","gradeLevel"],{required_error:"Bitte w\xe4hle eine Zielgruppe aus."}),description:M.Yj().max(200,"Beschreibung darf nicht l\xe4nger als 200 Zeichen sein.").optional()}).refine(e=>{if("Ferien"===e.type){var s;return!!(null==(s=e.dateRange)?void 0:s.from)}return!!e.date},{message:"Ein Datum ist erforderlich.",path:["date"]});function rb(e){let{isOpen:s,onOpenChange:t,onSubmit:n,eventToEdit:l,selectedDate:i}=e,c=(0,T.mN)({resolver:(0,O.u)(rN)}),d=c.watch("type");(0,r.useEffect)(()=>{s&&(l?c.reset({title:l.title,description:l.description||"",type:l.type,target:l.target,..."Ferien"===l.type?{dateRange:{from:new Date(l.date),to:l.endDate?new Date(l.endDate):void 0}}:{date:new Date(l.date)}}):c.reset({title:"",description:"",type:"Pr\xfcfung",date:i||new Date,dateRange:{from:i||new Date,to:(0,aJ.f)(i||new Date,7)},target:"school"}))},[s,l,i,c]);let{isSubmitting:o}=c.formState,m=async e=>{var s;let a={title:e.title,description:e.description,type:e.type,target:e.target,date:("Ferien"===e.type?e.dateRange.from:e.date).toISOString(),endDate:"Ferien"===e.type?(null==(s=e.dateRange.to)?void 0:s.toISOString())||e.dateRange.from.toISOString():void 0};await n(a,null==l?void 0:l.id),t(!1)},h=l?"Schulereignis bearbeiten":"Neues Schulereignis erstellen";return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:h}),(0,a.jsx)(Z.rr,{children:"F\xfcge einen neuen Termin f\xfcr deine Schule hinzu. W\xe4hle aus, wer ihn sehen kann."})]}),(0,a.jsx)(W,{...c,children:(0,a.jsxs)("form",{onSubmit:c.handleSubmit(m),className:"space-y-4 pt-4",children:[(0,a.jsx)(G,{control:c.control,name:"title",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Titel"}),(0,a.jsx)(U,{children:(0,a.jsx)(Y.p,{placeholder:"z.B. Mathematik-Schulaufgabe",...s})}),(0,a.jsx)(q,{})]})}}),"Ferien"===d?(0,a.jsx)(G,{control:c.control,name:"dateRange",render:e=>{var s;let{field:t}=e;return(0,a.jsxs)(J,{className:"flex flex-col",children:[(0,a.jsx)(V,{children:"Zeitraum"}),(0,a.jsxs)(ef,{children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsx)(U,{children:(0,a.jsxs)(u.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!t.value&&"text-muted-foreground"),children:[(0,a.jsx)(sK.A,{className:"mr-2 h-4 w-4"}),(null==(s=t.value)?void 0:s.from)?t.value.to?(0,a.jsxs)(a.Fragment,{children:[(0,eU.GP)(t.value.from,"LLL dd, y")," -"," ",(0,eU.GP)(t.value.to,"LLL dd, y")]}):(0,eU.GP)(t.value.from,"LLL dd, y"):(0,a.jsx)("span",{children:"W\xe4hle einen Zeitraum"})]})})}),(0,a.jsx)(eg,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(sq,{mode:"range",selected:t.value,onSelect:t.onChange,initialFocus:!0,locale:s_.de})})]}),(0,a.jsx)(q,{})]})}}):(0,a.jsx)(G,{control:c.control,name:"date",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"flex flex-col",children:[(0,a.jsx)(V,{children:"Datum"}),(0,a.jsxs)(ef,{children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsx)(U,{children:(0,a.jsxs)(u.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!s.value&&"text-muted-foreground"),children:[(0,a.jsx)(sK.A,{className:"mr-2 h-4 w-4"}),s.value?(0,eU.GP)(s.value,"PPP",{locale:s_.de}):(0,a.jsx)("span",{children:"W\xe4hle ein Datum"})]})})}),(0,a.jsx)(eg,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(sq,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0,locale:s_.de})})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"type",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Typ"}),(0,a.jsxs)(N,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(U,{children:(0,a.jsx)(v,{children:(0,a.jsx)(b,{placeholder:"W\xe4hle einen Typ..."})})}),(0,a.jsx)(k,{children:rg.map(e=>(0,a.jsx)(S,{value:e,children:e},e))})]}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"target",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{className:"space-y-3",children:[(0,a.jsx)(V,{children:"Sichtbar f\xfcr"}),(0,a.jsx)(U,{children:(0,a.jsxs)(Q.z,{onValueChange:s.onChange,defaultValue:s.value,className:"flex space-x-4",children:[(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"school"})}),(0,a.jsx)(V,{className:"font-normal",children:"Ganze Schule"})]}),(0,a.jsxs)(J,{className:"flex items-center space-x-2 space-y-0",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Q.C,{value:"gradeLevel"})}),(0,a.jsx)(V,{className:"font-normal",children:"Nur meine Jahrgangsstufe"})]})]})}),(0,a.jsx)(q,{})]})}}),(0,a.jsx)(G,{control:c.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(J,{children:[(0,a.jsx)(V,{children:"Beschreibung (optional)"}),(0,a.jsx)(U,{children:(0,a.jsx)(sG,{placeholder:"z.B. Themen: Kapitel 1-5",className:"resize-none",...s})}),(0,a.jsx)(q,{})]})}}),(0,a.jsxs)(Z.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"ghost",onClick:()=>t(!1),disabled:o,children:"Abbrechen"}),(0,a.jsxs)(u.$,{type:"submit",disabled:o,children:[o&&(0,a.jsx)(sl.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Ereignis speichern"]})]})]})})]})})}let rv={performance:"Leistungs\xfcbersicht",actions:"Schnellzugriff",upcoming:"Anstehende Pr\xfcfungen",homework:"Hausaufgaben",calendar:"Schulkalender",tutor:"KI-Tutor & Coach"};function rw(e){let{isOpen:s,onOpenChange:t,widgets:r,onWidgetChange:n}=e,l=(e,s)=>{n({...r,[e]:s})};return(0,a.jsx)(Z.lG,{open:s,onOpenChange:t,children:(0,a.jsxs)(Z.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(Z.c7,{children:[(0,a.jsx)(Z.L3,{children:"Dashboard personalisieren"}),(0,a.jsx)(Z.rr,{children:"W\xe4hle aus, welche Widgets auf deinem Dashboard angezeigt werden sollen."})]}),(0,a.jsx)(st.F,{className:"max-h-[50vh] pr-4 -mr-4",children:(0,a.jsx)("div",{className:"space-y-4 pr-4",children:Object.entries(rv).map(e=>{var s;let[t,n]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[(0,a.jsx)(H.J,{htmlFor:"widget-".concat(t),className:"font-medium",children:n}),(0,a.jsx)(t7,{id:"widget-".concat(t),checked:null!=(s=r[t])&&s,onCheckedChange:e=>l(t,e)})]},t)})})}),(0,a.jsx)(Z.Es,{children:(0,a.jsx)(u.$,{onClick:()=>t(!1),children:"Schlie\xdfen"})})]})})}let ry=()=>(0,a.jsxs)("div",{className:"space-y-6 animate-pulse",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(sS.E,{className:"h-8 w-1/2 mb-2"}),(0,a.jsx)(sS.E,{className:"h-4 w-3/4"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[(0,a.jsx)(sS.E,{className:"h-64 rounded-lg xl:col-span-2"}),(0,a.jsx)(sS.E,{className:"h-64 rounded-lg"}),(0,a.jsx)(sS.E,{className:"h-64 rounded-lg"}),(0,a.jsx)(sS.E,{className:"h-64 rounded-lg"}),(0,a.jsx)(sS.E,{className:"h-64 rounded-lg"})]})]}),rk={performance:!0,actions:!0,upcoming:!0,homework:!0,calendar:!0,tutor:!0};function rS(){var e;let{user:s,isFirebaseEnabled:t}=(0,l.A)(),d=(0,n.useRouter)(),[o,m]=(0,r.useState)([]),[h,u]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[f,p]=(0,r.useState)([]),[N,b]=(0,r.useState)([]),[v,w]=(0,r.useState)([]),[y,k]=(0,r.useState)(null),[S,A]=(0,r.useState)([]),[C,D]=(0,r.useState)([]),[F,E]=(0,r.useState)(10),[z,L]=(0,r.useState)(2),[B,R]=(0,r.useState)(1),[O,T]=(0,r.useState)(10),[M,Z]=(0,r.useState)("blue"),[$,H]=(0,r.useState)(!1),[W,P]=(0,r.useState)("student"),[G,_]=(0,r.useState)(""),[K,J]=(0,r.useState)(null),[V,U]=(0,r.useState)(a8),[q,Y]=(0,r.useState)(rk),[Q,X]=(0,r.useState)(!1),[es,et]=(0,r.useState)(!1),[ea,er]=(0,r.useState)(!1),[en,el]=(0,r.useState)(!1),[ei,ec]=(0,r.useState)("dashboard"),[ed,eo]=(0,r.useState)(null),[em,eh]=(0,r.useState)(null),[eu,ex]=(0,r.useState)(null),[ej,ef]=(0,r.useState)(!1),[ep,eg]=(0,r.useState)({isOpen:!1,subjectId:null}),[eN,eb]=(0,r.useState)({isOpen:!1,subject:null}),[ev,ew]=(0,r.useState)({isOpen:!1,grade:null,subject:null}),[ey,ek]=(0,r.useState)({isOpen:!1}),[eS,eA]=(0,r.useState)(!0),{toast:eC}=(0,e4.dj)(),eD=(0,r.useCallback)((0,a9.A)((e,a)=>{if(!s||!t)return;let r=(0,i.H9)(c.db,"users",s.uid,"settings","main");try{let s=JSON.parse(JSON.stringify({[e]:a}));(0,i.BN)(r,s,{merge:!0})}catch(e){console.error("Error updating setting: ",e),eC({title:"Fehler beim Speichern der Einstellung",variant:"destructive"})}},1e3),[s,t,eC]);(0,r.useEffect)(()=>{if(!t||!s){eA(!1),m([]),u([]),j([]),p([]),b([]),w([]),k(null),J(null),D([]);return}let e=[],a=(0,i.H9)(c.db,"users",s.uid,"settings","main"),r=(0,i.aQ)(a,e=>{if(e.exists()){let s=e.data();E(s.selectedGradeLevel||10),L(s.mainSubjectWeight||2),R(s.minorSubjectWeight||1),T(s.maxPeriods||10),Z(s.theme||"blue"),H(s.isDarkMode||!1),P(s.role||"student"),_(s.schoolId||""),Y({...rk,...s.dashboardWidgets||{}});let t=s.dashboardLayouts;if(t&&Object.keys(t).length>0){let e={};for(let s in a8)Object.prototype.hasOwnProperty.call(a8,s)&&(e[s]=a8[s].map(e=>{var a;return(null==(a=t[s])?void 0:a.find(s=>s.i===e.i))||e}));U(e)}else U(a8)}else(0,i.BN)(a,{selectedGradeLevel:10,mainSubjectWeight:2,minorSubjectWeight:1,maxPeriods:10,theme:"blue",isDarkMode:!1,role:"student",schoolId:"",dashboardLayouts:a8,dashboardWidgets:rk})});e.push(r);let n=(0,i.H9)(c.db,"profiles",s.uid),l=(0,i.aQ)(n,e=>{if(e.exists()){let s=e.data();k(s),J(s.name)}else{let e={uid:s.uid,name:s.displayName||"Neuer Nutzer",email:s.email,bio:"Hallo! Ich benutze Notio, um meinen Schulerfolg zu organisieren.",followers:[],following:[]};(0,i.BN)(n,e)}});e.push(l);let d=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"files"),(0,i.My)("createdAt","desc")),o=(0,i.aQ)(d,e=>{p(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching files:",e)});e.push(o);let h=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"timetable")),x=(0,i.aQ)(h,e=>{b(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching timetable:",e)});e.push(x);let f=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"homework"),(0,i.My)("createdAt","desc")),g=(0,i.aQ)(f,e=>{w(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching homework:",e)});return e.push(g),(async()=>{let e=(0,i.P)((0,i.rJ)(c.db,"schools"));A((await (0,i.GG)(e)).docs.map(e=>({id:e.id,...e.data()})).sort((e,s)=>e.name.localeCompare(s.name)))})(),()=>{e.forEach(e=>e())}},[t,s]),(0,r.useEffect)(()=>{if(!t||!s||!G)return void D([]);let e=(0,i.P)((0,i.rJ)(c.db,"schools",G,"events"),(0,i.My)("date","desc")),a=(0,i.aQ)(e,e=>{D(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching school events:",e),eC({title:"Fehler beim Laden der Schul-Termine",variant:"destructive"})});return()=>a()},[t,s,G,eC]),(0,r.useEffect)(()=>{if(!t||!s)return;eA(!0);let e=[],a=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"subjects"),(0,i._M)("gradeLevel","==",F)),r=(0,i.aQ)(a,e=>{m(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching subjects:",e),eC({title:"Fehler beim Laden der F\xe4cher",variant:"destructive"})});e.push(r);let n=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"studySets"),(0,i._M)("gradeLevel","==",F)),l=(0,i.aQ)(n,e=>{j(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching study sets:",e)});return e.push(l),()=>{e.forEach(e=>e()),m([]),j([])}},[t,s,F,eC]),(0,r.useEffect)(()=>{if(!t||!s)return;if(0===o.length){u([]),eA(!1);return}let e=o.map(e=>e.id),a=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"grades"),(0,i._M)("subjectId","in",e)),r=(0,i.aQ)(a,e=>{u(e.docs.map(e=>({id:e.id,...e.data()}))),eA(!1)},e=>{console.error("Error fetching grades:",e),eC({title:"Fehler beim Laden der Noten",variant:"destructive"}),eA(!1)});return()=>{r(),u([])}},[t,s,o,eC]),(0,r.useEffect)(()=>{let e=window.document.documentElement;e.classList.remove("theme-zinc","theme-rose","theme-green","theme-violet","theme-orange","theme-yellow","theme-slate"),"blue"!==M&&e.classList.add("theme-".concat(M))},[M]),(0,r.useEffect)(()=>{let e=window.document.documentElement;$?e.classList.add("dark"):e.classList.remove("dark")},[$]);let eF=(0,r.useMemo)(()=>h.filter(e=>null==e.value).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),[h]),eE=(0,r.useMemo)(()=>o.filter(e=>"Hauptfach"===e.category).sort((e,s)=>e.name.localeCompare(s.name)),[o]),ez=(0,r.useMemo)(()=>o.filter(e=>"Nebenfach"===e.category).sort((e,s)=>e.name.localeCompare(s.name)),[o]),eL=(0,r.useMemo)(()=>(0,g.j)(o,h,z,B),[o,h,z,B]),eB=(0,r.useMemo)(()=>(0,g.y7)(eE,h),[eE,h]),eR=(0,r.useMemo)(()=>(0,g.y7)(ez,h),[ez,h]),eI=(0,r.useMemo)(()=>o.length,[o]),eO=(0,r.useMemo)(()=>h.filter(e=>null!=e.value).length,[h]),eT=(0,r.useMemo)(()=>tv.map(e=>{let s=e.check(o,h,eL);return{id:e.id,name:e.name,description:e.description,secretDescription:e.secretDescription,icon:e.icon,tier:e.tier,isRepeatable:e.isRepeatable,unlocked:s.unlocked,progress:s.progress}}),[o,h,eL]),eM=async e=>{let a={gradeLevel:F,name:e.name,category:e.category,targetGrade:e.targetGrade||null,writtenWeight:"Hauptfach"===e.category?2:null,oralWeight:"Hauptfach"===e.category?1:null};if(!t||!s){let e="local-".concat(Date.now()),s={id:e,...a};return m(e=>[...e,s]),eC({title:"Fach hinzugef\xfcgt (Demo)",description:"Im Demo-Modus werden Daten nicht gespeichert."}),e}try{let t=JSON.parse(JSON.stringify(a)),r=await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"subjects"),t);return eC({title:"Fach hinzugef\xfcgt",description:'Das Fach "'.concat(e.name,'" wurde erfolgreich erstellt.')}),r.id}catch(e){throw console.error("Error adding subject: ",e),eC({title:"Fehler beim Hinzuf\xfcgen des Fachs",variant:"destructive"}),e}},eZ=async(e,a)=>{if(!t||!s){m(s=>s.map(s=>s.id===e?{...s,...a}:s)),eC({title:"Fach aktualisiert (Demo)"}),eb({isOpen:!1,subject:null});return}let r=(0,i.H9)(c.db,"users",s.uid,"subjects",e);try{let e=JSON.parse(JSON.stringify(a));await (0,i.BN)(r,e,{merge:!0}),eC({title:"Fach aktualisiert",description:"Die Einstellungen f\xfcr das Fach wurden gespeichert."}),eb({isOpen:!1,subject:null})}catch(e){console.error("Error updating subject: ",e),eC({title:"Fehler beim Aktualisieren des Fachs",variant:"destructive"})}},e$=async e=>{var a;let r=(null==(a=o.find(s=>s.id===e))?void 0:a.name)||"Das Fach";if(!t||!s){m(s=>s.filter(s=>s.id!==e)),u(s=>s.filter(s=>s.subjectId!==e)),eC({title:"Fach gel\xf6scht (Demo)",variant:"destructive"});return}try{let t=(0,i.wP)(c.db),a=(0,i.H9)(c.db,"users",s.uid,"subjects",e);t.delete(a);let n=(0,i.P)((0,i.rJ)(c.db,"users",s.uid,"grades"),(0,i._M)("subjectId","==",e));(await (0,i.GG)(n)).forEach(e=>{t.delete(e.ref)}),await t.commit(),eC({title:"Fach gel\xf6scht",description:"".concat(r," und alle zugeh\xf6rigen Noten wurden gel\xf6scht."),variant:"destructive"})}catch(e){console.error("Error deleting subject and grades: ",e),eC({title:"Fehler beim L\xf6schen des Fachs",variant:"destructive"})}},eH=async(e,a,r)=>{var n;let l={subjectId:e,...a,value:null!=(n=a.value)?n:null,date:a.date.toISOString()};if(!t||!s){if(r)u(e=>e.map(e=>e.id===r?{...e,id:e.id,...l}:e)),eC({title:"Note aktualisiert (Demo)"});else{let e={id:"local-".concat(Date.now()),...l};u(s=>[...s,e]),eC({title:"Note hinzugef\xfcgt (Demo)"})}return}try{let e=JSON.parse(JSON.stringify(l));if(r){let t=(0,i.H9)(c.db,"users",s.uid,"grades",r);await (0,i.BN)(t,e,{merge:!0}),eC({title:"Note aktualisiert",description:"Die \xc4nderungen an der Note wurden gespeichert."})}else await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"grades"),e),eC({title:"Note hinzugef\xfcgt",description:"Eine neue Note wurde erfolgreich gespeichert."})}catch(e){console.error("Error saving grade: ",e),eC({title:"Fehler beim Speichern der Note",variant:"destructive"})}},eW=async e=>{if(!t||!s){u(s=>s.filter(s=>s.id!==e)),eC({title:"Note gel\xf6scht (Demo)",variant:"destructive"});return}try{await (0,i.kd)((0,i.H9)(c.db,"users",s.uid,"grades",e)),eC({title:"Note gel\xf6scht",description:"Die ausgew\xe4hlte Note wurde entfernt.",variant:"destructive"})}catch(e){console.error("Error deleting grade: ",e),eC({title:"Fehler beim L\xf6schen der Note",variant:"destructive"})}},eP=async(e,a)=>{if(!s||!t)return void eC({title:"Funktion nicht verf\xfcgbar",description:"Lernsets sind im Demo-Modus nicht verf\xfcgbar.",variant:"destructive"});let r=JSON.parse(JSON.stringify({...e,gradeLevel:F}));try{if(a){let e=(0,i.H9)(c.db,"users",s.uid,"studySets",a);await (0,i.BN)(e,r,{merge:!0}),eC({title:"Lernset aktualisiert"})}else await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"studySets"),r),eC({title:"Lernset erstellt"})}catch(e){console.error("Error saving study set:",e),eC({title:"Fehler beim Speichern des Lernsets",variant:"destructive"})}ec("studysets")},eG=async e=>{if(s&&t)try{await (0,i.kd)((0,i.H9)(c.db,"users",s.uid,"studySets",e)),eC({title:"Lernset gel\xf6scht",variant:"destructive"})}catch(e){console.error("Error deleting study set:",e),eC({title:"Fehler beim L\xf6schen des Lernsets",variant:"destructive"})}},e_=async(e,t)=>{if(s&&e.trim())try{await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"files"),{name:e.trim(),parentId:t,type:"folder",createdAt:(0,i.O5)()}),eC({title:"Ordner erstellt"})}catch(e){console.error("Error creating folder:",e),eC({title:"Fehler beim Erstellen des Ordners",variant:"destructive"})}},eK=async(e,t)=>{if(!s||0===e.length)return;let a=Array.from(e).map(e=>new Promise((a,r)=>{let n=new FileReader;n.onload=async n=>{try{var l;await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"files"),{name:e.name,parentId:t,type:"file",dataUrl:null==(l=n.target)?void 0:l.result,size:e.size,fileType:e.type,createdAt:(0,i.O5)()}),a()}catch(e){r(e)}},n.onerror=r,n.readAsDataURL(e)}));try{await Promise.all(a),eC({title:"".concat(e.length," Datei(en) erfolgreich hochgeladen.")})}catch(e){console.error("Error uploading files:",e),eC({title:"Fehler beim Hochladen der Dateien",variant:"destructive"})}},eJ=(e,s)=>{let t=s.filter(s=>s.parentId===e),a=t.map(e=>e.id);return t.forEach(e=>{"folder"===e.type&&(a=[...a,...eJ(e.id,s)])}),a},eV=async e=>{if(!s)return;let t=f.find(s=>s.id===e);if(!t)return;let a=(0,i.wP)(c.db),r=(0,i.H9)(c.db,"users",s.uid,"files",e);a.delete(r),"folder"===t.type&&eJ(e,f).forEach(e=>{let t=(0,i.H9)(c.db,"users",s.uid,"files",e);a.delete(t)});try{await a.commit(),eC({title:"Erfolgreich gel\xf6scht",variant:"destructive"})}catch(e){console.error("Error deleting item:",e),eC({title:"Fehler beim L\xf6schen",variant:"destructive"})}},eU=async(e,t,a,r)=>{if(!s)return;let n=JSON.parse(JSON.stringify({day:e,period:t,...a}));try{r?await (0,i.BN)((0,i.H9)(c.db,"users",s.uid,"timetable",r),n,{merge:!0}):await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"timetable"),n),eC({title:"Stundenplan gespeichert"})}catch(e){console.error("Error saving timetable entry:",e),eC({title:"Fehler beim Speichern der Stunde",variant:"destructive"})}},eq=async e=>{if(s)try{await (0,i.kd)((0,i.H9)(c.db,"users",s.uid,"timetable",e)),eC({title:"Stunde gel\xf6scht",variant:"destructive"})}catch(e){console.error("Error deleting timetable entry:",e),eC({title:"Fehler beim L\xf6schen der Stunde",variant:"destructive"})}},eY=async e=>{if(!s)return;let t=JSON.parse(JSON.stringify({...e,dueDate:e.dueDate.toISOString(),isDone:!1,createdAt:(0,i.O5)()}));try{await (0,i.gS)((0,i.rJ)(c.db,"users",s.uid,"homework"),t),eC({title:"Hausaufgabe gespeichert"})}catch(e){console.error("Error saving homework:",e),eC({title:"Fehler beim Speichern der Hausaufgabe",variant:"destructive"})}},eQ=async e=>{if(s)try{await (0,i.kd)((0,i.H9)(c.db,"users",s.uid,"homework",e)),eC({title:"Hausaufgabe gel\xf6scht",variant:"destructive"})}catch(e){console.error("Error deleting homework:",e),eC({title:"Fehler beim L\xf6schen der Hausaufgabe",variant:"destructive"})}},eX=async(e,t)=>{if(s)try{await (0,i.BN)((0,i.H9)(c.db,"users",s.uid,"homework",e),{isDone:t},{merge:!0})}catch(e){console.error("Error toggling homework:",e),eC({title:"Fehler beim Aktualisieren der Hausaufgabe",variant:"destructive"})}},e0=async(e,t)=>{if(!s||!G)return void eC({title:"Aktion nicht m\xf6glich",description:"Du musst einer Schule zugeordnet sein.",variant:"destructive"});if(t){let a=(0,i.H9)(c.db,"schools",G,"events",t),r=C.find(e=>e.id===t);if((null==r?void 0:r.authorId)!==s.uid)return void eC({title:"Keine Berechtigung",description:"Du kannst nur deine eigenen Termine bearbeiten.",variant:"destructive"});await (0,i.mZ)(a,JSON.parse(JSON.stringify(e))),eC({title:"Ereignis aktualisiert"})}else{let t={...e,schoolId:G,authorId:s.uid,authorName:s.displayName||"Anonym",createdAt:(0,i.O5)(),..."gradeLevel"===e.target&&{gradeLevel:F}};try{let e=JSON.parse(JSON.stringify(t));await (0,i.gS)((0,i.rJ)(c.db,"schools",G,"events"),e),eC({title:"Ereignis erstellt",description:"Das Ereignis wurde dem Schulkalender hinzugef\xfcgt."})}catch(e){console.error("Error adding school event:",e),eC({title:"Fehler",description:"Das Ereignis konnte nicht erstellt werden.",variant:"destructive"})}}},e2=async e=>{if(!s||!G)return;let t=(0,i.H9)(c.db,"schools",G,"events",e),a=C.find(s=>s.id===e);if((null==a?void 0:a.authorId)!==s.uid)return void eC({title:"Keine Berechtigung",description:"Du kannst nur deine eigenen Termine l\xf6schen.",variant:"destructive"});try{await (0,i.kd)(t),eC({title:"Ereignis gel\xf6scht",variant:"destructive"})}catch(e){console.error("Error deleting school event:",e),eC({title:"Fehler",description:"Das Ereignis konnte nicht gel\xf6scht werden.",variant:"destructive"})}},e5=e=>{eg({isOpen:!0,subjectId:e,gradeToEdit:null})},e3=e=>{eg({isOpen:!0,subjectId:e.subjectId,gradeToEdit:e})},e6=()=>{eg({isOpen:!1,subjectId:null,gradeToEdit:null})},e8=e=>{eb({isOpen:!0,subject:e})},e7=e=>{let s=o.find(s=>s.id===e.subjectId);s&&ew({isOpen:!0,grade:e,subject:s})},e9=()=>{ew({isOpen:!1,grade:null,subject:null})},se=()=>{if(0===o.length)return void eC({title:"Keine Daten zum Exportieren",description:"F\xfcr die ausgew\xe4hlte Klassenstufe gibt es keine F\xe4cher.",variant:"destructive"});let e=(0,g.eZ)(o,h),s=new Blob(["\uFEFF".concat(e)],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),a=URL.createObjectURL(s);t.setAttribute("href",a),t.setAttribute("download","gradido-export-".concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a),eC({title:"Daten exportiert",description:"Deine Noten wurden erfolgreich als CSV-Datei heruntergeladen."})},ss=async()=>{if(!s||!t)return void eC({title:"Funktion nicht verf\xfcgbar",description:"Der Datenimport ist im Demo-Modus nicht m\xf6glich.",variant:"destructive"});let e=document.createElement("input");e.type="file",e.accept=".csv",e.onchange=e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){let e=new FileReader;e.onload=async e=>{var t;let a=null==(t=e.target)?void 0:t.result;try{let{newSubjects:e,newGrades:t,importedCount:r,skippedCount:n}=await (0,g.cd)(a,o,h,F,s.uid);r>0&&(m(e),u(t)),eC({title:"Import abgeschlossen",description:"".concat(r," Eintr\xe4ge wurden importiert, ").concat(n," Duplikate oder fehlerhafte Zeilen \xfcbersprungen.")})}catch(e){eC({title:"Import fehlgeschlagen",description:e.message,variant:"destructive"})}},e.readAsText(a)}},e.click()},st=async()=>{if(!t)return void d.push("/");try{await c.j2.signOut(),d.push("/")}catch(e){eC({title:"Fehler beim Abmelden",variant:"destructive"})}},sn=e=>{"user-profile"!==e&&eo(null),"studyset-detail"!==e&&"studyset-create"!==e&&"studyset-edit"!==e&&(eh(null),ex(null)),ec(e)},sl=e=>{eo(e),ec("user-profile")},si=e=>{eh(e),ec("studyset-detail")},sc=()=>{ex(null),ec("studyset-create")},sd=e=>{ex(e),ec("studyset-edit")},so=async e=>{var t;if(!s||!y||s.uid===e)return;let a=(0,i.H9)(c.db,"profiles",s.uid),r=(0,i.H9)(c.db,"profiles",e),n=null==(t=y.following)?void 0:t.includes(e),l=(0,i.wP)(c.db);l.update(a,{following:n?(0,i.C3)(e):(0,i.hq)(e)}),l.update(r,{followers:n?(0,i.C3)(s.uid):(0,i.hq)(s.uid)});try{await l.commit(),eC({title:n?"Nicht mehr gefolgt":"Gefolgt!",description:"Du folgst diesem Nutzer ".concat(n?"nicht mehr":"jetzt",".")})}catch(e){console.error("Error toggling follow:",e),eC({variant:"destructive",title:"Fehler",description:"Aktion konnte nicht ausgef\xfchrt werden."})}},sm=async(e,s)=>{let t=await (0,i.gS)((0,i.rJ)(c.db,"schools"),{name:e,address:s}),a={id:t.id,name:e,address:s};return A(e=>[...e,a].sort((e,s)=>e.name.localeCompare(s.name))),t.id},sh=(e,s)=>{U(s),eD("dashboardLayouts",s)},su={currentView:ei,onSetView:sn,userName:K};return(0,a.jsxs)("div",{className:"flex min-h-screen bg-muted/40",children:[(0,a.jsx)(sr,{...su}),(0,a.jsx)(sz,{open:ea,onOpenChange:er,children:(0,a.jsxs)(sI,{side:"left",className:"p-0 lg:hidden w-80",children:[(0,a.jsxs)(sO,{children:[(0,a.jsx)(sT,{className:"sr-only",children:"Hauptnavigation"}),(0,a.jsx)(sM,{className:"sr-only",children:"Navigiere durch die Hauptbereiche der Anwendung."})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4 h-full p-6",children:(0,a.jsx)(sa,{...su,onClose:()=>er(!1)})})]})}),(0,a.jsxs)("div",{className:"flex-1 lg:pl-80",children:[(0,a.jsx)(I,{selectedGradeLevel:F,onGradeLevelChange:e=>{eD("selectedGradeLevel",e)},onOpenMobileSidebar:()=>er(!0),onLogout:st,onNavigate:sn}),(0,a.jsx)("main",{className:"p-4 md:p-6 lg:p-8",children:(()=>{if(eS&&!["community","user-profile","school-calendar"].includes(ei))return(0,a.jsx)(ry,{});switch(ei){case"dashboard":return(0,a.jsx)(a7,{userName:K,overallAverage:eL,mainSubjectsAverage:eB,minorSubjectsAverage:eR,totalSubjectsCount:eI,totalGradesCount:eO,plannedGrades:eF,homework:v,schoolEvents:C,subjects:o,onNavigate:sn,onAddSubject:()=>X(!0),onAddGrade:e5,onAddHomework:()=>et(!0),layouts:V,onLayoutChange:sh,visibleWidgets:q,onOpenSettings:()=>el(!0)});case"subjects":return(0,a.jsx)(e1,{mainSubjects:eE,minorSubjects:ez,grades:h,onDeleteSubject:e$,onUpdateSubject:eZ,onAddSubject:()=>X(!0),totalSubjectsCount:o.length,onOpenCommandPalette:()=>ef(!0),onAddGradeToSubject:e5,onEditSubject:e8,onShowGradeInfo:e7,onEditGrade:e3,studySets:x,onViewStudySet:si,onEditStudySet:sd,onDeleteStudySet:eG});case"timetable":return(0,a.jsx)(rp,{timetable:N,subjects:o,homework:v,maxPeriods:O,onSaveEntry:eU,onDeleteEntry:eq,onSaveHomework:eY,onDeleteHomework:eQ,onToggleHomework:eX,onAddSubject:eM});case"school-calendar":let e=S.find(e=>e.id===G);return(0,a.jsx)(a2,{schoolId:G,schoolName:(null==e?void 0:e.name)||null,events:C,selectedGradeLevel:F,onAddEvent:e=>ek({isOpen:!0,selectedDate:e}),onEditEvent:e=>ek({isOpen:!0,eventToEdit:e}),onDeleteEvent:e2});case"studysets":return(0,a.jsx)(an,{studySets:x,subjects:o,onViewStudySet:si,onEditStudySet:sd,onDeleteStudySet:eG,onAddNew:sc});case"studyset-create":return(0,a.jsx)(aH,{subjects:o,onBack:()=>ec("studysets"),onSave:eP});case"studyset-edit":return(0,a.jsx)(aH,{studySetToEdit:eu,subjects:o,onBack:()=>ec("studysets"),onSave:eP});case"studyset-detail":let r=x.find(e=>e.id===em);if(r)return(0,a.jsx)(aT,{studySet:r,onBack:()=>ec("studysets"),onEditSet:sd});return null;case"tutor":return(0,a.jsx)(sF,{subjects:o,allGrades:h,studySets:x});case"calculator":return(0,a.jsx)(sP,{subjects:o,allGrades:h});case"data":return(0,a.jsx)(s5,{onImport:ss,onExport:se,isFirebaseEnabled:t&&!!s});case"files":return(0,a.jsx)(ts,{files:f,subjects:o,grades:h,onCreateFolder:e_,onUploadFiles:eK,onDeleteItem:eV});case"awards":return(0,a.jsx)(tj,{awards:eT,selectedGradeLevel:F});case"profile":return(0,a.jsx)(tG,{profile:y,onUserNameChange:e=>{J(e),eD("name",e)},onToggleFollow:onToggleFollow,userRole:W,onUserRoleChange:e=>{P(e),eD("role",e)},userSchoolId:G,onUserSchoolIdChange:e=>{_(e),eD("schoolId",e)},allSchools:S,onAddSchool:sm});case"community":return(0,a.jsx)(t2,{currentUserProfile:y,onViewProfile:sl,onToggleFollow:so,subjects:o,grades:h});case"user-profile":if(ed)return(0,a.jsx)(t6,{userId:ed,onBack:()=>ec("community"),onToggleFollow:so,currentUserProfile:y});return null;case"settings":return(0,a.jsx)(as,{mainSubjectWeight:z,onMainSubjectWeightChange:e=>{L(e),eD("mainSubjectWeight",e)},minorSubjectWeight:B,onMinorSubjectWeightChange:e=>{R(e),eD("minorSubjectWeight",e)},maxPeriods:O,onMaxPeriodsChange:e=>{T(e),eD("maxPeriods",e)},theme:M,onThemeChange:e=>{Z(e),eD("theme",e)},isDarkMode:$,onIsDarkModeChange:e=>{H(e),eD("isDarkMode",e)}});default:return null}})()})]}),(0,a.jsx)(tL,{isOpen:ej,onOpenChange:ef,subjects:o,onNavigate:sn,onAddSubject:()=>X(!0),onAddGrade:e5,onExport:se,onImport:ss}),(0,a.jsx)(ee,{isOpen:Q,onOpenChange:X,onSubmit:eM}),(0,a.jsx)(sX,{isOpen:ep.isOpen,onOpenChange:e=>!e&&e6(),onSubmit:(e,s)=>{ep.subjectId&&eH(ep.subjectId,e,s)},subjectName:(null==(e=o.find(e=>e.id===ep.subjectId))?void 0:e.name)||"",gradeToEdit:ep.gradeToEdit}),eN.subject&&(0,a.jsx)(s1,{isOpen:eN.isOpen,onOpenChange:e=>!e&&eb({isOpen:!1,subject:null}),onSubmit:eZ,subject:eN.subject}),(0,a.jsx)(ti,{isOpen:ev.isOpen,onOpenChange:e=>!e&&e9(),grade:ev.grade,subject:ev.subject,onEdit:e=>{e9(),e3(e)},onDelete:e=>{e9(),eW(e)}}),(0,a.jsx)(ro,{isOpen:es,onOpenChange:et,onSubmit:eY,subjects:o,timetable:N}),(0,a.jsx)(rb,{isOpen:ey.isOpen,onOpenChange:e=>ek({isOpen:e}),onSubmit:e0,eventToEdit:ey.eventToEdit,selectedDate:ey.selectedDate}),(0,a.jsx)(rw,{isOpen:en,onOpenChange:el,widgets:q,onWidgetChange:e=>{Y(e),eD("dashboardWidgets",e)}})]})}function rA(){let{user:e,loading:s,isFirebaseEnabled:t}=(0,l.A)(),i=(0,n.useRouter)();return((0,r.useEffect)(()=>{!t||s||e||i.replace("/login")},[e,s,i,t]),s||t&&!e)?null:(0,a.jsx)("main",{children:(0,a.jsx)(rS,{})})}},85127:(e,s,t)=>{"use strict";t.d(s,{A0:()=>i,BF:()=>c,Hj:()=>d,XI:()=>l,nA:()=>m,nd:()=>o});var a=t(95155),r=t(12115),n=t(59434);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,n.cn)("w-full caption-bottom text-sm",t),...r})})});l.displayName="Table";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:(0,n.cn)("[&_tr]:border-b",t),...r})});i.displayName="TableHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...r})});c.displayName="TableBody",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});d.displayName="TableRow";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r})});o.displayName="TableHead";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r})});m.displayName="TableCell",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption"},90010:(e,s,t)=>{"use strict";t.d(s,{$v:()=>f,EO:()=>h,Lt:()=>c,Rx:()=>p,Zr:()=>g,ck:()=>x,r7:()=>j,tv:()=>d,wd:()=>u});var a=t(95155),r=t(12115),n=t(62278),l=t(59434),i=t(30285);let c=n.bL,d=n.l9,o=n.ZL,m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.hJ,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});m.displayName=n.hJ.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(n.UC,{ref:s,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});h.displayName=n.UC.displayName;let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};u.displayName="AlertDialogHeader";let x=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};x.displayName="AlertDialogFooter";let j=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.hE,{ref:s,className:(0,l.cn)("text-lg font-semibold",t),...r})});j.displayName=n.hE.displayName;let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.VY,{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});f.displayName=n.VY.displayName;let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.rc,{ref:s,className:(0,l.cn)((0,i.r)(),t),...r})});p.displayName=n.rc.displayName;let g=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.ZD,{ref:s,className:(0,l.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});g.displayName=n.ZD.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,645,659,572,355,468,248,441,684,358],()=>s(44680)),_N_E=e.O()}]);